import{r as e,s as a,j as s,c as t,R as i}from"./supabaseClient-BTiblPWy.js";import{T as l}from"./TournamentNavbar-DI7qB3Bc.js";import{F as r}from"./Footer-C_t3LNGD.js";import"./supabase-client-DmFmBHmJ.js";function n({onMatchClick:t}){const[i,n]=e.useState([]),[o,c]=e.useState(!0),[d,m]=e.useState(1),[h,p]=e.useState("list"),[u,x]=e.useState(""),[y]=e.useState(window.location.pathname.includes("/u17/")?"u17":"open-age"),_=e=>{if(!e)return null;const a=e.toLowerCase();return"group"===a?"Group Stage":"quarter-final"===a||"quarterfinal"===a?"Quarter Final":"semi-final"===a||"semifinal"===a?"Semi Final":"final"===a?"Final":"third-place"===a||"thirdplace"===a?"3rd Place":e.charAt(0).toUpperCase()+e.slice(1)};e.useEffect(()=>{f()},[y]);const f=async()=>{try{c(!0);const{data:e,error:s}=await a.from("matches").select("\n          *,\n          home_team:teams!matches_home_team_id_fkey(id, name, crest_url),\n          away_team:teams!matches_away_team_id_fkey(id, name, crest_url)\n        ").eq("category",y).order("match_number",{ascending:!0}).order("scheduled_time",{ascending:!0});if(s)throw s;if(n(e||[]),e&&e.length>0){const a=[...new Set(e.map(e=>e.match_number).filter(Boolean))],s=e.filter(e=>"completed"===e.status).map(e=>e.match_number).sort((e,a)=>a-e)[0];if(s){const e=a.some(e=>e>s);m(e?s+1:s)}else m(a[0]||1)}}catch(e){}finally{c(!1)}},g=e.useMemo(()=>{const e={};return i.forEach(a=>{const s=a.match_number||1;e[s]||(e[s]=[]),e[s].push(a)}),e},[i]),j=e.useMemo(()=>[...new Set(i.map(e=>e.match_number).filter(Boolean))].sort((e,a)=>e-a),[i]),v=g[d]||[],w=e.useMemo(()=>{if(!u.trim())return v;const e=u.toLowerCase().trim();return v.filter(a=>{var s,t,i,l;return(null==(t=null==(s=a.home_team)?void 0:s.name)?void 0:t.toLowerCase().includes(e))||(null==(l=null==(i=a.away_team)?void 0:i.name)?void 0:l.toLowerCase().includes(e))})},[v,u]),N=e.useMemo(()=>{if(!u.trim())return i;const e=u.toLowerCase().trim();return i.filter(a=>{var s,t,i,l;return(null==(t=null==(s=a.home_team)?void 0:s.name)?void 0:t.toLowerCase().includes(e))||(null==(l=null==(i=a.away_team)?void 0:i.name)?void 0:l.toLowerCase().includes(e))})},[i,u]);return o?s.jsxs(s.Fragment,{children:[s.jsx(l,{}),s.jsx("div",{className:"fixtures-loading",children:s.jsxs("div",{className:"fixtures-loading-content",children:[s.jsxs("div",{className:"logo-loader",children:[s.jsx("div",{className:"logo-ring"}),s.jsx("img",{src:"/assets/img/muq_invert.png",alt:"Muqawama",className:"logo-pulse"})]}),s.jsx("p",{children:"Loading fixtures..."})]})}),s.jsx(r,{edition:"2026"})]}):s.jsxs(s.Fragment,{children:[s.jsx(l,{}),s.jsx("div",{className:"fixtures-page-v2",children:s.jsxs("div",{className:"fixtures-container-v2",children:[s.jsxs("div",{className:"fixtures-header-v2",children:[s.jsx("h1",{children:"Fixtures & Results"}),s.jsx("hr",{className:"fixtures-divider"})]}),s.jsxs("div",{className:"fixtures-controls",children:[s.jsxs("div",{className:"view-toggle-fixtures",children:[s.jsxs("button",{className:"view-btn "+("list"===h?"active":""),onClick:()=>p("list"),title:"List View",children:[s.jsx("i",{className:"fas fa-list"}),s.jsx("span",{children:"Matchday"})]}),s.jsxs("button",{className:"view-btn "+("all"===h?"active":""),onClick:()=>p("all"),title:"All Matches",children:[s.jsx("i",{className:"fas fa-th-list"}),s.jsx("span",{children:"All"})]})]}),s.jsxs("div",{className:"fixtures-search",children:[s.jsx("i",{className:"fas fa-search"}),s.jsx("input",{type:"text",placeholder:"Search by team name...",value:u,onChange:e=>x(e.target.value)}),u&&s.jsx("button",{className:"clear-search",onClick:()=>x(""),children:s.jsx("i",{className:"fas fa-times"})})]})]}),"list"===h&&j.length>0&&s.jsx("div",{className:"matchday-tabs-v2",children:j.map(e=>s.jsx("button",{className:"matchday-tab-v2 "+(d===e?"active":""),onClick:()=>m(e),children:e},e))}),s.jsx("div",{className:"matches-list-v2",children:("all"===h?N:w).length>0?("all"===h?N:w).map(e=>{var a,i,l,r,n,o,c,d;const m="completed"===e.status,h="live"===e.status,p=m||h,u=e.home_score??0,x=e.away_score??0,y=(e=>{return"completed"===e.status?{label:"FT",className:"status-completed"}:"live"===e.status?{label:"LIVE",className:"status-live"}:"scheduled"===e.status?{label:(a=e.scheduled_time,a?a.length>=5?a.substring(0,5):a:"TBD"),className:"status-scheduled"}:{label:"TBD",className:"status-scheduled"};var a})(e);return s.jsxs("div",{className:"match-card-v2 clickable",onClick:()=>t&&t(e.id),style:{cursor:t?"pointer":"default"},children:[s.jsx("div",{className:"match-status-mobile",children:s.jsx("span",{className:`status-badge ${y.className}`,children:y.label})}),s.jsxs("div",{className:"match-row-v2",children:[s.jsx("div",{className:"match-status-desktop",children:s.jsx("span",{className:`status-badge ${y.className}`,children:y.label})}),s.jsxs("div",{className:"match-team-v2 home",children:[s.jsx("span",{className:"team-name-v2",children:(null==(a=e.home_team)?void 0:a.name)||"TBD"}),s.jsx("div",{className:"team-logo-v2",children:(null==(i=e.home_team)?void 0:i.crest_url)?s.jsx("img",{src:e.home_team.crest_url,alt:e.home_team.name,loading:"lazy"}):s.jsx("span",{children:(null==(r=null==(l=e.home_team)?void 0:l.name)?void 0:r.charAt(0))||"?"})})]}),s.jsx("div",{className:"match-score-v2",children:p?s.jsxs("span",{className:"score-display "+(h?"live":""),children:[u," - ",x]}):s.jsx("span",{className:"vs-display",children:"vs"})}),s.jsxs("div",{className:"match-team-v2 away",children:[s.jsx("div",{className:"team-logo-v2",children:(null==(n=e.away_team)?void 0:n.crest_url)?s.jsx("img",{src:e.away_team.crest_url,alt:e.away_team.name,loading:"lazy"}):s.jsx("span",{children:(null==(c=null==(o=e.away_team)?void 0:o.name)?void 0:c.charAt(0))||"?"})}),s.jsx("span",{className:"team-name-v2",children:(null==(d=e.away_team)?void 0:d.name)||"TBD"})]}),s.jsx("div",{className:"match-venue-desktop",children:s.jsxs("span",{children:[e.venue||"",e.venue&&_(e.match_type)&&" | ",_(e.match_type)]})})]}),s.jsx("div",{className:"match-venue-mobile",children:s.jsxs("span",{children:[e.venue||"",e.venue&&_(e.match_type)&&" | ",_(e.match_type)]})})]},e.id)}):s.jsxs("div",{className:"no-matches-v2",children:[s.jsx("i",{className:"fas fa-calendar-times"}),s.jsx("p",{children:u?`No matches found for "${u}"`:`No fixtures scheduled for Matchday ${d}`})]})})]})}),s.jsx(r,{edition:"2026"}),s.jsx("style",{children:"\n        .fixtures-controls {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          gap: 16px;\n          margin-bottom: 24px;\n          flex-wrap: wrap;\n        }\n\n        .view-toggle-fixtures {\n          display: flex;\n          gap: 4px;\n          background: rgba(255, 255, 255, 0.05);\n          padding: 4px;\n          border-radius: 10px;\n        }\n\n        .view-btn {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 10px 16px;\n          background: transparent;\n          border: none;\n          color: rgba(255, 255, 255, 0.5);\n          cursor: pointer;\n          border-radius: 8px;\n          font-size: 13px;\n          font-weight: 500;\n          transition: all 0.2s;\n        }\n\n        .view-btn:hover {\n          color: rgba(255, 255, 255, 0.8);\n          background: rgba(255, 255, 255, 0.05);\n        }\n\n        .view-btn.active {\n          background: linear-gradient(135deg, #4f8cff, #6fb1fc);\n          color: #fff;\n        }\n\n        .view-btn i {\n          font-size: 14px;\n        }\n\n        .fixtures-search {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          background: rgba(255, 255, 255, 0.05);\n          border: 1px solid rgba(255, 255, 255, 0.1);\n          border-radius: 10px;\n          padding: 10px 16px;\n          min-width: 250px;\n          transition: all 0.2s;\n        }\n\n        .fixtures-search:focus-within {\n          border-color: #4f8cff;\n          background: rgba(79, 140, 255, 0.05);\n        }\n\n        .fixtures-search i {\n          color: rgba(255, 255, 255, 0.4);\n        }\n\n        .fixtures-search input {\n          flex: 1;\n          background: transparent;\n          border: none;\n          outline: none;\n          color: #fff;\n          font-size: 14px;\n        }\n\n        .fixtures-search input::placeholder {\n          color: rgba(255, 255, 255, 0.4);\n        }\n\n        .clear-search {\n          background: none;\n          border: none;\n          color: rgba(255, 255, 255, 0.4);\n          cursor: pointer;\n          padding: 4px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: color 0.2s;\n        }\n\n        .clear-search:hover {\n          color: #fff;\n        }\n\n        @media (max-width: 768px) {\n          .fixtures-controls {\n            flex-direction: column;\n            align-items: stretch;\n          }\n\n          .view-toggle-fixtures {\n            justify-content: center;\n          }\n\n          .fixtures-search {\n            min-width: 100%;\n          }\n\n          .view-btn span {\n            display: none;\n          }\n\n          .view-btn {\n            padding: 10px 14px;\n          }\n        }\n      "})]})}function o({homePlayers:t=[],awayPlayers:i=[],homeTeam:l={},awayTeam:r={},goals:n=[],cards:o=[]}){const[c,d]=e.useState(null),[m,h]=e.useState(!0),[p,u]=e.useState(!1),[x,y]=e.useState(null),[_,f]=e.useState(!1),g=t.filter(e=>!e.is_substitute&&"SUB"!==e.position).slice(0,7),j=i.filter(e=>!e.is_substitute&&"SUB"!==e.position).slice(0,7),v=e=>{if(!e)return{goalsScored:0,assists:0,yellowCards:0,redCards:0};let a=0,s=0,t=0,i=0;const l=e.name||e.player_name||"",r=e.registration_player_id;return n.forEach(t=>{var i,n;let o=!1,c=!1;if(r&&(t.scorer_id===r&&(o=!0),t.assister_id===r&&(c=!0)),!o&&!c){const a=(null==(i=t.scorer)?void 0:i.player_name)||"",s=(null==(n=t.assister)?void 0:n.player_name)||"",r=e.team_id;a&&l&&a.toLowerCase().trim()===l.toLowerCase().trim()&&t.team_id===r&&(o=!0),s&&l&&s.toLowerCase().trim()===l.toLowerCase().trim()&&t.team_id===r&&(c=!0)}o&&a++,c&&s++}),o&&o.length>0&&o.forEach(a=>{var s;let n=!1;if(r&&a.player_id===r&&(n=!0),!n){const t=(null==(s=a.player)?void 0:s.player_name)||"",i=e.team_id;t&&l&&t.toLowerCase().trim()===l.toLowerCase().trim()&&a.team_id===i&&(n=!0)}n&&("yellow"===a.card_type&&t++,"red"===a.card_type&&i++)}),{goalsScored:a,assists:s,yellowCards:t,redCards:i}},w=(e,a)=>{d(e),h(a),y(null)};e.useEffect(()=>{(async()=>{if(c){f(!0);try{const e=c.name||c.player_name||"",s=c.registration_player_id;let t=[];if(s){const{data:e}=await a.from("goals").select("id, scorer_id, assister_id").eq("scorer_id",s),{data:i}=await a.from("goals").select("id, scorer_id, assister_id").eq("assister_id",s),l=new Map;(e||[]).forEach(e=>l.set(e.id,e)),(i||[]).forEach(e=>l.set(e.id,e)),t=Array.from(l.values())}if(e&&0===t.length){const{data:s}=await a.from("goals").select("\n              id,\n              scorer_id,\n              assister_id,\n              scorer:team_players!goals_scorer_id_fkey(player_name),\n              assister:team_players!goals_assister_id_fkey(player_name)\n            ");s&&(t=s.filter(a=>{var s,t;const i=(null==(s=a.scorer)?void 0:s.player_name)||"",l=(null==(t=a.assister)?void 0:t.player_name)||"";return i&&i.toLowerCase().trim()===e.toLowerCase().trim()||l&&l.toLowerCase().trim()===e.toLowerCase().trim()}))}let i=[];if(s){const{data:e}=await a.from("cards").select("id, player_id, card_type").eq("player_id",s);i=e||[]}if(e&&0===i.length){const{data:s}=await a.from("cards").select("\n              id,\n              player_id,\n              card_type,\n              player:team_players!cards_player_id_fkey(player_name)\n            ");s&&(i=s.filter(a=>{var s;const t=(null==(s=a.player)?void 0:s.player_name)||"";return t&&t.toLowerCase().trim()===e.toLowerCase().trim()}))}let l=0,r=0,n=0,o=0;t.forEach(a=>{var t,i;if(s)a.scorer_id===s&&l++,a.assister_id===s&&r++;else{const s=(null==(t=a.scorer)?void 0:t.player_name)||"",n=(null==(i=a.assister)?void 0:i.player_name)||"";s&&s.toLowerCase().trim()===e.toLowerCase().trim()&&l++,n&&n.toLowerCase().trim()===e.toLowerCase().trim()&&r++}}),i.forEach(e=>{"yellow"===e.card_type&&n++,"red"===e.card_type&&o++}),y({goalsScored:l,assists:r,yellowCards:n,redCards:o})}catch(e){y({goalsScored:0,assists:0,yellowCards:0,redCards:0})}finally{f(!1)}}else y(null)})()},[c]);const N=()=>{d(null)};if(!(g.length>0||j.length>0))return s.jsxs("div",{className:"match-formation-empty",children:[s.jsx("i",{className:"fas fa-users-slash"}),s.jsx("p",{children:"Formation not available"})]});const b=c?v(c):null,C=c?(e=>{if(!e)return null;const a=new Date(e),s=new Date;let t=s.getFullYear()-a.getFullYear();const i=s.getMonth()-a.getMonth();return(i<0||0===i&&s.getDate()<a.getDate())&&t--,t})(c.date_of_birth):null,S=null!==x?x:b;return s.jsxs("div",{className:"match-formation-field",children:[s.jsx("div",{className:"formation-field-wrapper",children:s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 74 111",className:"match-field-svg",children:[s.jsx("rect",{width:"74",height:"111",fill:"#0d1117"}),s.jsxs("g",{fill:"none",stroke:"rgba(255,255,255,0.35)",strokeWidth:"0.5",transform:"translate(3 3)",children:[s.jsx("path",{d:"M 0 0 h 68 v 105 h -68 Z"}),s.jsx("path",{d:"M 0 52.5 h 68"}),s.jsx("circle",{r:"9.15",cx:"34",cy:"52.5"}),s.jsx("circle",{r:"0.75",cx:"34",cy:"52.5",fill:"rgba(255,255,255,0.35)",stroke:"none"}),s.jsxs("g",{children:[s.jsx("path",{d:"M 13.84 0 v 16.5 h 40.32 v -16.5"}),s.jsx("path",{d:"M 24.84 0 v 5.5 h 18.32 v -5.5"}),s.jsx("circle",{r:"0.75",cx:"34",cy:"10.94",fill:"rgba(255,255,255,0.35)",stroke:"none"}),s.jsx("path",{d:"M 26.733027 16.5 a 9.15 9.15 0 0 0 14.533946 0"})]}),s.jsxs("g",{transform:"rotate(180,34,52.5)",children:[s.jsx("path",{d:"M 13.84 0 v 16.5 h 40.32 v -16.5"}),s.jsx("path",{d:"M 24.84 0 v 5.5 h 18.32 v -5.5"}),s.jsx("circle",{r:"0.75",cx:"34",cy:"10.94",fill:"rgba(255,255,255,0.35)",stroke:"none"}),s.jsx("path",{d:"M 26.733027 16.5 a 9.15 9.15 0 0 0 14.533946 0"})]}),s.jsx("path",{d:"M 0 2 a 2 2 0 0 0 2 -2M 66 0 a 2 2 0 0 0 2 2M 68 103 a 2 2 0 0 0 -2 2M 2 105 a 2 2 0 0 0 -2 -2"})]}),g.map(e=>{var a,t,i,l;const r=(e=>({x:"number"==typeof e.position_x?e.position_x:50,y:4+(100-("number"==typeof e.position_y?e.position_y:50))/100*44}))(e),n=3+r.x/100*68,o=3+r.y/100*105,c=v(e),d=c.goalsScored>0,m=c.yellowCards>0,h=c.redCards>0;return s.jsxs("g",{transform:`translate(${n}, ${o})`,style:{cursor:"pointer"},onClick:()=>w(e,!0),role:"button",tabIndex:0,onKeyDown:a=>{"Enter"!==a.key&&" "!==a.key||w(e,!0)},children:[s.jsx("circle",{r:"3.8",fill:"none",stroke:"#4a90e2",strokeWidth:"0.3"}),s.jsx("circle",{r:"3",fill:"#1e2a38",stroke:"none"}),e.player_image?s.jsxs(s.Fragment,{children:[s.jsx("defs",{children:s.jsx("clipPath",{id:`clip-home-${e.id}`,children:s.jsx("circle",{r:"3",cx:"0",cy:"0"})})}),s.jsx("image",{href:e.player_image,x:"-3",y:"-3",width:"6",height:"6",clipPath:`url(#clip-home-${e.id})`,preserveAspectRatio:"xMidYMid slice"})]}):s.jsx("text",{x:"0",y:"1",textAnchor:"middle",fill:"#4a90e2",fontSize:"2.2",fontWeight:"700",children:e.position||"?"}),s.jsx("text",{x:"0",y:"6.5",textAnchor:"middle",fill:"#4a90e2",fontSize:"1.8",fontWeight:"600",children:(null==(t=null==(a=e.name)?void 0:a.split(" ")[0])?void 0:t.substring(0,8))||(null==(l=null==(i=e.player_name)?void 0:i.split(" ")[0])?void 0:l.substring(0,8))||""}),d&&s.jsxs("g",{transform:"translate(2.7, -2.7)",children:[s.jsx("circle",{r:"1.2",fill:"#fff",opacity:"0.98"}),s.jsx("image",{href:"/assets/img/Muqawama/ball.svg",x:"-1.2",y:"-1.2",width:"2.4",height:"2.4",preserveAspectRatio:"xMidYMid meet"}),c.goalsScored>1&&s.jsxs("g",{children:[s.jsx("circle",{cx:"0.9",cy:"-0.9",r:"0.65",fill:"#fff",stroke:"#000",strokeWidth:"0.18"}),s.jsx("text",{x:"0.9",y:"-0.75",textAnchor:"middle",fontSize:"0.75",fill:"#000",fontWeight:"700",children:c.goalsScored})]})]}),m&&s.jsx("g",{transform:"translate(-2.7, -2.7)",children:s.jsx("image",{href:"/assets/img/Muqawama/Yellow_card.svg",x:"-1.2",y:"-1.2",width:"2.4",height:"2.4",preserveAspectRatio:"xMidYMid meet"})}),h&&s.jsx("g",{transform:"translate(2.7, 2.7)",children:s.jsx("image",{href:"/assets/img/Muqawama/Red_card.svg",x:"-1.2",y:"-1.2",width:"2.4",height:"2.4",preserveAspectRatio:"xMidYMid meet"})})]},`home-${e.id}`)}),j.map(e=>{var a,t,i,l;const r=(e=>({x:"number"==typeof e.position_x?e.position_x:50,y:52+("number"==typeof e.position_y?e.position_y:50)/100*44}))(e),n=3+r.x/100*68,o=3+r.y/100*105,c=v(e),d=c.goalsScored>0,m=c.yellowCards>0,h=c.redCards>0;return s.jsxs("g",{transform:`translate(${n}, ${o})`,style:{cursor:"pointer"},onClick:()=>w(e,!1),role:"button",tabIndex:0,onKeyDown:a=>{"Enter"!==a.key&&" "!==a.key||w(e,!1)},children:[s.jsx("circle",{r:"3.8",fill:"none",stroke:"#e63946",strokeWidth:"0.3"}),s.jsx("circle",{r:"3",fill:"#2a1e1e",stroke:"none"}),e.player_image?s.jsxs(s.Fragment,{children:[s.jsx("defs",{children:s.jsx("clipPath",{id:`clip-away-${e.id}`,children:s.jsx("circle",{r:"3",cx:"0",cy:"0"})})}),s.jsx("image",{href:e.player_image,x:"-3",y:"-3",width:"6",height:"6",clipPath:`url(#clip-away-${e.id})`,preserveAspectRatio:"xMidYMid slice"})]}):s.jsx("text",{x:"0",y:"1",textAnchor:"middle",fill:"#e63946",fontSize:"2.2",fontWeight:"700",children:e.position||"?"}),s.jsx("text",{x:"0",y:"6.5",textAnchor:"middle",fill:"#e63946",fontSize:"1.8",fontWeight:"600",children:(null==(t=null==(a=e.name)?void 0:a.split(" ")[0])?void 0:t.substring(0,8))||(null==(l=null==(i=e.player_name)?void 0:i.split(" ")[0])?void 0:l.substring(0,8))||""}),d&&s.jsxs("g",{transform:"translate(2.7, -2.7)",children:[s.jsx("circle",{r:"1.2",fill:"#fff",opacity:"0.98"}),s.jsx("image",{href:"/assets/img/Muqawama/ball.svg",x:"-1.2",y:"-1.2",width:"2.4",height:"2.4",preserveAspectRatio:"xMidYMid meet"}),c.goalsScored>1&&s.jsxs("g",{children:[s.jsx("circle",{cx:"0.9",cy:"-0.9",r:"0.65",fill:"#fff",stroke:"#000",strokeWidth:"0.18"}),s.jsx("text",{x:"0.9",y:"-0.75",textAnchor:"middle",fontSize:"0.75",fill:"#000",fontWeight:"700",children:c.goalsScored})]})]}),m&&s.jsx("g",{transform:"translate(-2.7, -2.7)",children:s.jsx("image",{href:"/assets/img/Muqawama/Yellow_card.svg",x:"-1.2",y:"-1.2",width:"2.4",height:"2.4",preserveAspectRatio:"xMidYMid meet"})}),h&&s.jsx("g",{transform:"translate(2.7, 2.7)",children:s.jsx("image",{href:"/assets/img/Muqawama/Red_card.svg",x:"-1.2",y:"-1.2",width:"2.4",height:"2.4",preserveAspectRatio:"xMidYMid meet"})})]},`away-${e.id}`)})]})}),s.jsxs("div",{className:"formation-legend",children:[s.jsxs("div",{className:"legend-item home",children:[s.jsx("span",{className:"legend-dot home"}),s.jsxs("span",{children:[l.name||"Home"," ",l.formation&&`(${l.formation})`]})]}),s.jsxs("div",{className:"legend-item away",children:[s.jsx("span",{className:"legend-dot away"}),s.jsxs("span",{children:[r.name||"Away"," ",r.formation&&`(${r.formation})`]})]})]}),c&&s.jsx("div",{className:"player-modal-overlay",onClick:N,children:s.jsxs("div",{className:"player-modal-card",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{className:"player-modal-close",onClick:N,children:s.jsx("i",{className:"fas fa-times"})}),s.jsxs("div",{className:"player-modal-header "+(m?"home":"away"),children:[s.jsxs("div",{className:"player-modal-image",children:[c.player_image?s.jsx("img",{src:c.player_image,alt:c.name||c.player_name}):s.jsx("div",{className:"player-modal-placeholder",children:s.jsx("i",{className:"fas fa-user"})}),s.jsx("div",{className:"player-modal-ring "+(m?"home":"away")})]}),s.jsx("h3",{className:"player-modal-name",children:c.name||c.player_name}),s.jsx("p",{className:"player-modal-team",children:m?l.name:r.name})]}),s.jsx("div",{className:"player-modal-stats",children:s.jsx("table",{className:"player-stats-table-modal",children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("td",{className:"stat-label",children:"Position"}),s.jsx("td",{className:"stat-value",children:c.position||"N/A"})]}),C&&s.jsxs("tr",{children:[s.jsx("td",{className:"stat-label",children:"Age"}),s.jsxs("td",{className:"stat-value",children:[C," years"]})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"stat-label",children:"Goals"}),s.jsx("td",{className:"stat-value stat-highlight goals",children:_?"...":(null==S?void 0:S.goalsScored)||0})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"stat-label",children:"Assists"}),s.jsx("td",{className:"stat-value stat-highlight assists",children:_?"...":(null==S?void 0:S.assists)||0})]})]})})}),s.jsx("button",{className:"player-modal-view-btn",disabled:p,onClick:async()=>{if(!p){u(!0);try{const e=window.location.pathname.includes("/u17/")?"u17":"open-age";window.location.href=`/muqawamah/2026/${e}/players/?player=${c.id}`}catch(e){u(!1)}}},children:p?"Loading...":"View Full Details"})]})})]})}function c({matchId:t,userIdentifier:i,initialLikeCount:l}){const[r,n]=e.useState(l||0),[o,c]=e.useState([]);e.useEffect(()=>{n(l||0)},[l]);const d=(e,a)=>{const s=Date.now()+Math.random()+e,t={id:s,horizontalOffset:e/a*20-10,delay:.15*e};c(e=>[...e,t]),setTimeout(()=>{c(e=>e.filter(e=>e.id!==s))},3e3)};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"match-like-button-sticky",onClick:async()=>{if(!t||!i)return;const e=3+Math.floor(3*Math.random());for(let a=0;a<e;a++)setTimeout(()=>{d(a,e)},80*a);n(e=>e+1);try{await a.from("match_likes").insert({match_id:t,user_identifier:i})}catch(s){}},title:"Show your support for this match",children:[s.jsx("i",{className:"fas fa-heart"}),r>0&&s.jsx("span",{className:"like-count-badge",children:r})]}),s.jsx("div",{className:"flying-hearts-container",children:o.map(e=>s.jsx("div",{className:"flying-heart",style:{"--horizontal-offset":`${e.horizontalOffset||0}px`,"--delay":`${e.delay||0}s`},children:s.jsx("i",{className:"fas fa-heart"})},e.id))})]})}function d({match:e}){var a,t,i,l,r,n,o,c;const d="completed"===e.status,m="live"===e.status,h=d||m,p="completed"===e.status?{label:"FULL TIME",className:"status-completed"}:"live"===e.status?{label:"LIVE",className:"status-live"}:"scheduled"===e.status?{label:"SCHEDULED",className:"status-scheduled"}:{label:"UPCOMING",className:"status-scheduled"};return s.jsx("section",{className:"match-header-section",children:s.jsxs("div",{className:"match-header-content",children:[s.jsxs("div",{className:"match-datetime",children:[s.jsx("p",{className:"match-date",children:(e=>{if(!e)return"TBD";return new Date(e).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long"}).toUpperCase()})(e.match_date)}),s.jsx("p",{className:"match-time",children:(u=e.scheduled_time,u?u.substring(0,5):"TBD")})]}),s.jsxs("div",{className:"match-teams-header",children:[s.jsxs("div",{className:"header-team home",children:[s.jsx("div",{className:"team-logo-large",children:(null==(a=e.home_team)?void 0:a.crest_url)?s.jsx("img",{src:e.home_team.crest_url,alt:e.home_team.name,loading:"lazy"}):s.jsx("span",{children:(null==(i=null==(t=e.home_team)?void 0:t.name)?void 0:i.charAt(0))||"?"})}),s.jsx("h4",{className:"team-name-header",children:(null==(l=e.home_team)?void 0:l.name)||"TBD"})]}),s.jsxs("div",{className:"match-score-header",children:[h?s.jsxs("span",{className:"score-big "+(m?"live":""),children:[e.home_score??0," - ",e.away_score??0]}):s.jsx("span",{className:"score-vs",children:"VS"}),s.jsx("span",{className:"match-type-label",children:(()=>{var a;const s=null==(a=e.match_type)?void 0:a.toLowerCase();return s&&"group"!==s?"quarter-final"===s||"quarterfinal"===s?"Quarter Final":"semi-final"===s||"semifinal"===s?"Semi Final":"final"===s?"Final":"third-place"===s||"thirdplace"===s?"3rd Place":s.charAt(0).toUpperCase()+s.slice(1):"Group Stage"})()}),s.jsx("span",{className:`match-status-badge-detail ${p.className}`,children:p.label})]}),s.jsxs("div",{className:"header-team away",children:[s.jsx("div",{className:"team-logo-large",children:(null==(r=e.away_team)?void 0:r.crest_url)?s.jsx("img",{src:e.away_team.crest_url,alt:e.away_team.name,loading:"lazy"}):s.jsx("span",{children:(null==(o=null==(n=e.away_team)?void 0:n.name)?void 0:o.charAt(0))||"?"})}),s.jsx("h4",{className:"team-name-header",children:(null==(c=e.away_team)?void 0:c.name)||"TBD"})]})]}),s.jsxs("div",{className:"match-meta",children:[s.jsxs("p",{className:"matchday-label",children:["MATCHDAY ",e.match_number||1]}),e.venue&&s.jsx("p",{className:"venue-label",children:e.venue})]})]})});var u}function m({match:e,matchId:t,userIdentifier:i,userPrediction:l,userPredictionStats:r,onPredictionUpdate:n,onStatsUpdate:o}){var c,d,m,h,p,u;const x=async s=>{if(t&&i&&e)try{const{data:e}=await a.from("match_predictions").select("id, prediction").eq("match_id",t).eq("user_identifier",i).maybeSingle();if(e?e.prediction===s?(await a.from("match_predictions").delete().eq("id",e.id),n&&n(null)):(await a.from("match_predictions").update({prediction:s}).eq("id",e.id),n&&n(s)):(await a.from("match_predictions").insert({match_id:t,user_identifier:i,prediction:s}),n&&n(s)),o){const{data:e}=await a.from("match_predictions").select("prediction").eq("match_id",t);if(e){const a={home:e.filter(e=>"home"===e.prediction).length,draw:e.filter(e=>"draw"===e.prediction).length,away:e.filter(e=>"away"===e.prediction).length};o(a)}}}catch(l){}},y="completed"===e.status||"live"===e.status,_=r.home+r.draw+r.away,f=_>0?Math.round(r.home/_*100):0,g=_>0?Math.round(r.draw/_*100):0,j=_>0?Math.round(r.away/_*100):0;return s.jsxs("div",{className:"goals-panel-compact",children:[s.jsxs("h3",{className:"panel-title-compact",children:[s.jsx("i",{className:"fas fa-users"}),"Community Predictions"]}),s.jsx("div",{className:"prediction-content",children:s.jsx("div",{className:"prediction-bars-compact",children:s.jsxs("div",{className:"prediction-bar-item",children:[s.jsxs("div",{className:"user-prediction-probability-bar compact",children:[s.jsx("div",{className:"user-prob-segment home-win",style:{width:`${f}%`},title:`${(null==(c=e.home_team)?void 0:c.name)||"Home"} ${f}%${_>0?` (${r.home} votes)`:""}`,children:f>10&&s.jsxs("span",{className:"user-prob-label",children:[f,"%"]})}),s.jsx("div",{className:"user-prob-segment draw",style:{width:`${g}%`},title:`Draw ${g}%${_>0?` (${r.draw} votes)`:""}`,children:g>10&&s.jsxs("span",{className:"user-prob-label",children:[g,"%"]})}),s.jsx("div",{className:"user-prob-segment away-win",style:{width:`${j}%`},title:`${(null==(d=e.away_team)?void 0:d.name)||"Away"} ${j}%${_>0?` (${r.away} votes)`:""}`,children:j>10&&s.jsxs("span",{className:"user-prob-label",children:[j,"%"]})})]}),!l&&!y&&s.jsxs("div",{className:"user-prediction-buttons-compact",children:[s.jsxs("button",{className:"user-pred-btn-compact home",onClick:()=>x("home"),title:`${(null==(m=e.home_team)?void 0:m.name)||"Home"} to win`,children:[s.jsx("i",{className:"fas fa-trophy"}),s.jsx("span",{children:(null==(h=e.home_team)?void 0:h.name)||"Home"})]}),s.jsxs("button",{className:"user-pred-btn-compact draw",onClick:()=>x("draw"),title:"Draw",children:[s.jsx("i",{className:"fas fa-equals"}),s.jsx("span",{children:"Draw"})]}),s.jsxs("button",{className:"user-pred-btn-compact away",onClick:()=>x("away"),title:`${(null==(p=e.away_team)?void 0:p.name)||"Away"} to win`,children:[s.jsx("i",{className:"fas fa-trophy"}),s.jsx("span",{children:(null==(u=e.away_team)?void 0:u.name)||"Away"})]})]})]})})})]})}function h({goals:e,cards:a,match:t,isFinished:i}){const l=[...e.map(e=>({...e,type:"goal"})),...a.map(e=>({...e,type:"card"}))].sort((e,a)=>(e.minute||0)-(a.minute||0));return s.jsxs("div",{className:"goals-panel-compact",children:[s.jsxs("h3",{className:"panel-title-compact",children:[s.jsx("i",{className:"fas fa-futbol"}),"Goals & Highlights"]}),l.length>0?s.jsx("div",{className:"goals-list-compact",children:l.map((e,a)=>{var i,l,r,n,o,c,d;if("goal"===e.type){const o=e.team_id===t.home_team_id;return s.jsxs("div",{className:"goal-row-compact "+(o?"home":"away"),children:[s.jsxs("span",{className:"goal-minute-compact",children:[e.minute,"'"]}),s.jsx("span",{className:"goal-icon-compact",children:s.jsx("i",{className:"fas fa-futbol"})}),s.jsx("span",{className:"goal-scorer-compact",children:(null==(i=e.scorer)?void 0:i.player_name)||"Unknown"}),(null==(l=e.assister)?void 0:l.player_name)&&s.jsxs("span",{className:"goal-assist-compact",children:["(",e.assister.player_name,")"]}),s.jsx("span",{className:"goal-team-compact",children:o?null==(r=t.home_team)?void 0:r.name:null==(n=t.away_team)?void 0:n.name})]},`goal-${e.id||a}`)}{const i=e.team_id===t.home_team_id;return s.jsxs("div",{className:"card-row-compact "+(i?"home":"away"),children:[s.jsxs("span",{className:"goal-minute-compact",children:[e.minute,"'"]}),s.jsx("span",{className:`card-icon-compact ${e.card_type}`,children:"yellow"===e.card_type?s.jsx("i",{className:"fas fa-square",style:{color:"#ffd700"}}):s.jsx("i",{className:"fas fa-square",style:{color:"#ff0000"}})}),s.jsx("span",{className:"goal-scorer-compact",children:(null==(o=e.player)?void 0:o.player_name)||"Unknown"}),s.jsx("span",{className:"goal-team-compact",children:i?null==(c=t.home_team)?void 0:c.name:null==(d=t.away_team)?void 0:d.name})]},`card-${e.id||a}`)}})}):s.jsx("p",{className:"no-goals-compact",children:i?"No events":"Events will appear here"})]})}function p({homeTeamPlayers:e,awayTeamPlayers:a,match:t,goals:i,cards:l}){const r=e=>{const a=["GK","CB","LB","RB","CDM","CM","CAM","LM","RM","CF","ST","SUB"];return[...e].sort((e,s)=>{const t=a.indexOf(e.position),i=a.indexOf(s.position);return(-1===t?99:t)-(-1===i?99:i)})},n=(e,a,t)=>s.jsxs("div",{className:"squad-column "+(t?"home":"away"),children:[s.jsx("div",{className:"squad-header "+(t?"":"away"),children:t?s.jsxs(s.Fragment,{children:[(null==a?void 0:a.crest_url)&&s.jsx("img",{src:a.crest_url,alt:"",className:"squad-team-logo",loading:"lazy"}),s.jsx("span",{children:null==a?void 0:a.name})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:null==a?void 0:a.name}),(null==a?void 0:a.crest_url)&&s.jsx("img",{src:a.crest_url,alt:"",className:"squad-team-logo",loading:"lazy"})]})}),s.jsxs("div",{className:"squad-list",children:[r(e).map(e=>{const a=(e=>{if(!e)return{goalsScored:0,assists:0,yellowCards:0,redCards:0};let a=0,s=0,t=0,r=0;const n=e.name||e.player_name||"",o=e.registration_player_id;return i.forEach(t=>{var i,l;let r=!1,c=!1;if(o&&(t.scorer_id===o&&(r=!0),t.assister_id===o&&(c=!0)),!r&&!c){const a=(null==(i=t.scorer)?void 0:i.player_name)||"",s=(null==(l=t.assister)?void 0:l.player_name)||"",o=e.team_id;a&&n&&a.toLowerCase().trim()===n.toLowerCase().trim()&&t.team_id===o&&(r=!0),s&&n&&s.toLowerCase().trim()===n.toLowerCase().trim()&&t.team_id===o&&(c=!0)}r&&a++,c&&s++}),l&&l.length>0&&l.forEach(a=>{var s;let i=!1;if(o&&a.player_id===o&&(i=!0),!i){const t=(null==(s=a.player)?void 0:s.player_name)||"",l=e.team_id;t&&n&&t.toLowerCase().trim()===n.toLowerCase().trim()&&a.team_id===l&&(i=!0)}i&&("yellow"===a.card_type&&t++,"red"===a.card_type&&r++)}),{goalsScored:a,assists:s,yellowCards:t,redCards:r}})(e);return s.jsxs("div",{className:"squad-player-row "+("SUB"===e.position||e.is_substitute?"substitute":""),children:[s.jsx("span",{className:"player-name",children:e.name||e.player_name||"Unknown"}),s.jsxs("div",{className:"player-stats-icons",children:[a.goalsScored>0&&s.jsxs("span",{className:"stat-icon goal-icon",title:`${a.goalsScored} goal${a.goalsScored>1?"s":""}`,children:[s.jsx("span",{className:"ball-icon-wrapper",children:s.jsx("img",{src:"/assets/img/Muqawama/ball.svg",alt:"Goal",style:{width:"16px",height:"16px"}})}),a.goalsScored>1&&s.jsx("span",{className:"stat-count-badge",children:a.goalsScored})]}),a.yellowCards>0&&s.jsxs("span",{className:"stat-icon yellow-card-icon",title:`${a.yellowCards} yellow card${a.yellowCards>1?"s":""}`,children:[s.jsx("img",{src:"/assets/img/Muqawama/Yellow_card.svg",alt:"Yellow Card",style:{width:"14px",height:"14px"}}),a.yellowCards>1&&s.jsx("span",{className:"stat-count-badge",children:a.yellowCards})]}),a.redCards>0&&s.jsxs("span",{className:"stat-icon red-card-icon",title:`${a.redCards} red card${a.redCards>1?"s":""}`,children:[s.jsx("img",{src:"/assets/img/Muqawama/Red_card.svg",alt:"Red Card",style:{width:"14px",height:"14px"}}),a.redCards>1&&s.jsx("span",{className:"stat-count-badge",children:a.redCards})]})]})]},e.id)}),0===e.length&&s.jsx("p",{className:"no-squad",children:"Squad not available"})]})]});return s.jsxs("div",{className:"squads-section",children:[s.jsx("h3",{className:"panel-title",children:"SQUADS"}),s.jsxs("div",{className:"squads-grid",children:[n(e,t.home_team,!0),n(a,t.away_team,!1)]})]})}function u({matchId:t,onBack:i}){const[n,u]=e.useState(null),[x,y]=e.useState([]),[_,f]=e.useState([]),[g,j]=e.useState([]),[v,w]=e.useState([]),[N,b]=e.useState(!0),[C,S]=e.useState(0),[M,k]=e.useState(null),[q,$]=e.useState(null),[L,A]=e.useState(!1),[E,P]=e.useState(null),[F,T]=e.useState({home:0,draw:0,away:0});e.useEffect(()=>{(()=>{let e=localStorage.getItem("user_identifier");if(!e){const a=document.createElement("canvas"),s=a.getContext("2d");s.textBaseline="top",s.font="14px Arial",s.fillText("Fingerprint",2,2);const t=a.toDataURL();e=btoa(navigator.userAgent+navigator.language+screen.width+screen.height+(new Date).getTimezoneOffset()+t).substring(0,32),localStorage.setItem("user_identifier",e)}k(e)})()},[]),e.useEffect(()=>{t&&D()},[t]),e.useEffect(()=>{t&&M&&n&&B()},[t,M,n]),e.useEffect(()=>{n&&"completed"!==n.status&&"live"!==n.status&&n.home_team_id&&n.away_team_id&&z()},[n]);const D=async()=>{var e,s;try{b(!0);const{data:i,error:l}=await a.from("matches").select("\n          id,\n          match_number,\n          match_date,\n          scheduled_time,\n          home_team_id,\n          away_team_id,\n          home_score,\n          away_score,\n          status,\n          category,\n          match_type,\n          venue,\n          home_team:teams!matches_home_team_id_fkey(id, name, crest_url, category),\n          away_team:teams!matches_away_team_id_fkey(id, name, crest_url, category)\n        ").eq("id",t).single();if(l)throw l;u(i);const[r,n]=await Promise.all([a.from("goals").select("\n            id,\n            match_id,\n            team_id,\n            scorer_id,\n            assister_id,\n            minute,\n            goal_type,\n            scorer:team_players!goals_scorer_id_fkey(id, player_name, player_image),\n            assister:team_players!goals_assister_id_fkey(id, player_name, player_image)\n          ").eq("match_id",t).order("minute",{ascending:!0}),a.from("cards").select("\n            id,\n            match_id,\n            team_id,\n            player_id,\n            card_type,\n            minute,\n            player:team_players!cards_player_id_fkey(id, player_name, player_image)\n          ").eq("match_id",t).order("minute",{ascending:!0})]),o=r.data,c=n.data;if(o){const e=new Set;o.forEach(a=>{var s,t;a.scorer_id&&!(null==(s=a.scorer)?void 0:s.player_name)&&e.add(a.scorer_id),a.assister_id&&!(null==(t=a.assister)?void 0:t.player_name)&&e.add(a.assister_id)});let s={};if(e.size>0){const{data:t}=await a.from("players").select("name, player_image, registration_player_id").in("registration_player_id",Array.from(e));t&&t.forEach(e=>{e.registration_player_id&&(s[e.registration_player_id]=e)})}const t=o.map(e=>{var a,t,i,l;let r=(null==(a=e.scorer)?void 0:a.player_name)||null,n=(null==(t=e.assister)?void 0:t.player_name)||null,o=(null==(i=e.scorer)?void 0:i.player_image)||null,c=(null==(l=e.assister)?void 0:l.player_image)||null;return e.scorer_id&&!r&&s[e.scorer_id]&&(r=s[e.scorer_id].name,o=s[e.scorer_id].player_image||o),e.assister_id&&!n&&s[e.assister_id]&&(n=s[e.assister_id].name,c=s[e.assister_id].player_image||c),{...e,scorer:r?{player_name:r,player_image:o}:null,assister:n?{player_name:n,player_image:c}:null}});j(t)}if(c){const e=new Set;c.forEach(a=>{var s;a.player_id&&!(null==(s=a.player)?void 0:s.player_name)&&e.add(a.player_id)});let s={};if(e.size>0){const{data:t}=await a.from("players").select("name, player_image, registration_player_id").in("registration_player_id",Array.from(e));t&&t.forEach(e=>{e.registration_player_id&&(s[e.registration_player_id]=e)})}const t=c.map(e=>{var a;let t=(null==(a=e.player)?void 0:a.player_name)||null;return e.player_id&&!t&&s[e.player_id]&&(t=s[e.player_id].name),{...e,player:t?{player_name:t}:null}});w(t)}if((null==(e=i.home_team)?void 0:e.id)&&(null==(s=i.away_team)?void 0:s.id)){const[e,s]=await Promise.all([a.from("players").select("id, name, player_image, position, position_x, position_y, is_substitute, team_id, registration_player_id").eq("team_id",i.home_team.id).order("position"),a.from("players").select("id, name, player_image, position, position_x, position_y, is_substitute, team_id, registration_player_id").eq("team_id",i.away_team.id).order("position")]);e.data&&y(e.data),s.data&&f(s.data)}}catch(i){}finally{b(!1)}},B=async()=>{if(t&&M&&n)try{const{data:e}=await a.from("match_likes").select("id").eq("match_id",t);S(e?e.length:0);const{data:s}=await a.from("match_predictions").select("prediction").eq("match_id",t);if(s){const e={home:s.filter(e=>"home"===e.prediction).length,draw:s.filter(e=>"draw"===e.prediction).length,away:s.filter(e=>"away"===e.prediction).length};T(e);const{data:i}=await a.from("match_predictions").select("prediction").eq("match_id",t).eq("user_identifier",M).maybeSingle();i&&P(i.prediction)}}catch(e){}},z=async()=>{if(n&&n.home_team_id&&n.away_team_id){A(!0);try{const{data:e}=await a.from("teams").select("*").eq("id",n.home_team_id).single(),{data:s}=await a.from("teams").select("*").eq("id",n.away_team_id).single();if(!e||!s)return void A(!1);const{data:t}=await a.from("matches").select("home_score, away_score, home_team_id, away_team_id").or(`home_team_id.eq.${n.home_team_id},away_team_id.eq.${n.home_team_id}`).eq("status","completed").order("match_date",{ascending:!1}).limit(2),{data:i}=await a.from("matches").select("home_score, away_score, home_team_id, away_team_id").or(`home_team_id.eq.${n.away_team_id},away_team_id.eq.${n.away_team_id}`).eq("status","completed").order("match_date",{ascending:!1}).limit(2);let l=0,r=0,o=0;t&&t.length>0&&t.forEach(e=>{e.home_team_id===n.home_team_id?(l+=e.home_score||0,r+=e.away_score||0,o++):(l+=e.away_score||0,r+=e.home_score||0,o++)});let c=0,d=0,m=0;i&&i.length>0&&i.forEach(e=>{e.home_team_id===n.away_team_id?(c+=e.home_score||0,d+=e.away_score||0,m++):(c+=e.away_score||0,d+=e.home_score||0,m++)});const{data:h}=await a.from("teams").select("goals_for, goals_against, played").eq("category",n.category||"open-age").gt("played",0);let p=1.5,u=1.5;if(h&&h.length>0){const e=h.reduce((e,a)=>e+(a.goals_for||0),0),a=h.reduce((e,a)=>e+(a.goals_against||0),0),s=h.reduce((e,a)=>e+(a.played||0),0);s>0&&(p=e/s,u=a/s)}const x=o>0?l/o:e.played>0?(e.goals_for||0)/e.played:p,y=o>0?r/o:e.played>0?(e.goals_against||0)/e.played:u,_=m>0?c/m:s.played>0?(s.goals_for||0)/s.played:p,f=m>0?d/m:s.played>0?(s.goals_against||0)/s.played:u,g=0===o&&0===e.played?1:p>0?x/p:1,j=0===o&&0===e.played?1:u>0?y/u:1,v=0===m&&0===s.played?1:p>0?_/p:1,w=0===m&&0===s.played?1:u>0?f/u:1,N=g*(1/w)*p*1.12,b=v*(1/j)*p,C=Math.round(N),S=Math.round(b),M=(e,a)=>{if(e<=0)return 0===a?1:0;let s=-e+a*Math.log(e);for(let t=2;t<=a;t++)s-=Math.log(t);return Math.exp(s)};let k=0,q=0,L=0;for(let a=0;a<=5;a++)for(let e=0;e<=5;e++){const s=M(N,a)*M(b,e);a>e?k+=s:a===e?q+=s:L+=s}const E=k+q+L;E>0?(k=k/E*100,q=q/E*100,L=L/E*100):(k=33.33,q=33.33,L=33.34),$({homeScore:Math.max(0,C),awayScore:Math.max(0,S),homeWinProb:Math.round(k),drawProb:Math.round(q),awayWinProb:Math.round(L),homeTeam:e.name,awayTeam:s.name})}catch(e){}finally{A(!1)}}};if(N)return s.jsxs(s.Fragment,{children:[s.jsx(l,{}),s.jsx("div",{className:"match-detail-loading",children:s.jsxs("div",{className:"fixtures-loading-content",children:[s.jsxs("div",{className:"logo-loader",children:[s.jsx("div",{className:"logo-ring"}),s.jsx("img",{src:"/assets/img/muq_invert.png",alt:"Muqawama",className:"logo-pulse"})]}),s.jsx("p",{children:"Loading match details..."})]})}),s.jsx(r,{edition:"2026"})]});if(!n)return s.jsxs(s.Fragment,{children:[s.jsx(l,{}),s.jsxs("div",{className:"match-detail-error",children:[s.jsx("i",{className:"fas fa-exclamation-triangle"}),s.jsx("p",{children:"Match not found"})]}),s.jsx(r,{edition:"2026"})]});const I="completed"===n.status;return s.jsxs(s.Fragment,{children:[s.jsx(l,{}),s.jsxs("div",{className:"match-detail-page",children:[s.jsx(c,{matchId:t,userIdentifier:M,initialLikeCount:C}),s.jsx(d,{match:n}),s.jsx("section",{className:"match-detail-content",children:s.jsxs("div",{className:"match-detail-single-column",children:[s.jsx(m,{match:n,matchId:t,userIdentifier:M,userPrediction:E,userPredictionStats:F,onPredictionUpdate:e=>{P(e)},onStatsUpdate:e=>{T(e)}}),s.jsx(h,{goals:g,cards:v,match:n,isFinished:I}),s.jsxs("div",{className:"formation-section",children:[s.jsx("h3",{className:"panel-title",children:"FORMATIONS"}),s.jsx(o,{homePlayers:x,awayPlayers:_,homeTeam:n.home_team,awayTeam:n.away_team,goals:g,cards:v})]}),s.jsx(p,{homeTeamPlayers:x,awayTeamPlayers:_,match:n,goals:g,cards:v})]})}),s.jsx("div",{className:"match-detail-footer"})]}),s.jsx(r,{edition:"2026"})]})}function x(){const[a,t]=e.useState("list"),[i,l]=e.useState(null);e.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("match");return e&&(l(e),t("detail")),window.addEventListener("popstate",r),()=>window.removeEventListener("popstate",r)},[]);const r=()=>{const e=new URLSearchParams(window.location.search).get("match");e?(l(e),t("detail")):(t("list"),l(null))},o=()=>{const e=window.location.pathname;window.history.pushState({},"",e),t("list"),l(null)};return"detail"===a&&i?s.jsx(u,{matchId:i,onBack:o}):s.jsx(n,{onMatchClick:e=>{const a=`${window.location.pathname}?match=${e}`;window.history.pushState({matchId:e},"",a),l(e),t("detail"),window.scrollTo(0,0)}})}t.createRoot(document.getElementById("fixtures-root")).render(s.jsx(i.StrictMode,{children:s.jsx(x,{})}));
