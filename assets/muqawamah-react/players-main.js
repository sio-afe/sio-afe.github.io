import{r as e,s as a,j as s,c as l,R as i}from"./supabaseClient-ClKdzuI3.js";import{F as r}from"./Footer-CtlgMCy7.js";import{T as t}from"./TournamentNavbar-Dc8uCZ-S.js";const n={GK:"Goalkeeper",CB:"Defender",LB:"Defender",RB:"Defender",CDM:"Midfielder",CM:"Midfielder",CAM:"Midfielder",LM:"Midfielder",RM:"Midfielder",CF:"Forward",ST:"Forward",SUB:"Substitute"},c={Goalkeeper:"GOALKEEPERS",Defender:"DEFENDERS",Midfielder:"MIDFIELDERS",Forward:"FORWARDS",Substitute:"SUBSTITUTES"};function d({playerId:l,onBack:i,onNavigateToPlayer:d}){var o,m,h,p;const[j,x]=e.useState(null),[u,g]=e.useState([]),[N,v]=e.useState(!0);e.useEffect(()=>{l&&y()},[l]);const y=async()=>{try{const{data:e,error:s}=await a.from("team_players").select("id, player_name, player_image, position, player_age, team_id, team_registrations(id, team_name, team_logo)").eq("id",l).single();if(s)throw s;x(e),(null==e?void 0:e.team_id)&&a.from("team_players").select("id, player_name, player_image, position").eq("team_id",e.team_id).neq("id",l).then(({data:e})=>{e&&g(e)})}catch(e){}finally{v(!1)}},f=e=>n[e]||e||"Unknown";if(N)return s.jsx("div",{className:"player-detail-loading",children:s.jsxs("div",{className:"players-loading-content",children:[s.jsxs("div",{className:"logo-loader",children:[s.jsx("div",{className:"logo-ring"}),s.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama",className:"logo-pulse"})]}),s.jsx("p",{children:"Loading player..."})]})});if(!j)return s.jsxs("div",{className:"player-detail-error",children:[s.jsx("i",{className:"fas fa-exclamation-triangle"}),s.jsx("p",{children:"Player not found"}),s.jsxs("button",{onClick:i,className:"back-btn",children:[s.jsx("i",{className:"fas fa-arrow-left"})," Back to Players"]})]});const S=j.team_registrations,w=f(j.position),_=(()=>{const e={};return u.forEach(a=>{const s=f(a.position),l=c[s]||"OTHERS";e[l]||(e[l]=[]),e[l].push(a)}),e})(),b={apps:(null==(o=j.stats)?void 0:o.apps)||0,goals:(null==(m=j.stats)?void 0:m.goals)||0,assists:(null==(h=j.stats)?void 0:h.assists)||0},M=j.match_log||[];return s.jsxs(s.Fragment,{children:[s.jsx(t,{}),s.jsxs("div",{className:"player-detail",children:[s.jsxs("div",{className:"player-hero",children:[s.jsx("div",{className:"player-hero-bg"}),s.jsxs("div",{className:"hero-logos",children:[s.jsx("div",{className:"team-logo-hero",children:(null==S?void 0:S.team_logo)?s.jsx("img",{src:S.team_logo,alt:S.team_name}):s.jsx("span",{children:(null==(p=null==S?void 0:S.team_name)?void 0:p.charAt(0))||"?"})}),s.jsx("div",{className:"tournament-logo-hero",children:s.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama"})})]}),s.jsxs("div",{className:"player-hero-content",children:[s.jsx("div",{className:"player-photo-hero",children:j.player_image?s.jsx("img",{src:j.player_image,alt:j.player_name}):s.jsx("div",{className:"player-photo-placeholder-hero",children:s.jsx("i",{className:"fas fa-user"})})}),s.jsxs("div",{className:"player-info-hero",children:[s.jsx("h1",{className:"player-name-hero",children:j.player_name}),s.jsxs("div",{className:"player-meta-hero",children:[s.jsx("span",{className:"meta-label",children:"Position:"}),s.jsx("span",{className:"meta-value",children:w}),s.jsx("span",{className:"meta-label",children:"Age:"}),s.jsx("span",{className:"meta-value",children:j.player_age||"-"})]})]})]})]}),s.jsxs("div",{className:"player-detail-body",children:[s.jsxs("div",{className:"player-detail-main",children:[s.jsxs("div",{className:"season-header",children:[s.jsx("h2",{className:"section-title-italic",children:"SEASONS"}),s.jsxs("div",{className:"season-selector",children:[s.jsx("span",{children:"2026"}),s.jsx("i",{className:"fas fa-chevron-down"})]})]}),s.jsxs("div",{className:"quick-stats-card",children:[s.jsxs("div",{className:"quick-stat",children:[s.jsx("span",{className:"stat-value-big",children:b.apps}),s.jsx("span",{className:"stat-label",children:"APPS"})]}),s.jsx("div",{className:"stat-divider"}),s.jsxs("div",{className:"quick-stat",children:[s.jsx("span",{className:"stat-value-big",children:b.goals}),s.jsx("span",{className:"stat-label",children:"GOALS"})]}),s.jsx("div",{className:"stat-divider"}),s.jsxs("div",{className:"quick-stat",children:[s.jsx("span",{className:"stat-value-big",children:b.assists}),s.jsx("span",{className:"stat-label",children:"ASSISTS"})]})]}),s.jsxs("div",{className:"match-log-section",children:[s.jsx("h3",{className:"section-title-italic",children:"MATCH LOG"}),M.length>0?s.jsxs("div",{className:"match-log-table",children:[s.jsxs("div",{className:"match-log-header",children:[s.jsx("span",{children:"MW"}),s.jsx("span",{children:"DATE"}),s.jsx("span",{children:"MATCH"}),s.jsx("span",{children:"SCORE"}),s.jsx("span",{children:"MP"}),s.jsx("span",{children:"G"}),s.jsx("span",{children:"Y"}),s.jsx("span",{children:"R"})]}),M.map((e,a)=>s.jsxs("div",{className:"match-log-row",children:[s.jsx("span",{children:e.matchweek}),s.jsx("span",{children:e.date}),s.jsxs("span",{className:"match-teams",children:[s.jsx("img",{src:e.home_logo,alt:"",className:"match-team-logo"}),s.jsx("span",{children:e.home_abbr}),s.jsx("span",{className:"vs",children:"vs"}),s.jsx("img",{src:e.away_logo,alt:"",className:"match-team-logo"}),s.jsx("span",{children:e.away_abbr})]}),s.jsx("span",{className:`match-score ${e.result}`,children:e.score}),s.jsx("span",{children:e.minutes}),s.jsx("span",{children:e.goals}),s.jsx("span",{children:e.yellows}),s.jsx("span",{children:e.reds})]},a))]}):s.jsx("div",{className:"no-matches",children:s.jsx("p",{children:"No matches played yet"})})]})]}),s.jsxs("div",{className:"player-detail-sidebar",children:[s.jsx("h3",{className:"section-title",children:"TEAMMATES"}),s.jsx("div",{className:"teammates-list",children:Object.entries(_).map(([e,a])=>s.jsxs("div",{className:"teammate-group",children:[s.jsx("h4",{className:"teammate-group-title",children:e}),a.map((e,a)=>s.jsxs("div",{className:"teammate-row",onClick:()=>d&&d(e.id,e.player_name),children:[s.jsx("span",{className:"teammate-number",children:a+1}),s.jsx("div",{className:"teammate-photo",children:e.player_image?s.jsx("img",{src:e.player_image,alt:e.player_name}):s.jsx("i",{className:"fas fa-user"})}),s.jsx("span",{className:"teammate-name",children:e.player_name})]},e.id))]},e))})]})]}),s.jsx("div",{className:"player-detail-footer",children:s.jsxs("button",{onClick:i,className:"back-btn",children:[s.jsx("i",{className:"fas fa-arrow-left"})," Back to Players"]})}),s.jsx(r,{edition:"2026"})]})]})}const o={GK:"Goalkeeper",CB:"Defender",LB:"Defender",RB:"Defender",CDM:"Midfielder",CM:"Midfielder",CAM:"Midfielder",LM:"Midfielder",RM:"Midfielder",CF:"Striker",ST:"Striker",SUB:"Substitute"},m={Goalkeeper:"#4CAF50",Defender:"#2196F3",Midfielder:"#FF9800",Striker:"#f44336",Substitute:"#9e9e9e"};function h(){const[l,i]=e.useState([]),[n,c]=e.useState([]),[h,p]=e.useState(!0),[j,x]=e.useState(""),[u,g]=e.useState("all"),[N,v]=e.useState("all"),[y,f]=e.useState(null),[S,w]=e.useState("list");e.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("player");return e?(f(e),w("detail"),p(!1)):b(),window.addEventListener("popstate",_),()=>window.removeEventListener("popstate",_)},[]);const _=()=>{const e=new URLSearchParams(window.location.search).get("player");e?(f(e),w("detail")):(w("list"),f(null))},b=async()=>{try{const{data:e,error:s}=await a.from("team_registrations").select("id, team_name, team_logo, category").eq("status","confirmed").eq("category","open-age");if(s)throw s;if(c(e||[]),e&&e.length>0){const s=e.map(e=>e.id),{data:l,error:r}=await a.from("team_players").select("*, team_registrations(id, team_name, team_logo)").in("team_id",s);if(r)throw r;i(l||[])}}catch(e){}finally{p(!1)}},M=()=>{window.history.pushState({},"","/muqawamah/2026/open-age/players/"),w("list"),f(null)},k=e=>o[e]||e,C=l.filter(e=>{var a;const s=null==(a=e.player_name)?void 0:a.toLowerCase().includes(j.toLowerCase()),l="all"===u||e.team_id===u,i=k(e.position);return s&&l&&("all"===N||i===N)});return h?s.jsx("div",{className:"players-loading",children:s.jsxs("div",{className:"players-loading-content",children:[s.jsxs("div",{className:"logo-loader",children:[s.jsx("div",{className:"logo-ring"}),s.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama",className:"logo-pulse"})]}),s.jsx("p",{children:"Loading players..."})]})}):"detail"===S&&y?s.jsx(d,{playerId:y,onBack:M,onNavigateToPlayer:(e,a)=>{const s=`/muqawamah/2026/open-age/players/?player=${e}`;window.history.pushState({playerId:e},"",s),f(e),window.scrollTo(0,0)}}):s.jsxs(s.Fragment,{children:[s.jsx(t,{}),s.jsxs("div",{className:"player-database",children:[s.jsxs("div",{className:"player-database-header",children:[s.jsx("h1",{className:"player-database-title",children:"Player Database"}),s.jsxs("div",{className:"player-filters",children:[s.jsxs("div",{className:"search-box",children:[s.jsx("i",{className:"fas fa-search"}),s.jsx("input",{type:"text",placeholder:"Write a player name and hit enter...",value:j,onChange:e=>x(e.target.value)})]}),s.jsxs("div",{className:"filter-row",children:[s.jsxs("select",{value:u,onChange:e=>g(e.target.value),className:"filter-select",children:[s.jsx("option",{value:"all",children:"ALL TEAMS"}),n.map(e=>s.jsx("option",{value:e.id,children:e.team_name},e.id))]}),s.jsxs("select",{value:N,onChange:e=>v(e.target.value),className:"filter-select filter-select-wide",children:[s.jsx("option",{value:"all",children:"ALL POSITIONS"}),s.jsx("option",{value:"Goalkeeper",children:"Goalkeeper"}),s.jsx("option",{value:"Defender",children:"Defender"}),s.jsx("option",{value:"Midfielder",children:"Midfielder"}),s.jsx("option",{value:"Striker",children:"Striker"}),s.jsx("option",{value:"Substitute",children:"Substitute"})]}),s.jsx("button",{className:"reset-btn",onClick:()=>{x(""),g("all"),v("all")},children:"RESET"})]})]})]}),s.jsx("div",{className:"players-count",children:s.jsxs("span",{children:[C.length," players found"]})}),s.jsx("div",{className:"players-grid",children:C.map(e=>{var a;const l=k(e.position),i=m[l]||"#666",r=e.team_registrations;return s.jsxs("div",{className:"player-card-db",onClick:()=>(e=>{const a=`/muqawamah/2026/open-age/players/?player=${e.id}`;window.history.pushState({playerId:e.id},"",a),f(e.id),w("detail"),window.scrollTo(0,0)})(e),style:{cursor:"pointer"},children:[s.jsx("div",{className:"position-tag",style:{backgroundColor:i},children:l.toUpperCase()}),s.jsx("div",{className:"player-photo-container",children:e.player_image?s.jsx("img",{src:e.player_image,alt:e.player_name,className:"player-photo"}):s.jsx("div",{className:"player-photo-placeholder",children:s.jsx("i",{className:"fas fa-user"})})}),s.jsxs("div",{className:"player-info-bar",children:[s.jsx("div",{className:"team-logo-small",children:(null==r?void 0:r.team_logo)?s.jsx("img",{src:r.team_logo,alt:r.team_name}):s.jsx("span",{children:(null==(a=null==r?void 0:r.team_name)?void 0:a.charAt(0))||"?"})}),s.jsx("span",{className:"player-name-db",children:e.player_name})]})]},e.id)})}),0===C.length&&s.jsxs("div",{className:"no-players",children:[s.jsx("i",{className:"fas fa-users-slash"}),s.jsx("p",{children:"No players found matching your criteria"})]}),s.jsx("div",{className:"back-to-tournament",children:s.jsxs("a",{href:"/muqawamah/2026/",className:"back-link",children:[s.jsx("i",{className:"fas fa-arrow-left"})," Back to Tournament"]})}),s.jsx(r,{edition:"2026"})]})]})}l.createRoot(document.getElementById("players-root")).render(s.jsx(i.StrictMode,{children:s.jsx(h,{})}));
