import{r as a,s,j as e,c as i,R as t}from"./supabaseClient-y7L7r4ir.js";import{T as l}from"./TournamentNavbar-EfpgZXgP.js";import{F as r}from"./Footer-Cjjkr2XU.js";import{a as n}from"./ShareableCard-C5q5CsRB.js";import"./supabase-client-FID_-7ME.js";import"./index-cwrHH8V6.js";function m(){const[i,t]=a.useState("goals"),[m,o]=a.useState({goals:[],assists:[]}),[c,d]=a.useState([]),[g,h]=a.useState(!0),[p,_]=a.useState(!1),[v]=a.useState(window.location.pathname.includes("/u17/")?"u17":"open-age");a.useEffect(()=>{j()},[v]);const j=async()=>{try{h(!0);const{data:a}=await s.from("matches").select("id").eq("category",v),e=(a||[]).map(a=>a.id),{data:i}=await s.from("goals").select("\n          scorer_id,\n          assister_id,\n          team_id,\n          scorer:team_players!goals_scorer_id_fkey(id, player_name, player_image, team_id, team_registrations(team_name, team_logo)),\n          assister:team_players!goals_assister_id_fkey(id, player_name, player_image, team_id, team_registrations(team_name, team_logo))\n        ").in("match_id",e),{data:t}=await s.from("teams").select("id").eq("category",v),l=(null==t?void 0:t.map(a=>a.id))||[],{data:r}=await s.from("players").select("id, name, player_image, registration_player_id, team_id, team:teams(name, crest_url)").in("team_id",l),n={};(r||[]).forEach(a=>{a.registration_player_id&&(n[a.registration_player_id]=a)});const m={},c={};(i||[]).forEach(a=>{var s,e,i,t;if(a.scorer_id){const i=n[a.scorer_id],t=(null==i?void 0:i.id)||a.scorer_id;m[t]||(i?m[t]={id:i.id,player_name:i.name||i.player_name,player_image:i.player_image,team_registrations:{team_name:(null==(s=i.team)?void 0:s.name)||"Unknown",team_logo:(null==(e=i.team)?void 0:e.crest_url)||null},goals:0}:a.scorer&&(m[t]={id:a.scorer.id,player_name:a.scorer.player_name,player_image:a.scorer.player_image,team_registrations:a.scorer.team_registrations,goals:0})),m[t]&&(m[t].goals+=1)}if(a.assister_id){const s=n[a.assister_id],e=(null==s?void 0:s.id)||a.assister_id;c[e]||(s?c[e]={id:s.id,player_name:s.name||s.player_name,player_image:s.player_image,team_registrations:{team_name:(null==(i=s.team)?void 0:i.name)||"Unknown",team_logo:(null==(t=s.team)?void 0:t.crest_url)||null},assists:0}:a.assister&&(c[e]={id:a.assister.id,player_name:a.assister.player_name,player_image:a.assister.player_image,team_registrations:a.assister.team_registrations,assists:0})),c[e]&&(c[e].assists+=1)}});const g=Object.values(m).sort((a,s)=>s.goals-a.goals).slice(0,10),p=Object.values(c).sort((a,s)=>s.assists-a.assists).slice(0,10);o({goals:g,assists:p});const{data:_}=await s.from("teams").select("*").eq("category",v).order("goals_for",{ascending:!1});_&&d(_.slice(0,10))}catch(a){}finally{h(!1)}};if(g)return e.jsxs(e.Fragment,{children:[e.jsx(l,{}),e.jsx("div",{className:"stats-page-v2 stats-loading-v2",children:e.jsxs("div",{className:"stats-loading-content",children:[e.jsxs("div",{className:"logo-loader",children:[e.jsx("div",{className:"logo-ring"}),e.jsx("img",{src:"/assets/img/muq_invert.png",alt:"Muqawama",className:"logo-pulse"})]}),e.jsx("p",{children:"Loading statistics..."})]})}),e.jsx(r,{edition:"2026"})]});const x=[{id:"goals",label:"TOP SCORERS",icon:"fa-futbol"},{id:"assists",label:"TOP ASSISTS",icon:"fa-hands-helping"},{id:"teams",label:"TEAM STATS",icon:"fa-shield-alt"}],u=(a,i)=>e.jsx("div",{className:"leaderboard-v2",children:a.length>0?a.map((a,t)=>{var l,r;return e.jsxs("div",{className:"leaderboard-row-v2 "+(0===t?"top-player":""),onClick:()=>(async a=>{if(a)try{const{data:e,error:i}=await s.from("players").select("id").eq("id",a).single();if(!i&&e){const s="u17"===v?"/muqawamah/2026/u17":"/muqawamah/2026/open-age";return void(window.location.href=`${s}/players/?player=${a}`)}const{data:t,error:l}=await s.from("players").select("id").eq("registration_player_id",a).single();if(l||!t)return void alert("Player details not available");const r="u17"===v?"/muqawamah/2026/u17":"/muqawamah/2026/open-age";window.location.href=`${r}/players/?player=${t.id}`}catch(e){}})(a.id),children:[e.jsx("div",{className:"rank-cell-v2",children:e.jsx("span",{className:"rank-number "+(t<3?"rank-top":""),children:t+1})}),e.jsx("div",{className:"player-photo-v2",children:a.player_image?e.jsx("img",{src:a.player_image,alt:a.player_name,loading:"lazy"}):e.jsx("div",{className:"photo-placeholder",children:e.jsx("i",{className:"fas fa-user"})})}),e.jsxs("div",{className:"player-info-v2",children:[e.jsx("span",{className:"player-name-v2",children:a.player_name}),e.jsxs("div",{className:"team-info-v2",children:[(null==(l=a.team_registrations)?void 0:l.team_logo)&&e.jsx("img",{src:a.team_registrations.team_logo,alt:"",className:"mini-team-logo",loading:"lazy"}),e.jsx("span",{className:"team-name-mini",children:(null==(r=a.team_registrations)?void 0:r.team_name)||"N/A"})]})]}),e.jsx("div",{className:"stat-value-v2",children:e.jsx("span",{className:"stat-number",children:"goals"===i?a.goals||0:a.assists||0})})]},a.id)}):e.jsxs("div",{className:"no-data-v2",children:[e.jsx("i",{className:"fas fa-chart-bar"}),e.jsx("p",{children:"No statistics available yet"})]})});return e.jsxs(e.Fragment,{children:[e.jsx(l,{}),e.jsxs("div",{className:"stats-page-v2",children:[e.jsxs("div",{className:"stats-container-v2",children:[e.jsxs("div",{className:"stats-header-v2",children:[e.jsx("h1",{children:"Statistics"}),e.jsx("hr",{className:"stats-divider"})]}),e.jsx("div",{className:"stats-tabs-container",children:e.jsxs("div",{className:"stats-tabs-v2",children:[x.map((a,s)=>e.jsxs("button",{className:"stats-tab-v2 "+(i===a.id?"active":""),onClick:()=>t(a.id),children:[e.jsx("i",{className:`fas ${a.icon}`}),e.jsx("span",{children:a.label})]},a.id)),e.jsx("span",{className:"stats-tab-slider",style:{transform:`translateX(${100*x.findIndex(a=>a.id===i)}%)`}})]})}),e.jsxs("div",{className:"stats-content-v2",children:["goals"===i&&e.jsxs("div",{className:"stats-section-v2",children:[e.jsxs("div",{className:"section-header-v2",children:[e.jsx("h2",{children:"Top Scorers"}),e.jsx("span",{className:"section-subtitle",children:"Players with most goals"})]}),u(m.goals,"goals")]}),"assists"===i&&e.jsxs("div",{className:"stats-section-v2",children:[e.jsxs("div",{className:"section-header-v2",children:[e.jsx("h2",{children:"Top Assists"}),e.jsx("span",{className:"section-subtitle",children:"Players with most assists"})]}),u(m.assists,"assists")]}),"teams"===i&&e.jsxs("div",{className:"stats-section-v2",children:[e.jsxs("div",{className:"section-header-v2",children:[e.jsx("h2",{children:"Team Statistics"}),e.jsx("span",{className:"section-subtitle",children:"Goals scored and conceded"})]}),e.jsx("div",{className:"leaderboard-v2 team-leaderboard",children:c.length>0?c.map((a,s)=>{var i;return e.jsxs("div",{className:"leaderboard-row-v2 team-row "+(0===s?"top-team":""),onClick:()=>(a=>{const s="u17"===v?"/muqawamah/2026/u17":"/muqawamah/2026/open-age";window.location.href=`${s}/teams/?team=${a}`})(a.id),children:[e.jsx("div",{className:"rank-cell-v2",children:e.jsx("span",{className:"rank-number "+(s<3?"rank-top":""),children:s+1})}),e.jsx("div",{className:"team-logo-v2",children:a.crest_url?e.jsx("img",{src:a.crest_url,alt:a.name,loading:"lazy"}):e.jsx("div",{className:"logo-placeholder",children:e.jsx("span",{children:(null==(i=a.name)?void 0:i.charAt(0))||"?"})})}),e.jsx("div",{className:"team-info-main-v2",children:e.jsx("span",{className:"team-name-v2",children:a.name})}),e.jsxs("div",{className:"team-stats-row",children:[e.jsxs("div",{className:"team-stat-cell",children:[e.jsx("span",{className:"stat-label-mini",children:"GF"}),e.jsx("span",{className:"stat-num",children:a.goals_for||0})]}),e.jsxs("div",{className:"team-stat-cell",children:[e.jsx("span",{className:"stat-label-mini",children:"GA"}),e.jsx("span",{className:"stat-num",children:a.goals_against||0})]}),e.jsxs("div",{className:"team-stat-cell gd-cell",children:[e.jsx("span",{className:"stat-label-mini",children:"GD"}),e.jsxs("span",{className:"stat-num "+(a.goals_for-a.goals_against>=0?"positive":"negative"),children:[(a.goals_for||0)-(a.goals_against||0)>=0?"+":"",(a.goals_for||0)-(a.goals_against||0)]})]})]})]},a.id)}):e.jsxs("div",{className:"no-data-v2",children:[e.jsx("i",{className:"fas fa-shield-alt"}),e.jsx("p",{children:"No team statistics available yet"})]})})]})]})]}),e.jsx("button",{className:"stats-share-btn-fixed",onClick:()=>_(!0),title:"Share Top 3",children:e.jsx("i",{className:"fas fa-share-alt"})}),p&&e.jsx(n,{statType:"teams"===i?"points":i,items:"goals"===i?m.goals.slice(0,3).map(a=>{var s;return{name:a.player_name,image:a.player_image,team_name:null==(s=a.team_registrations)?void 0:s.team_name,value:a.goals||0}}):"assists"===i?m.assists.slice(0,3).map(a=>{var s;return{name:a.player_name,image:a.player_image,team_name:null==(s=a.team_registrations)?void 0:s.team_name,value:a.assists||0}}):c.slice(0,3).map(a=>({name:a.name,crest_url:a.crest_url,value:a.goals_for||0})),onClose:()=>_(!1)})]}),e.jsx(r,{edition:"2026"})]})}i.createRoot(document.getElementById("statistics-root")).render(e.jsx(t.StrictMode,{children:e.jsx(m,{})}));
