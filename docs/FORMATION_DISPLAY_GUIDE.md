## ğŸ¯ Single-Field Formation Display Guide

### **Visual Layout**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MATCH HEADER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Arsenal  â”‚         2  -  1           â”‚ Chelsea  â”‚        â”‚
â”‚  â”‚  Logo    â”‚      (1-3-2-1) (1-4-2-1)  â”‚  Logo    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FOOTBALL FIELD (VERTICAL)                  â”‚
â”‚                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘  CHELSEA (AWAY - TOP HALF) - RED MARKERS          â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘              â­• SÃ¡nchez (GK)                      â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘  â­• James  â­• Silva  â­• Colwill  â­• Chilwell       â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘        â­• FernÃ¡ndez    â­• Caicedo                 â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘              â­• Palmer (âš½ 45')                    â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HALFWAY LINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘              â­• Saka (âš½ 23')                      â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘        â­• Rice    â­• Ã˜degaard (ğŸ…°ï¸)                â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘  â­• White  â­• Saliba  â­• Gabriel (âš½ 78')          â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘              â­• Raya (GK)                         â•‘     â”‚
â”‚  â•‘                                                   â•‘     â”‚
â”‚  â•‘  ARSENAL (HOME - BOTTOM HALF) - BLUE MARKERS      â•‘     â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SUBSTITUTES                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Arsenal Subs        â”‚   â”‚ Chelsea Subs        â”‚         â”‚
â”‚  â”‚ â€¢ Gabriel Jesus     â”‚   â”‚ â€¢ Nicolas Jackson   â”‚         â”‚
â”‚  â”‚ â€¢ Thomas Partey     â”‚   â”‚ â€¢ Conor Gallagher   â”‚         â”‚
â”‚  â”‚ â€¢ Aaron Ramsdale    â”‚   â”‚ â€¢ ÄorÄ‘e PetroviÄ‡    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GOALS TIMELINE                         â”‚
â”‚  23' âš½ Bukayo Saka (Arsenal) - Assist: Martin Ã˜degaard     â”‚
â”‚  45' âš½ Cole Palmer (Chelsea) - Assist: Enzo FernÃ¡ndez      â”‚
â”‚  78' âš½ Gabriel (Arsenal) - Assist: Declan Rice             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š How It Works

### **1. Teams in Standings Table**

```sql
SELECT * FROM teams 
WHERE category = 'open-age' 
ORDER BY points DESC;
```

**Result:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ name        â”‚ played â”‚ won â”‚ points â”‚ formation â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Arsenal FC  â”‚   2    â”‚  2  â”‚   6    â”‚  1-3-2-1  â”‚
â”‚ Chelsea FC  â”‚   2    â”‚  1  â”‚   4    â”‚  1-4-2-1  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **2. Create Match Between Teams**

```sql
INSERT INTO matches (
  home_team_id, 
  away_team_id, 
  category, 
  match_type,
  match_date,
  venue
) VALUES (
  'arsenal-uuid',  -- From teams table
  'chelsea-uuid',  -- From teams table
  'open-age',
  'group',
  '2026-03-15 15:00',
  'Emirates Stadium'
);
```

### **3. Fetch Match Details**

```javascript
const { data } = await supabaseClient
  .rpc('get_match_details', { 
    match_uuid: 'match-uuid' 
  });

// Returns:
{
  match: { date, venue, home_score, away_score },
  home_team: {
    name: "Arsenal FC",
    formation: "1-3-2-1",
    crest_url: "logo.jpg",
    players: [
      { name: "Raya", position: "GK", x: 50, y: 95, ... },
      { name: "White", position: "CB", x: 70, y: 75, ... },
      // ... 5 more starters
    ]
  },
  away_team: {
    name: "Chelsea FC",
    formation: "1-4-2-1",
    players: [ ... ]
  },
  goals: [ ... ]
}
```

### **4. Display Component**

```jsx
import MatchFormationDisplay from './MatchFormationDisplay';

<MatchFormationDisplay matchData={data} />
```

---

## ğŸ¨ Key Features

### **Single Field Layout**
- âœ… ONE football field (vertical orientation)
- âœ… Home team at bottom (blue markers)
- âœ… Away team at top (red markers)
- âœ… Teams face each other across halfway line
- âœ… Player positions mirrored for away team

### **Player Display**
- âœ… Circular markers with photos or position labels
- âœ… Player name below marker
- âœ… Position label (GK, CB, etc.)
- âœ… Hover effect to highlight
- âœ… Goal scorers marked with âš½

### **Match Information**
- âœ… Team crests and names
- âœ… Formation labels (1-3-2-1 vs 1-4-2-1)
- âœ… Match score
- âœ… Substitutes list
- âœ… Goals timeline with assists

---

## ğŸ”„ Position Mapping

### **Home Team (Bottom Half)**
```javascript
// Use positions as-is from database
style={{
  left: `${player.position_x}%`,  // 0-100
  top: `${player.position_y}%`     // 50-100 (bottom half)
}}
```

### **Away Team (Top Half)**
```javascript
// Mirror and flip positions
style={{
  left: `${100 - player.position_x}%`,  // Mirror horizontally
  top: `${100 - player.position_y}%`    // Flip to top half (0-50)
}}
```

**Example:**
- Home GK at (50, 95) â†’ Stays at (50, 95) - bottom center
- Away GK at (50, 95) â†’ Becomes (50, 5) - top center (mirrored)

---

## ğŸ“ Test Data Setup

### **Run in Order:**

1. **Migration Script**  
```sql
-- File: docs/muqawamah-migration.sql
```

2. **Tournament Schema**  
```sql
-- File: docs/database-schema-safe.sql
```

3. **Enhanced Confirmation**  
```sql
-- File: docs/confirm-registration-enhanced.sql
```

4. **Seed Sample Data**  
```sql
-- File: docs/COMPLETE_TEST_SETUP.sql
```

### **What Test Data Creates:**

âœ… **2 Teams in Standings:**
- Arsenal FC (1-3-2-1) - 6 points
- Chelsea FC (1-4-2-1) - 4 points

âœ… **7 Players Each:**
- 1 GK, 3-4 defenders, 2 midfielders, 1 forward
- With positions and coordinates

âœ… **3 Substitutes Each:**
- Listed separately

âœ… **1 Match:**
- Arsenal 2-1 Chelsea
- Completed status
- 3 goals with scorers and assists

---

## ğŸ¯ Frontend Integration

### **Add to Fixtures Component**

```jsx
// In Fixtures.jsx
import MatchFormationDisplay from '../shared/MatchFormationDisplay';

const [selectedMatch, setSelectedMatch] = useState(null);
const [matchDetails, setMatchDetails] = useState(null);

const handleMatchClick = async (matchId) => {
  const { data } = await supabaseClient
    .rpc('get_match_details', { match_uuid: matchId });
  
  setMatchDetails(data);
  setSelectedMatch(matchId);
};

return (
  <>
    {/* Match cards */}
    {fixtures.map(match => (
      <div 
        key={match.id} 
        onClick={() => handleMatchClick(match.id)}
        className="match-card"
      >
        {/* Match info */}
      </div>
    ))}

    {/* Modal with formation */}
    {selectedMatch && (
      <Modal onClose={() => setSelectedMatch(null)}>
        <MatchFormationDisplay matchData={matchDetails} />
      </Modal>
    )}
  </>
);
```

---

## âœ… Summary

**Teams ARE in Standings:**
- `teams` table = standings table
- Sorted by points, goal difference

**Formation Display:**
- âœ… ONE field (not two)
- âœ… Vertical orientation
- âœ… Home team bottom (blue)
- âœ… Away team top (red)
- âœ… Teams face each other
- âœ… Player photos + names
- âœ… Substitutes below
- âœ… Goals timeline

**Test Data:**
- âœ… 2 teams in standings
- âœ… 1 match between them
- âœ… Full lineups with positions
- âœ… Goals with scorers

**Run COMPLETE_TEST_SETUP.sql to see it in action!** ğŸš€

