import{s as e,r as a,j as s,a as t}from"./supabaseClient-BTiblPWy.js";import{c as n,g as i,p as l,F as r,a as c}from"./Registration-C-7DiPzu.js";import{a as o,g as d,i as m,b as h,S as u}from"./tournamentUtils-Bujgfpx0.js";import"./supabase-client-DmFmBHmJ.js";const x=["admin@sio-abulfazal.org"],p="/muqawamah/admin",g="/muqawamah/admin/registrations",j="/muqawamah/admin/players",f="/muqawamah/admin/teams",y="/muqawamah/admin/fixtures",_="/muqawamah/admin/matches",v="/muqawamah/admin/goals",b="/muqawamah/admin/statistics",N="/muqawamah/admin/tournament",w="/muqawamah/admin/utilities",C="/muqawamah/admin/settings",k=[{value:"draft",label:"Draft",color:"#9ca3af"},{value:"submitted",label:"Submitted",color:"#fbbf24"},{value:"pending_verification",label:"Pending Verification",color:"#f59e0b"},{value:"confirmed",label:"Confirmed",color:"#10b981"},{value:"cancelled",label:"Cancelled",color:"#ef4444"}],S=["GK","CB","LB","RB","CDM","CM","CAM","LM","RM","CF","ST"];function A({children:t}){const[n,i]=a.useState(null),[l,r]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{const a=await(async()=>{var a;try{const{data:{user:s},error:t}=await e.auth.getUser();return!(t||!s)&&x.includes(null==(a=s.email)?void 0:a.toLowerCase())}catch(s){return!1}})();i(a),a||(alert("⚠️ Access Denied: You do not have admin privileges. Only authorized super admins can access this area."),window.location.href="/muqawamah/")}catch(a){alert("⚠️ Authentication Error: Unable to verify admin access."),window.location.href="/muqawamah/"}finally{r(!1)}})()},[]),l?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Verifying admin access..."})]}):n?s.jsx(s.Fragment,{children:t}):s.jsxs("div",{className:"admin-unauthorized",children:[s.jsx("i",{className:"fas fa-lock"}),s.jsx("h2",{children:"Unauthorized Access"}),s.jsx("p",{children:"You don't have permission to access this page."})]})}function T({isOpen:e=!1,onClose:t}){const[n,i]=a.useState(window.location.pathname),l=[{icon:"fas fa-tachometer-alt",label:"Dashboard",path:p},{icon:"fas fa-file-alt",label:"Registrations",path:g},{icon:"fas fa-users",label:"Players",path:j},{icon:"fas fa-shield-alt",label:"Teams",path:f},{icon:"fas fa-calendar-alt",label:"Fixtures",path:y},{icon:"fas fa-futbol",label:"Matches",path:_},{icon:"fas fa-trophy",label:"Goals & Stats",path:v},{icon:"fas fa-chart-bar",label:"Statistics",path:b},{icon:"fas fa-sitemap",label:"Tournament",path:N},{icon:"fas fa-tools",label:"Utilities",path:w},{icon:"fas fa-cog",label:"Settings",path:C}];return s.jsxs("aside",{className:"admin-sidebar "+(e?"open":""),children:[s.jsx("button",{className:"admin-sidebar-close",onClick:t,children:s.jsx("i",{className:"fas fa-times"})}),s.jsxs("div",{className:"admin-sidebar-header",children:[s.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama Admin",className:"admin-logo"}),s.jsx("h2",{className:"admin-brand",children:"Muqawama Admin"})]}),s.jsx("nav",{className:"admin-nav",children:l.map(e=>s.jsxs("button",{className:"admin-nav-item "+(n===e.path?"active":""),onClick:()=>{return a=e.path,i(a),t&&t(),void(window.location.href=a);var a},children:[s.jsx("i",{className:e.icon}),s.jsx("span",{children:e.label})]},e.path))}),s.jsx("div",{className:"admin-sidebar-footer",children:s.jsxs("div",{className:"admin-user-info",children:[s.jsx("i",{className:"fas fa-user-shield"}),s.jsx("span",{children:"Super Admin"})]})})]})}function q({title:t,onMenuToggle:n}){const[i,l]=a.useState(null);a.useEffect(()=>{(async()=>{const{data:{user:a}}=await e.auth.getUser();l(a)})()},[]);return s.jsxs("header",{className:"admin-header",children:[s.jsxs("div",{className:"admin-header-left",children:[s.jsx("button",{className:"admin-mobile-toggle",onClick:n,children:s.jsx("i",{className:"fas fa-bars"})}),s.jsx("h1",{className:"admin-page-title",children:t})]}),s.jsx("div",{className:"admin-header-right",children:s.jsxs("div",{className:"admin-user-menu",children:[s.jsx("div",{className:"admin-user-avatar",children:s.jsx("i",{className:"fas fa-user-circle"})}),s.jsxs("div",{className:"admin-user-details",children:[s.jsx("span",{className:"admin-user-email",children:null==i?void 0:i.email}),s.jsx("span",{className:"admin-user-role",children:"Super Admin"})]}),s.jsx("button",{className:"admin-logout-btn",onClick:async()=>{await e.auth.signOut(),window.location.href="/muqawamah/"},title:"Logout",children:s.jsx("i",{className:"fas fa-sign-out-alt"})})]})})]})}function F({children:e,title:t="Admin Dashboard"}){const[n,i]=a.useState(!1),l=()=>i(!1);return s.jsxs("div",{className:"admin-layout",children:[s.jsx("div",{className:"admin-sidebar-overlay "+(n?"open":""),onClick:l}),s.jsx(T,{isOpen:n,onClose:l}),s.jsxs("div",{className:"admin-main",children:[s.jsx(q,{title:t,onMenuToggle:()=>i(!n)}),s.jsx("main",{className:"admin-content",children:e})]})]})}function P(){const[t,n]=a.useState({totalRegistrations:0,confirmedTeams:0,totalPlayers:0,pendingPayments:0,upcomingMatches:0,totalGoals:0}),[i,l]=a.useState(!0);a.useEffect(()=>{r()},[]);const r=async()=>{try{const{count:a}=await e.from("team_registrations").select("*",{count:"exact",head:!0}),{count:s}=await e.from("team_registrations").select("*",{count:"exact",head:!0}).eq("status","confirmed"),{count:t}=await e.from("team_registrations").select("*",{count:"exact",head:!0}).eq("status","pending_payment"),{count:i}=await e.from("team_players").select("*",{count:"exact",head:!0}),{count:l}=await e.from("matches").select("*",{count:"exact",head:!0}).gte("match_date",(new Date).toISOString()),{count:r}=await e.from("goals").select("*",{count:"exact",head:!0});n({totalRegistrations:a||0,confirmedTeams:s||0,totalPlayers:i||0,pendingPayments:t||0,upcomingMatches:l||0,totalGoals:r||0})}catch(a){}finally{l(!1)}},c=[{title:"Total Registrations",value:t.totalRegistrations,icon:"fas fa-file-alt",color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.1)",link:"/muqawamah/admin/registrations"},{title:"Confirmed Teams",value:t.confirmedTeams,icon:"fas fa-check-circle",color:"#10b981",bgColor:"rgba(16, 185, 129, 0.1)",link:"/muqawamah/admin/teams"},{title:"Total Players",value:t.totalPlayers,icon:"fas fa-users",color:"#ec4899",bgColor:"rgba(236, 72, 153, 0.1)",link:"/muqawamah/admin/players"},{title:"Pending Payments",value:t.pendingPayments,icon:"fas fa-clock",color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.1)",link:"/muqawamah/admin/registrations?status=pending_payment"},{title:"Upcoming Matches",value:t.upcomingMatches,icon:"fas fa-calendar-alt",color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.1)",link:"/muqawamah/admin/fixtures"},{title:"Total Goals",value:t.totalGoals,icon:"fas fa-trophy",color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.1)",link:"/muqawamah/admin/goals"}];return s.jsx(F,{title:"Dashboard",children:i?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading dashboard..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"admin-stats-grid",children:c.map((e,a)=>s.jsxs("a",{href:e.link,className:"admin-stat-card clean",children:[s.jsx("div",{className:"stat-icon-wrapper",style:{backgroundColor:e.bgColor},children:s.jsx("i",{className:e.icon,style:{color:e.color}})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("h3",{className:"stat-title",children:e.title}),s.jsx("p",{className:"stat-value",children:e.value})]})]},a))}),s.jsxs("div",{className:"admin-dashboard-bottom",children:[s.jsxs("div",{className:"admin-quick-actions-clean",children:[s.jsx("h2",{className:"section-title-clean",children:"Quick Actions"}),s.jsxs("div",{className:"quick-actions-list",children:[s.jsxs("a",{href:"/muqawamah/admin/registrations",className:"quick-action-item",children:[s.jsx("div",{className:"action-icon",style:{backgroundColor:"rgba(139, 92, 246, 0.1)",color:"#8b5cf6"},children:s.jsx("i",{className:"fas fa-eye"})}),s.jsx("span",{children:"View Registrations"}),s.jsx("i",{className:"fas fa-chevron-right action-arrow"})]}),s.jsxs("a",{href:"/muqawamah/admin/fixtures",className:"quick-action-item",children:[s.jsx("div",{className:"action-icon",style:{backgroundColor:"rgba(59, 130, 246, 0.1)",color:"#3b82f6"},children:s.jsx("i",{className:"fas fa-plus"})}),s.jsx("span",{children:"Create Fixture"}),s.jsx("i",{className:"fas fa-chevron-right action-arrow"})]}),s.jsxs("a",{href:"/muqawamah/admin/matches",className:"quick-action-item",children:[s.jsx("div",{className:"action-icon",style:{backgroundColor:"rgba(16, 185, 129, 0.1)",color:"#10b981"},children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("span",{children:"Record Match Result"}),s.jsx("i",{className:"fas fa-chevron-right action-arrow"})]}),s.jsxs("a",{href:"/muqawamah/admin/teams",className:"quick-action-item",children:[s.jsx("div",{className:"action-icon",style:{backgroundColor:"rgba(236, 72, 153, 0.1)",color:"#ec4899"},children:s.jsx("i",{className:"fas fa-shield-alt"})}),s.jsx("span",{children:"Manage Teams"}),s.jsx("i",{className:"fas fa-chevron-right action-arrow"})]})]})]}),s.jsxs("div",{className:"admin-recent-activity",children:[s.jsx("h2",{className:"section-title-clean",children:"Recent Activity"}),s.jsxs("div",{className:"activity-list",children:[s.jsxs("div",{className:"activity-item",children:[s.jsx("div",{className:"activity-icon",style:{backgroundColor:"rgba(16, 185, 129, 0.1)",color:"#10b981"},children:s.jsx("i",{className:"fas fa-check"})}),s.jsxs("div",{className:"activity-details",children:[s.jsx("p",{className:"activity-title",children:"Team Registration Confirmed"}),s.jsx("p",{className:"activity-time",children:"2 hours ago"})]})]}),s.jsxs("div",{className:"activity-item",children:[s.jsx("div",{className:"activity-icon",style:{backgroundColor:"rgba(59, 130, 246, 0.1)",color:"#3b82f6"},children:s.jsx("i",{className:"fas fa-calendar"})}),s.jsxs("div",{className:"activity-details",children:[s.jsx("p",{className:"activity-title",children:"New Match Scheduled"}),s.jsx("p",{className:"activity-time",children:"5 hours ago"})]})]}),s.jsxs("div",{className:"activity-item",children:[s.jsx("div",{className:"activity-icon",style:{backgroundColor:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:s.jsx("i",{className:"fas fa-futbol"})}),s.jsxs("div",{className:"activity-details",children:[s.jsx("p",{className:"activity-title",children:"Match Result Recorded"}),s.jsx("p",{className:"activity-time",children:"1 day ago"})]})]})]})]})]})]})})}const M=["GK","CB","LB","RB","CDM","CM","CAM","LM","RM","CF","ST","SUB"];function L(){var t,l;const[r,c]=a.useState([]),[o,d]=a.useState(!0),[m,h]=a.useState("all"),[u,x]=a.useState(""),[p,g]=a.useState(null),[j,f]=a.useState(!1),[y,_]=a.useState({}),[v,b]=a.useState(null),[N,w]=a.useState(!1),[C,S]=a.useState(!1),[A,T]=a.useState(!1),[q,P]=a.useState({player_name:"",player_age:"",aadhar_no:"",position:"SUB",is_substitute:!0,player_image:null}),[L,$]=a.useState(!1),[D,R]=a.useState(!1),[G,E]=a.useState({});a.useEffect(()=>{z(),U()},[m]);const U=async()=>{try{const{data:a,error:s}=await e.from("teams").select("registration_id");if(s)throw s;const t={};null==a||a.forEach(e=>{e.registration_id&&(t[e.registration_id]=!0)}),_(t)}catch(a){}},z=async()=>{try{d(!0);let a=e.from("team_registrations").select("*, team_players(count)").order("created_at",{ascending:!1});"all"!==m&&(a=a.eq("status",m));const{data:s,error:t}=await a;if(t)throw t;c(s||[])}catch(a){alert("Failed to load registrations")}finally{d(!1)}},I=async(a,s)=>{try{const{error:t}=await e.from("team_registrations").update({status:s,confirmed_at:"confirmed"===s?(new Date).toISOString():null}).eq("id",a);if(t)throw t;alert("Status updated successfully!"),z()}catch(t){alert("Failed to update status")}},O=async a=>{if(y[a.id])alert(`ℹ️ "${a.team_name}" is already in the tournament!`);else if(confirm(`Add "${a.team_name}" to the tournament?\n\nThis will create an entry in the teams table for fixtures and standings, and copy all players.`))try{const{data:s}=await e.from("teams").select("id").eq("registration_id",a.id).single();if(s)return alert("This team is already in the tournament!"),void U();const{data:t,error:n}=await e.from("teams").insert({name:a.team_name,crest_url:a.team_logo,captain:a.captain_name,category:a.category,formation:a.formation,registration_id:a.id}).select().single();if(n)throw n;const{data:i,error:l}=await e.from("team_players").select("*").eq("team_id",a.id);if(l)throw l;if(i&&i.length>0){const a=i.map(e=>({team_id:t.id,name:e.player_name,position:e.position,is_substitute:e.is_substitute,player_image:e.player_image,position_x:e.position_x,position_y:e.position_y,registration_player_id:e.id})),{error:s}=await e.from("players").insert(a);if(s)throw s}alert(`✅ "${a.team_name}" added to tournament successfully!\n\n${(null==i?void 0:i.length)||0} players copied.\n\nYou can now create fixtures and matches for this team.`),U()}catch(s){alert("Failed to add team to tournament: "+s.message)}},B=async a=>{try{const{data:s,error:t}=await e.from("team_registrations").select("*, team_players(*)").eq("id",a).single();if(t)throw t;g(s),$(!1),E({}),f(!0)}catch(s){alert("Failed to load details")}},V=(e,a)=>{b(s=>({...s,[e]:a}))},Y=(e,a)=>{E(s=>({...s,[e]:a}))},H=r.filter(e=>{var a,s,t;return(null==(a=e.team_name)?void 0:a.toLowerCase().includes(u.toLowerCase()))||(null==(s=e.captain_name)?void 0:s.toLowerCase().includes(u.toLowerCase()))||(null==(t=e.captain_email)?void 0:t.toLowerCase().includes(u.toLowerCase()))}),K=e=>{const a=k.find(a=>a.value===e);return s.jsx("span",{className:"status-badge",style:{backgroundColor:(null==a?void 0:a.color)||"#6b7280"},children:(null==a?void 0:a.label)||e})};return s.jsxs(F,{title:"Registrations Management",children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("div",{className:"page-header-left",children:s.jsxs("button",{className:"refresh-btn",onClick:z,children:[s.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})}),s.jsx("div",{className:"page-header-right",children:s.jsxs("div",{className:"search-box",children:[s.jsx("i",{className:"fas fa-search"}),s.jsx("input",{type:"text",placeholder:"Search by team, captain, or email...",value:u,onChange:e=>x(e.target.value)})]})})]}),s.jsxs("div",{className:"filter-tabs",children:[s.jsxs("button",{className:"filter-tab "+("all"===m?"active":""),onClick:()=>h("all"),children:["All (",r.length,")"]}),k.map(e=>s.jsx("button",{className:"filter-tab "+(m===e.value?"active":""),onClick:()=>h(e.value),children:e.label},e.value))]}),o?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading registrations..."})]}):s.jsx("div",{className:"admin-table-container",children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Team Name"}),s.jsx("th",{children:"Captain"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Players"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Created"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===H.length?s.jsx("tr",{children:s.jsxs("td",{colSpan:"7",style:{textAlign:"center",padding:"40px"},children:[s.jsx("i",{className:"fas fa-inbox",style:{fontSize:"3rem",color:"#ccc"}}),s.jsx("p",{children:"No registrations found"})]})}):H.map(a=>{var t,n;return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{className:"team-cell",children:[a.team_logo&&s.jsx("img",{src:a.team_logo,alt:"",className:"team-logo-small"}),s.jsx("strong",{children:a.team_name})]})}),s.jsxs("td",{children:[s.jsx("div",{children:a.captain_name}),s.jsx("small",{style:{color:"#6b7280"},children:a.captain_email})]}),s.jsx("td",{children:s.jsx("span",{className:"category-badge",children:a.category})}),s.jsxs("td",{children:[(null==(n=null==(t=a.team_players)?void 0:t[0])?void 0:n.count)||0," players"]}),s.jsx("td",{children:K(a.status)}),s.jsx("td",{children:new Date(a.created_at).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn-icon btn-view",onClick:()=>B(a.id),title:"View Details",children:s.jsx("i",{className:"fas fa-eye"})}),"confirmed"===a.status&&(y[a.id]?s.jsx("button",{className:"btn-icon btn-tournament-added",disabled:!0,title:"Already in Tournament",children:s.jsx("i",{className:"fas fa-check-circle"})}):s.jsx("button",{className:"btn-icon btn-tournament",onClick:e=>{e.stopPropagation(),O(a)},title:"Add to Tournament",children:s.jsx("i",{className:"fas fa-trophy"})})),s.jsx("button",{className:"btn-icon btn-delete",onClick:()=>(async a=>{const s=r.find(e=>e.id===a);if(!s)return;const t=`⚠️ WARNING: This will permanently delete the registration for "${s.team_name}" and ALL related data:\n\n✓ All players in this registration\n✓ If added to tournament: the team, all matches, and all goals\n\nThis action CANNOT be undone!\n\nType the team name to confirm: "${s.team_name}"`,n=prompt(t);if(n===s.team_name)try{const{data:t,error:n}=await e.from("teams").select("id").eq("registration_id",a).maybeSingle();if(n&&"PGRST116"!==n.code)throw n;if(t){const{error:a}=await e.from("players").delete().eq("team_id",t.id);if(a)throw new Error(`Failed to delete tournament players: ${a.message}`);const{error:s}=await e.from("goals").delete().eq("team_id",t.id);if(s)throw new Error(`Failed to delete goals: ${s.message}`);const{error:n}=await e.from("matches").delete().or(`home_team_id.eq.${t.id},away_team_id.eq.${t.id}`);if(n)throw new Error(`Failed to delete matches: ${n.message}`);const{error:i}=await e.from("teams").delete().eq("id",t.id);if(i)throw new Error(`Failed to delete team: ${i.message}`)}const{error:i}=await e.from("team_players").delete().eq("team_id",a);if(i)throw new Error(`Failed to delete registration players: ${i.message}`);const{error:l}=await e.from("team_registrations").delete().eq("id",a);if(l)throw new Error(`Failed to delete registration: ${l.message}`);alert(`✅ Successfully deleted "${s.team_name}" and all related data!`),z(),U()}catch(i){alert(`❌ Failed to delete registration: ${i.message}`)}else null!==n&&alert("Team name did not match. Deletion cancelled.")})(a.id),title:"Delete",children:s.jsx("i",{className:"fas fa-trash"})})]})})]},a.id)})})]})}),j&&p&&s.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Registration Details"}),s.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"detail-section",children:[s.jsxs("h3",{children:["Team Information",!L&&s.jsxs("button",{className:"btn-edit-team",onClick:()=>{E({team_name:p.team_name,category:p.category,formation:p.formation,team_logo:p.team_logo}),$(!0)},title:"Edit Team Details",children:[s.jsx("i",{className:"fas fa-edit"})," Edit"]})]}),L?s.jsxs("div",{className:"team-edit-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Team Logo"}),G.team_logo&&s.jsx("div",{className:"current-image-preview",children:s.jsx("img",{src:G.team_logo,alt:"Team logo"})}),s.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{var a;const s=null==(a=e.target.files)?void 0:a[0];if(s)if(s.size>2097152)alert("Image must be under 2MB");else try{const e=await n(s,{maxWidth:800,maxHeight:800,quality:.85,outputFormat:"image/webp"});i(e),Math.round(s.size/1024);E(a=>({...a,team_logo:e}))}catch(t){alert("Failed to process image. Please try another file.")}}})]}),s.jsxs("div",{className:"detail-grid",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Team Name:"}),s.jsx("input",{type:"text",value:G.team_name||"",onChange:e=>Y("team_name",e.target.value),className:"edit-input"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Category:"}),s.jsxs("select",{value:G.category||"open-age",onChange:e=>Y("category",e.target.value),className:"edit-input",children:[s.jsx("option",{value:"open-age",children:"Open Age"}),s.jsx("option",{value:"u17",children:"U17"})]})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Formation:"}),s.jsxs("select",{value:G.formation||"1-3-2-1",onChange:e=>Y("formation",e.target.value),className:"edit-input",children:[s.jsx("option",{value:"1-3-2-1",children:"1-3-2-1"}),s.jsx("option",{value:"1-2-3-1",children:"1-2-3-1"}),s.jsx("option",{value:"1-4-1-1",children:"1-4-1-1"}),s.jsx("option",{value:"1-3-1-2",children:"1-3-1-2"}),s.jsx("option",{value:"1-2-2-2",children:"1-2-2-2"})]})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Status:"}),K(p.status)]})]}),s.jsxs("div",{className:"team-edit-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{$(!1),E({})},disabled:D,children:"Cancel"}),s.jsx("button",{className:"btn-primary",onClick:async()=>{if(G.team_name&&G.team_name.trim()){R(!0);try{const{error:a}=await e.from("team_registrations").update({team_name:G.team_name,category:G.category,formation:G.formation,team_logo:G.team_logo}).eq("id",p.id);if(a)throw a;alert("Team details updated successfully!"),$(!1),B(p.id)}catch(a){alert("Failed to update team: "+a.message)}finally{R(!1)}}else alert("Team name is required")},disabled:D,children:D?"Saving...":"Save Changes"})]})]}):s.jsxs("div",{className:"detail-grid",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Team Logo:"}),p.team_logo?s.jsx("div",{className:"team-logo-preview",children:s.jsx("img",{src:p.team_logo,alt:"Team logo"})}):s.jsx("span",{style:{color:"#9ca3af"},children:"No logo"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Team Name:"}),s.jsx("span",{children:p.team_name})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Category:"}),s.jsx("span",{children:p.category})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Formation:"}),s.jsx("span",{children:p.formation})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Status:"}),K(p.status)]})]})]}),s.jsxs("div",{className:"detail-section",children:[s.jsx("h3",{children:"Captain Information"}),s.jsxs("div",{className:"detail-grid",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Name:"}),s.jsx("span",{children:p.captain_name})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Email:"}),s.jsx("span",{children:p.captain_email})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Phone:"}),s.jsx("span",{children:p.captain_phone})]})]})]}),s.jsxs("div",{className:"detail-section",children:[s.jsxs("h3",{children:["Players (",(null==(t=p.team_players)?void 0:t.length)||0,")",s.jsxs("button",{className:"btn-add-player",onClick:()=>T(!0),children:[s.jsx("i",{className:"fas fa-plus"})," Add Player"]})]}),s.jsx("div",{className:"players-list",children:null==(l=p.team_players)?void 0:l.map((a,t)=>s.jsxs("div",{className:"player-item player-item-editable",children:[a.player_image&&s.jsx("img",{src:a.player_image,alt:"",className:"player-image-small"}),s.jsxs("div",{className:"player-info-section",children:[s.jsx("strong",{children:a.player_name}),s.jsxs("small",{children:[a.position," ",a.is_substitute&&"(SUB)",a.player_age&&` • Age: ${a.player_age}`,a.aadhar_no&&` • Aadhar: ${a.aadhar_no.slice(-4)}`]})]}),s.jsxs("div",{className:"player-actions",children:[s.jsx("button",{className:"btn-icon btn-edit-small",onClick:()=>(e=>{b({...e}),w(!0)})(a),title:"Edit Player",children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{className:"btn-icon btn-delete-small",onClick:()=>(async(a,s)=>{if(confirm(`Delete player "${s}" from this team?\n\nThis action cannot be undone.`))try{const{error:s}=await e.from("team_players").delete().eq("id",a);if(s)throw s;alert("Player deleted successfully!"),B(p.id)}catch(t){alert("Failed to delete player: "+t.message)}})(a.id,a.player_name),title:"Delete Player",children:s.jsx("i",{className:"fas fa-trash"})})]})]},t))})]}),p.payment_screenshot&&s.jsxs("div",{className:"detail-section payment-section",children:[s.jsxs("h3",{children:[s.jsx("i",{className:"fas fa-receipt"})," Payment Screenshot"]}),s.jsxs("div",{className:"payment-screenshot-container",children:[s.jsx("img",{src:p.payment_screenshot,alt:"Payment Screenshot",className:"payment-screenshot-image",onClick:()=>window.open(p.payment_screenshot,"_blank")}),s.jsxs("p",{className:"payment-amount",children:["Amount: ",s.jsxs("strong",{children:["₹",p.payment_amount]})]})]}),"pending_verification"===p.status&&s.jsxs("div",{className:"payment-verify-actions",children:[s.jsxs("button",{className:"btn-verify-payment",onClick:()=>{I(p.id,"confirmed"),f(!1)},children:[s.jsx("i",{className:"fas fa-check"})," Verify & Confirm"]}),s.jsxs("button",{className:"btn-reject-payment",onClick:()=>{confirm("Reject this payment? The registration will be cancelled.")&&(I(p.id,"cancelled"),f(!1))},children:[s.jsx("i",{className:"fas fa-times"})," Reject"]})]})]}),s.jsxs("div",{className:"detail-section",children:[s.jsx("h3",{children:"Change Status"}),s.jsx("div",{className:"status-buttons",children:k.map(e=>s.jsx("button",{className:"status-btn "+(p.status===e.value?"active":""),style:{borderColor:e.color},onClick:()=>{I(p.id,e.value),f(!1)},children:e.label},e.value))})]}),"confirmed"===p.status&&s.jsxs("div",{className:"detail-section",children:[s.jsx("h3",{children:"Tournament Actions"}),s.jsxs("button",{className:"btn-primary tournament-add-btn",onClick:()=>O(p),children:[s.jsx("i",{className:"fas fa-trophy"})," Add to Tournament"]}),s.jsxs("p",{className:"help-text",children:[s.jsx("i",{className:"fas fa-info-circle"})," This will create an entry in the Teams table for fixtures, matches, and standings."]})]})]})]})}),N&&v&&s.jsx("div",{className:"modal-overlay",onClick:()=>w(!1),children:s.jsxs("div",{className:"modal-content modal-small",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Edit Player"}),s.jsx("button",{className:"modal-close",onClick:()=>w(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player Name"}),s.jsx("input",{type:"text",value:v.player_name||"",onChange:e=>V("player_name",e.target.value),placeholder:"Player Name"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Age"}),s.jsx("input",{type:"number",value:v.player_age||"",onChange:e=>V("player_age",e.target.value),placeholder:"Age",min:"10",max:"60"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Aadhar Number"}),s.jsx("input",{type:"text",value:v.aadhar_no||"",onChange:e=>{const a=e.target.value.replace(/\D/g,"");a.length<=12&&V("aadhar_no",a)},placeholder:"12-digit Aadhar number",maxLength:"12"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Position"}),s.jsx("select",{value:v.position||"SUB",onChange:e=>V("position",e.target.value),children:M.map(e=>s.jsx("option",{value:e,children:e},e))})]}),s.jsx("div",{className:"form-group",children:s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:v.is_substitute||!1,onChange:e=>V("is_substitute",e.target.checked)}),"Is Substitute"]})}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player Photo"}),v.player_image&&s.jsx("div",{className:"current-image-preview",children:s.jsx("img",{src:v.player_image,alt:"Current photo"})}),s.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{var a;const s=null==(a=e.target.files)?void 0:a[0];if(s)if(s.size>2097152)alert("Image must be under 2MB");else try{const e=await n(s,{maxWidth:600,maxHeight:600,quality:.85,outputFormat:"image/webp"});i(e),Math.round(s.size/1024);b(a=>({...a,player_image:e}))}catch(t){alert("Failed to process image. Please try another file.")}}})]})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>w(!1),disabled:C,children:"Cancel"}),s.jsx("button",{className:"btn-primary",onClick:async()=>{if(v){S(!0);try{const{error:a}=await e.from("team_players").update({player_name:v.player_name,player_age:v.player_age?parseInt(v.player_age):null,aadhar_no:v.aadhar_no||null,position:v.position,is_substitute:v.is_substitute,player_image:v.player_image}).eq("id",v.id);if(a)throw a;alert("Player updated successfully!"),w(!1),b(null),B(p.id)}catch(a){alert("Failed to update player: "+a.message)}finally{S(!1)}}},disabled:C,children:C?"Saving...":"Save Changes"})]})]})}),A&&s.jsx("div",{className:"modal-overlay",onClick:()=>T(!1),children:s.jsxs("div",{className:"modal-content modal-small",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Add New Player"}),s.jsx("button",{className:"modal-close",onClick:()=>T(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player Name *"}),s.jsx("input",{type:"text",value:q.player_name,onChange:e=>P(a=>({...a,player_name:e.target.value})),placeholder:"Player Name"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Age"}),s.jsx("input",{type:"number",value:q.player_age,onChange:e=>P(a=>({...a,player_age:e.target.value})),placeholder:"Age",min:"10",max:"60"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Aadhar Number"}),s.jsx("input",{type:"text",value:q.aadhar_no,onChange:e=>{const a=e.target.value.replace(/\D/g,"");a.length<=12&&P(e=>({...e,aadhar_no:a}))},placeholder:"12-digit Aadhar number",maxLength:"12"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Position"}),s.jsx("select",{value:q.position,onChange:e=>P(a=>({...a,position:e.target.value})),children:M.map(e=>s.jsx("option",{value:e,children:e},e))})]}),s.jsx("div",{className:"form-group",children:s.jsxs("label",{className:"checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:q.is_substitute,onChange:e=>P(a=>({...a,is_substitute:e.target.checked}))}),"Is Substitute"]})}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player Photo"}),q.player_image&&s.jsx("div",{className:"current-image-preview",children:s.jsx("img",{src:q.player_image,alt:"Player photo"})}),s.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{var a;const s=null==(a=e.target.files)?void 0:a[0];if(s)if(s.size>2097152)alert("Image must be under 2MB");else try{const e=await n(s,{maxWidth:600,maxHeight:600,quality:.85,outputFormat:"image/webp"});i(e),Math.round(s.size/1024);P(a=>({...a,player_image:e}))}catch(t){alert("Failed to process image. Please try another file.")}}})]})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{T(!1),P({player_name:"",player_age:"",aadhar_no:"",position:"SUB",is_substitute:!0,player_image:null})},disabled:C,children:"Cancel"}),s.jsx("button",{className:"btn-primary",onClick:async()=>{if(q.player_name){S(!0);try{const{error:a}=await e.from("team_players").insert({team_id:p.id,player_name:q.player_name,player_age:q.player_age?parseInt(q.player_age):null,aadhar_no:q.aadhar_no||null,position:q.position,is_substitute:q.is_substitute,player_image:q.player_image});if(a)throw a;alert("Player added successfully!"),T(!1),P({player_name:"",player_age:"",aadhar_no:"",position:"SUB",is_substitute:!0,player_image:null}),B(p.id)}catch(a){alert("Failed to add player: "+a.message)}finally{S(!1)}}else alert("Please enter player name")},disabled:C||!q.player_name,children:C?"Adding...":"Add Player"})]})]})})]})}function $(){var t;const[n,i]=a.useState([]),[l,r]=a.useState(!0),[c,o]=a.useState(""),[d,m]=a.useState("all"),[h,u]=a.useState(null),[x,p]=a.useState(!1),[g,j]=a.useState(!1);a.useEffect(()=>{f()},[]);const f=async()=>{try{r(!0);const{data:a,error:s}=await e.from("team_players").select("*, team_registrations(team_name, category, status)").order("player_name");if(s)throw s;i(a||[])}catch(a){alert("Failed to load players")}finally{r(!1)}},y=n.filter(e=>{var a,s,t;const n=(null==(a=e.player_name)?void 0:a.toLowerCase().includes(c.toLowerCase()))||(null==(t=null==(s=e.team_registrations)?void 0:s.team_name)?void 0:t.toLowerCase().includes(c.toLowerCase())),i="all"===d||e.position===d;return n&&i});return s.jsxs(F,{title:"Players Management",children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("div",{className:"page-header-left",children:s.jsxs("button",{className:"refresh-btn",onClick:f,children:[s.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})}),s.jsxs("div",{className:"page-header-right",children:[s.jsxs("select",{className:"filter-select",value:d,onChange:e=>m(e.target.value),children:[s.jsx("option",{value:"all",children:"All Positions"}),S.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsxs("div",{className:"search-box",children:[s.jsx("i",{className:"fas fa-search"}),s.jsx("input",{type:"text",placeholder:"Search players or teams...",value:c,onChange:e=>o(e.target.value)})]})]})]}),l?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading players..."})]}):s.jsxs("div",{className:"admin-table-container",children:[s.jsx("div",{className:"table-stats",children:s.jsxs("p",{children:["Total Players: ",s.jsx("strong",{children:y.length})]})}),s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Player"}),s.jsx("th",{children:"Position"}),s.jsx("th",{children:"Age"}),s.jsx("th",{children:"Team"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===y.length?s.jsx("tr",{children:s.jsxs("td",{colSpan:"7",style:{textAlign:"center",padding:"40px"},children:[s.jsx("i",{className:"fas fa-users-slash",style:{fontSize:"3rem",color:"#ccc"}}),s.jsx("p",{children:"No players found"})]})}):y.map(a=>{var t,n;return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{className:"player-cell",children:[a.player_image&&s.jsx("img",{src:a.player_image,alt:"",className:"player-image-small"}),s.jsx("strong",{children:a.player_name})]})}),s.jsx("td",{children:s.jsx("span",{className:"position-badge",children:a.position})}),s.jsx("td",{children:a.player_age||"N/A"}),s.jsx("td",{children:(null==(t=a.team_registrations)?void 0:t.team_name)||"N/A"}),s.jsx("td",{children:s.jsx("span",{className:"category-badge",children:null==(n=a.team_registrations)?void 0:n.category})}),s.jsx("td",{children:a.is_substitute?s.jsx("span",{className:"type-badge substitute",children:"Substitute"}):s.jsx("span",{className:"type-badge starter",children:"Starter"})}),s.jsx("td",{children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn-icon btn-edit",onClick:()=>{u(a),p(!0),j(!1)},title:"View/Edit",children:s.jsx("i",{className:"fas fa-edit"})}),s.jsx("button",{className:"btn-icon btn-delete",onClick:()=>(async a=>{if(confirm("Are you sure you want to delete this player?"))try{const{error:s}=await e.from("team_players").delete().eq("id",a);if(s)throw s;alert("Player deleted successfully!"),f(),p(!1)}catch(s){alert("Failed to delete player")}})(a.id),title:"Delete",children:s.jsx("i",{className:"fas fa-trash"})})]})})]},a.id)})})]})]}),x&&h&&s.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:g?"Edit Player":"Player Details"}),s.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[h.player_image&&s.jsx("div",{className:"player-image-preview",children:s.jsx("img",{src:h.player_image,alt:h.player_name})}),g?s.jsxs("div",{className:"edit-form",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player Name"}),s.jsx("input",{type:"text",value:h.player_name||"",onChange:e=>u({...h,player_name:e.target.value})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Position"}),s.jsx("select",{value:h.position||"",onChange:e=>u({...h,position:e.target.value}),children:S.map(e=>s.jsx("option",{value:e,children:e},e))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Age"}),s.jsx("input",{type:"number",value:h.player_age||"",onChange:e=>u({...h,player_age:parseInt(e.target.value)})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player Type"}),s.jsxs("select",{value:h.is_substitute?"substitute":"starter",onChange:e=>u({...h,is_substitute:"substitute"===e.target.value}),children:[s.jsx("option",{value:"starter",children:"Starter"}),s.jsx("option",{value:"substitute",children:"Substitute"})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>j(!1),children:"Cancel"}),s.jsx("button",{className:"btn-primary",onClick:()=>(async(a,s)=>{try{const{error:t}=await e.from("team_players").update(s).eq("id",a);if(t)throw t;alert("Player updated successfully!"),f(),p(!1),j(!1)}catch(t){alert("Failed to update player")}})(h.id,{player_name:h.player_name,position:h.position,player_age:h.player_age,is_substitute:h.is_substitute}),children:"Save Changes"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"detail-grid",children:[s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Player Name:"}),s.jsx("span",{children:h.player_name})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Position:"}),s.jsx("span",{className:"position-badge",children:h.position})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Age:"}),s.jsx("span",{children:h.player_age||"N/A"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Team:"}),s.jsx("span",{children:null==(t=h.team_registrations)?void 0:t.team_name})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Type:"}),h.is_substitute?s.jsx("span",{className:"type-badge substitute",children:"Substitute"}):s.jsx("span",{className:"type-badge starter",children:"Starter"})]}),s.jsxs("div",{className:"detail-item",children:[s.jsx("label",{children:"Aadhar Number:"}),s.jsx("span",{children:h.aadhar_no||"Not provided"})]})]}),s.jsx("div",{className:"modal-actions",children:s.jsxs("button",{className:"btn-primary",onClick:()=>j(!0),children:[s.jsx("i",{className:"fas fa-edit"})," Edit Player"]})})]})]})]})})]})}function D({teamId:t,teamName:n,onClose:i,onSave:o}){const[d,m]=a.useState([]),[h,u]=a.useState(!0),[x,p]=a.useState(!1),[g,j]=a.useState("1-3-2-1"),[f,y]=a.useState(null),_=a.useRef(null);a.useEffect(()=>{t&&v()},[t]);const v=async()=>{try{u(!0);const{data:a}=await e.from("teams").select("formation, registration_id").eq("id",t).single();(null==a?void 0:a.formation)&&j(a.formation);const{data:s}=await e.from("players").select("id, name, player_image, position, position_x, position_y, is_substitute, registration_player_id").eq("team_id",t).order("position");if(s&&s.length>0){const e=s.map(e=>({id:e.id,name:e.name,image:e.player_image,position:e.position,x:e.position_x??50,y:e.position_y??50,isSubstitute:e.is_substitute,registration_player_id:e.registration_player_id}));m(e)}else if(null==a?void 0:a.registration_id){const{data:s}=await e.from("team_players").select("id, player_name, player_image, position, position_x, position_y, is_substitute").eq("team_id",a.registration_id).order("position");if(s){const e=s.map(e=>({id:e.id,name:e.player_name,image:e.player_image,position:e.position,x:e.position_x??50,y:e.position_y??50,isSubstitute:e.is_substitute,registration_player_id:e.id}));m(e)}}}catch(a){alert("Failed to load team formation")}finally{u(!1)}},b=a.useCallback((e,a,s)=>{const t="number"!=typeof a||isNaN(a)?50:a,n="number"!=typeof s||isNaN(s)?50:s,i=d.find(a=>a.id===e);"GK"!==(null==i?void 0:i.position)&&m(a=>a.map(a=>a.id===e?{...a,x:t,y:n}:a))},[d]),N=a.useCallback((e,a)=>{const s=d.find(e=>e.id===a);"GK"!==(null==s?void 0:s.position)&&y(a)},[d]),w=a.useCallback(e=>{const a=_.current;if(!f||!a)return;e.preventDefault();const s=a.querySelector("svg");if(!s)return;const t=s.getBoundingClientRect(),n=e.touches?e.touches[0].clientX:e.clientX,i=e.touches?e.touches[0].clientY:e.clientY,l=(n-t.left)/t.width*100,r=(i-t.top)/t.height*100,c=Math.min(Math.max(l,0),100),o=Math.min(Math.max(r,0),100);b(f,c,o)},[f,b]),C=a.useCallback(()=>{y(null)},[]);return h?s.jsx("div",{className:"modal-overlay",onClick:i,children:s.jsx("div",{className:"modal-content large",onClick:e=>e.stopPropagation(),children:s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading formation..."})]})})}):s.jsx("div",{className:"modal-overlay",onClick:i,children:s.jsxs("div",{className:"modal-content large",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[s.jsx("i",{className:"fas fa-chess-board"}),"Edit Formation - ",n]}),s.jsx("button",{className:"modal-close",onClick:i,children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"formation-instruction-box",style:{marginBottom:"20px"},children:[s.jsx("div",{className:"instruction-icon",children:s.jsx("i",{className:"fas fa-hand-pointer"})}),s.jsxs("div",{className:"instruction-content",children:[s.jsx("strong",{className:"instruction-title",children:"Interactive Field"}),s.jsx("p",{className:"instruction-text",children:"Click and drag any player to reposition them (GK is locked)"})]})]}),s.jsxs("div",{className:"formation-presets-section",children:[s.jsxs("div",{className:"presets-header",children:[s.jsx("i",{className:"fas fa-chess-board"}),s.jsx("span",{className:"presets-title",children:"Choose Formation"})]}),s.jsx("div",{className:"formation-buttons-grid",children:l.map(e=>s.jsx("button",{type:"button",className:"formation-preset-btn "+(g===e?"active":""),onClick:()=>{return a=e,m(e=>c(e,a)),void j(a);var a},children:s.jsx("span",{className:"formation-name",children:e})},e))})]}),s.jsx("div",{ref:_,className:"formation-field-container",children:s.jsx(r,{players:d.filter(e=>!e.isSubstitute),editable:!0,onDragStart:N,onDrag:w,onDragEnd:C})})]}),s.jsxs("div",{className:"modal-footer",children:[s.jsx("button",{className:"btn-secondary",onClick:i,disabled:x,children:"Cancel"}),s.jsx("button",{className:"btn-primary",onClick:async()=>{try{p(!0),await e.from("teams").update({formation:g}).eq("id",t);const a=d.filter(e=>!e.isSubstitute);for(const s of a)s.registration_player_id&&s.registration_player_id!==s.id?(await e.from("players").update({position_x:s.x,position_y:s.y}).eq("id",s.id),await e.from("team_players").update({position_x:s.x,position_y:s.y}).eq("id",s.registration_player_id)):await e.from("team_players").update({position_x:s.x,position_y:s.y}).eq("id",s.id);alert("Formation saved successfully!"),o&&o(),i()}catch(a){alert("Failed to save formation: "+a.message)}finally{p(!1)}},disabled:x,children:x?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-spinner fa-spin"})," Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-save"})," Save Formation"]})})]})]})})}function R(){const[t,n]=a.useState([]),[i,l]=a.useState(!0),[r,c]=a.useState(""),[o,d]=a.useState("all"),[m,h]=a.useState(!1),[u,x]=a.useState(null);a.useEffect(()=>{p()},[o]);const p=async()=>{try{l(!0);let a=e.from("teams").select("*").order("name");"all"!==o&&(a=a.eq("category",o));const{data:s,error:t}=await a;if(t)throw t;n(s||[])}catch(a){alert("Failed to load teams")}finally{l(!1)}},g=t.filter(e=>{var a,s;return(null==(a=e.name)?void 0:a.toLowerCase().includes(r.toLowerCase()))||(null==(s=e.captain)?void 0:s.toLowerCase().includes(r.toLowerCase()))});return s.jsxs(F,{title:"Teams Management",children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("div",{className:"page-header-left",children:s.jsxs("button",{className:"refresh-btn",onClick:p,children:[s.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})}),s.jsxs("div",{className:"page-header-right",children:[s.jsxs("select",{className:"filter-select",value:o,onChange:e=>d(e.target.value),children:[s.jsx("option",{value:"all",children:"All Categories"}),s.jsx("option",{value:"open-age",children:"Open Age"}),s.jsx("option",{value:"u17",children:"Under 17"})]}),s.jsxs("div",{className:"search-box",children:[s.jsx("i",{className:"fas fa-search"}),s.jsx("input",{type:"text",placeholder:"Search teams...",value:r,onChange:e=>c(e.target.value)})]})]})]}),i?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading teams..."})]}):s.jsxs("div",{className:"admin-table-container",children:[s.jsx("div",{className:"table-stats",children:s.jsxs("p",{children:["Total Teams: ",s.jsx("strong",{children:g.length})]})}),s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Team"}),s.jsx("th",{children:"Captain"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Formation"}),s.jsx("th",{children:"Played"}),s.jsx("th",{children:"W-D-L"}),s.jsx("th",{children:"GD"}),s.jsx("th",{children:"Points"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===g.length?s.jsx("tr",{children:s.jsxs("td",{colSpan:"9",style:{textAlign:"center",padding:"40px"},children:[s.jsx("i",{className:"fas fa-shield-alt",style:{fontSize:"3rem",color:"#ccc"}}),s.jsx("p",{children:"No teams found"})]})}):g.map(a=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{className:"team-cell",children:[a.crest_url&&s.jsx("img",{src:a.crest_url,alt:"",className:"team-logo-small"}),s.jsx("strong",{children:a.name})]})}),s.jsx("td",{children:a.captain||"N/A"}),s.jsx("td",{children:s.jsx("span",{className:"category-badge",children:a.category})}),s.jsx("td",{children:a.formation||"N/A"}),s.jsx("td",{children:a.played||0}),s.jsxs("td",{children:[a.won||0,"-",a.drawn||0,"-",a.lost||0]}),s.jsx("td",{children:(a.goals_for||0)-(a.goals_against||0)}),s.jsx("td",{children:s.jsx("strong",{children:a.points||0})}),s.jsx("td",{children:s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn-icon btn-edit",onClick:()=>{x(a),h(!0)},title:"Edit Formation",children:s.jsx("i",{className:"fas fa-chess-board"})}),s.jsx("a",{href:`/muqawamah/2026/${a.category}/teams/?team=${a.id}`,className:"btn-icon btn-view",title:"View Team Page",target:"_blank",children:s.jsx("i",{className:"fas fa-external-link-alt"})}),s.jsx("button",{className:"btn-icon btn-delete",onClick:()=>(async a=>{const s=t.find(e=>e.id===a);if(!s)return;const n=`⚠️ WARNING: This will permanently delete "${s.name}" and ALL related data:\n\n✓ All players from this team\n✓ All goals scored by this team\n✓ All matches involving this team\n✓ Team registration data\n\nThis action CANNOT be undone!\n\nType the team name to confirm: "${s.name}"`,i=prompt(n);if(i===s.name)try{if(s.registration_id){const{error:s}=await e.from("players").delete().eq("team_id",a);if(s)throw new Error(`Failed to delete tournament players: ${s.message}`)}const{error:t}=await e.from("goals").delete().eq("team_id",a);if(t)throw new Error(`Failed to delete goals: ${t.message}`);const{error:n}=await e.from("matches").delete().or(`home_team_id.eq.${a},away_team_id.eq.${a}`);if(n)throw new Error(`Failed to delete matches: ${n.message}`);const{error:i}=await e.from("teams").delete().eq("id",a);if(i)throw new Error(`Failed to delete team: ${i.message}`);if(s.registration_id){const{error:a}=await e.from("team_players").delete().eq("team_id",s.registration_id);if(a)throw new Error(`Failed to delete registration players: ${a.message}`);const{error:t}=await e.from("team_registrations").delete().eq("id",s.registration_id);if(t)throw new Error(`Failed to delete registration: ${t.message}`)}alert(`✅ Successfully deleted "${s.name}" and all related data!`),p()}catch(l){alert(`❌ Failed to delete team: ${l.message}`)}else null!==i&&alert("Team name did not match. Deletion cancelled.")})(a.id),title:"Delete",children:s.jsx("i",{className:"fas fa-trash"})})]})})]},a.id))})]})]}),m&&u&&s.jsx(D,{teamId:u.id,teamName:u.name,onClose:()=>{h(!1),x(null)},onSave:()=>{p()}})]})}function G(){const[t,n]=a.useState([]),[i,l]=a.useState([]),[r,c]=a.useState(!0),[o,d]=a.useState(!1),[m,h]=a.useState({home_team_id:"",away_team_id:"",match_date:"",scheduled_time:"",venue:"",match_number:1,category:"open-age",match_type:"group"});a.useEffect(()=>{u()},[]);const u=async()=>{try{c(!0);const{data:a,error:s}=await e.from("matches").select("\n          *,\n          home_team:teams!matches_home_team_id_fkey(id, name, crest_url),\n          away_team:teams!matches_away_team_id_fkey(id, name, crest_url)\n        ").order("match_date",{ascending:!0});if(s)throw s;const{data:t,error:i}=await e.from("teams").select("id, name, category").order("name");if(i)throw i;n(a||[]),l(t||[])}catch(a){alert("Failed to load fixtures")}finally{c(!1)}},x=i.filter(e=>e.category===m.category);return s.jsxs(F,{title:"Fixtures Management",children:[s.jsx("div",{className:"admin-page-header",children:s.jsxs("div",{className:"page-header-left",children:[s.jsxs("button",{className:"refresh-btn",onClick:u,children:[s.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]}),s.jsxs("button",{className:"create-btn",onClick:()=>d(!0),children:[s.jsx("i",{className:"fas fa-plus"})," Create Fixture"]})]})}),r?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading fixtures..."})]}):s.jsxs("div",{className:"admin-table-container",children:[s.jsx("div",{className:"table-stats",children:s.jsxs("p",{children:["Total Fixtures: ",s.jsx("strong",{children:t.length})]})}),s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"MW"}),s.jsx("th",{children:"Date & Time"}),s.jsx("th",{children:"Home Team"}),s.jsx("th",{children:"Away Team"}),s.jsx("th",{children:"Venue"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Score"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===t.length?s.jsx("tr",{children:s.jsxs("td",{colSpan:"8",style:{textAlign:"center",padding:"40px"},children:[s.jsx("i",{className:"fas fa-calendar-alt",style:{fontSize:"3rem",color:"#ccc"}}),s.jsx("p",{children:"No fixtures found"})]})}):t.map(a=>{var t,n,i,l;return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("strong",{children:a.match_number})}),s.jsxs("td",{children:[s.jsx("div",{children:new Date(a.match_date).toLocaleDateString()}),s.jsx("small",{children:a.scheduled_time||"TBD"})]}),s.jsx("td",{children:s.jsxs("div",{className:"team-cell",children:[(null==(t=a.home_team)?void 0:t.crest_url)&&s.jsx("img",{src:a.home_team.crest_url,alt:"",className:"team-logo-small"}),s.jsx("span",{children:(null==(n=a.home_team)?void 0:n.name)||"TBD"})]})}),s.jsx("td",{children:s.jsxs("div",{className:"team-cell",children:[(null==(i=a.away_team)?void 0:i.crest_url)&&s.jsx("img",{src:a.away_team.crest_url,alt:"",className:"team-logo-small"}),s.jsx("span",{children:(null==(l=a.away_team)?void 0:l.name)||"TBD"})]})}),s.jsx("td",{children:a.venue||"TBD"}),s.jsx("td",{children:s.jsx("span",{className:`status-badge status-${a.status}`,children:a.status})}),s.jsx("td",{children:"completed"===a.status?s.jsxs("strong",{children:[a.home_score," - ",a.away_score]}):s.jsx("span",{children:"-"})}),s.jsx("td",{children:s.jsx("div",{className:"action-buttons",children:s.jsx("button",{className:"btn-icon btn-delete",onClick:()=>(async a=>{if(confirm("Are you sure you want to delete this fixture?"))try{const{error:s}=await e.from("matches").delete().eq("id",a);if(s)throw s;alert("Fixture deleted successfully!"),u()}catch(s){alert("Failed to delete fixture")}})(a.id),title:"Delete",children:s.jsx("i",{className:"fas fa-trash"})})})})]},a.id)})})]})]}),o&&s.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:s.jsxs("div",{className:"modal-content large",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Create New Fixture"}),s.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Category"}),s.jsxs("select",{value:m.category,onChange:e=>h({...m,category:e.target.value}),children:[s.jsx("option",{value:"open-age",children:"Open Age"}),s.jsx("option",{value:"u17",children:"Under 17"})]})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Home Team"}),s.jsxs("select",{value:m.home_team_id,onChange:e=>h({...m,home_team_id:e.target.value}),children:[s.jsx("option",{value:"",children:"Select Home Team"}),x.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Away Team"}),s.jsxs("select",{value:m.away_team_id,onChange:e=>h({...m,away_team_id:e.target.value}),children:[s.jsx("option",{value:"",children:"Select Away Team"}),x.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Match Date"}),s.jsx("input",{type:"date",value:m.match_date,onChange:e=>h({...m,match_date:e.target.value})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Match Time"}),s.jsx("input",{type:"time",value:m.scheduled_time,onChange:e=>h({...m,scheduled_time:e.target.value})})]})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Venue"}),s.jsx("input",{type:"text",value:m.venue,onChange:e=>h({...m,venue:e.target.value}),placeholder:"e.g., Sio Stadium"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Match Number"}),s.jsx("input",{type:"number",min:"1",value:m.match_number,onChange:e=>h({...m,match_number:parseInt(e.target.value)}),placeholder:"e.g., 1, 2, 3..."})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Match Type"}),s.jsxs("select",{value:m.match_type,onChange:e=>h({...m,match_type:e.target.value}),children:[s.jsx("option",{value:"group",children:"Group Stage"}),s.jsx("option",{value:"quarter-final",children:"Quarter Final"}),s.jsx("option",{value:"semi-final",children:"Semi Final"}),s.jsx("option",{value:"final",children:"Final"})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>d(!1),children:"Cancel"}),s.jsxs("button",{className:"btn-primary",onClick:async()=>{if(m.home_team_id&&m.away_team_id)if(m.home_team_id!==m.away_team_id)try{const{error:a}=await e.from("matches").insert({home_team_id:m.home_team_id,away_team_id:m.away_team_id,match_date:m.match_date,scheduled_time:m.scheduled_time,venue:m.venue,match_number:m.match_number,category:m.category,match_type:m.match_type,status:"scheduled"});if(a)throw a;alert("Fixture created successfully!"),d(!1),h({home_team_id:"",away_team_id:"",match_date:"",scheduled_time:"",venue:"",match_number:1,category:"open-age",match_type:"group"}),u()}catch(a){alert("Failed to create fixture")}else alert("Home and away teams must be different");else alert("Please select both teams")},children:[s.jsx("i",{className:"fas fa-plus"})," Create Fixture"]})]})]})]})})]})}function E(){var t,n,i,l,r,c,o,d;const[m,h]=a.useState([]),[u,x]=a.useState(!0),[p,g]=a.useState(null),[j,f]=a.useState(!1),[y,_]=a.useState({home_score:0,away_score:0,status:"completed"}),[v,b]=a.useState([]),[N,w]=a.useState([]),[C,k]=a.useState([]),[S,A]=a.useState([]),[T,q]=a.useState({scorer_id:"",assister_id:"",minute:"",goal_type:"open_play",team_id:""}),[P,M]=a.useState({player_id:"",card_type:"yellow",minute:"",team_id:""});a.useEffect(()=>{L()},[]);const L=async()=>{try{x(!0);const{data:a,error:s}=await e.from("matches").select("\n          *,\n          home_team:teams!matches_home_team_id_fkey(id, name, crest_url),\n          away_team:teams!matches_away_team_id_fkey(id, name, crest_url)\n        ").order("match_date",{ascending:!1});if(s)throw s;h(a||[])}catch(a){alert("Failed to load matches")}finally{x(!1)}},$=async a=>{try{const{data:s}=await e.from("teams").select("registration_id").eq("id",a.home_team_id).single(),{data:t}=await e.from("teams").select("registration_id").eq("id",a.away_team_id).single();if(null==s?void 0:s.registration_id){const{data:a}=await e.from("team_players").select("id, player_name, position").eq("team_id",s.registration_id).order("player_name");k(a||[])}if(null==t?void 0:t.registration_id){const{data:a}=await e.from("team_players").select("id, player_name, position").eq("team_id",t.registration_id).order("player_name");A(a||[])}}catch(s){}},D=async a=>{try{const{data:s,error:t}=await e.from("goals").select("\n          id,\n          match_id,\n          team_id,\n          scorer_id,\n          assister_id,\n          minute,\n          goal_type,\n          created_at,\n          scorer:team_players!goals_scorer_id_fkey(player_name),\n          assister:team_players!goals_assister_id_fkey(player_name)\n        ").eq("match_id",a).order("minute");if(t)throw t;b(s||[])}catch(s){}},R=async a=>{try{const{data:s,error:t}=await e.from("cards").select("\n          id,\n          match_id,\n          team_id,\n          player_id,\n          card_type,\n          minute,\n          created_at,\n          player:team_players!cards_player_id_fkey(player_name)\n        ").eq("match_id",a).order("minute");if(t)throw t;w(s||[])}catch(s){}};return s.jsxs(F,{title:"Match Results",children:[s.jsx("div",{className:"admin-page-header",children:s.jsx("div",{className:"page-header-left",children:s.jsxs("button",{className:"refresh-btn",onClick:L,children:[s.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})})}),u?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading matches..."})]}):s.jsx("div",{className:"admin-table-container",children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Home Team"}),s.jsx("th",{children:"Score"}),s.jsx("th",{children:"Away Team"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===m.length?s.jsx("tr",{children:s.jsxs("td",{colSpan:"6",style:{textAlign:"center",padding:"40px"},children:[s.jsx("i",{className:"fas fa-futbol",style:{fontSize:"3rem",color:"#ccc"}}),s.jsx("p",{children:"No matches found"})]})}):m.map(e=>{var a,t,n,i;return s.jsxs("tr",{children:[s.jsx("td",{children:new Date(e.match_date).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"team-cell",children:[(null==(a=e.home_team)?void 0:a.crest_url)&&s.jsx("img",{src:e.home_team.crest_url,alt:"",className:"team-logo-small"}),s.jsx("span",{children:null==(t=e.home_team)?void 0:t.name})]})}),s.jsx("td",{children:"completed"===e.status?s.jsxs("strong",{className:"score-display",children:[e.home_score," - ",e.away_score]}):s.jsx("span",{className:"vs-text",children:"vs"})}),s.jsx("td",{children:s.jsxs("div",{className:"team-cell",children:[(null==(n=e.away_team)?void 0:n.crest_url)&&s.jsx("img",{src:e.away_team.crest_url,alt:"",className:"team-logo-small"}),s.jsx("span",{children:null==(i=e.away_team)?void 0:i.name})]})}),s.jsx("td",{children:s.jsx("span",{className:`status-badge status-${e.status}`,children:e.status})}),s.jsx("td",{children:s.jsx("button",{className:"btn-icon btn-edit",onClick:()=>(async e=>{g(e),_({home_score:e.home_score||0,away_score:e.away_score||0,status:"scheduled"===e.status?"completed":e.status}),await $(e),await D(e.id),await R(e.id),f(!0)})(e),title:"Record/Edit Result",children:s.jsx("i",{className:"fas fa-edit"})})})]},e.id)})})]})}),j&&p&&s.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Record Match Result"}),s.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"match-info",children:[s.jsxs("div",{className:"team-score-input",children:[s.jsxs("div",{className:"team-name",children:[(null==(t=p.home_team)?void 0:t.crest_url)&&s.jsx("img",{src:p.home_team.crest_url,alt:""}),s.jsx("h3",{children:null==(n=p.home_team)?void 0:n.name})]}),s.jsx("input",{type:"number",min:"0",value:y.home_score,onChange:e=>_({...y,home_score:parseInt(e.target.value)||0}),className:"score-input"})]}),s.jsx("div",{className:"score-separator",children:"-"}),s.jsxs("div",{className:"team-score-input",children:[s.jsxs("div",{className:"team-name",children:[(null==(i=p.away_team)?void 0:i.crest_url)&&s.jsx("img",{src:p.away_team.crest_url,alt:""}),s.jsx("h3",{children:null==(l=p.away_team)?void 0:l.name})]}),s.jsx("input",{type:"number",min:"0",value:y.away_score,onChange:e=>_({...y,away_score:parseInt(e.target.value)||0}),className:"score-input"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Match Status"}),s.jsxs("select",{value:y.status,onChange:e=>_({...y,status:e.target.value}),children:[s.jsx("option",{value:"scheduled",children:"Scheduled"}),s.jsx("option",{value:"live",children:"Live"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"postponed",children:"Postponed"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{className:"goals-section",children:[s.jsxs("h3",{children:["⚽ Goals (",v.length,")"]}),v.length>0&&s.jsx("div",{className:"goals-list",children:v.map(a=>{var t,n;return s.jsxs("div",{className:"goal-item",children:[s.jsxs("div",{className:"goal-info",children:[s.jsxs("span",{className:"goal-minute",children:[a.minute,"'"]}),s.jsx("span",{className:"goal-scorer",children:(null==(t=a.scorer)?void 0:t.player_name)||"Unknown"}),(null==(n=a.assister)?void 0:n.player_name)&&s.jsxs("span",{className:"goal-assist",children:["(Assist: ",a.assister.player_name,")"]})]}),s.jsx("button",{className:"goal-delete-btn",onClick:()=>(async(a,s)=>{if(confirm("Delete this goal? The score will be updated automatically."))try{const{error:t}=await e.from("goals").delete().eq("id",a);if(t)throw t;const n={...y};s===p.home_team_id?n.home_score=Math.max((y.home_score||0)-1,0):s===p.away_team_id&&(n.away_score=Math.max((y.away_score||0)-1,0)),_(n),await D(p.id),alert("Goal deleted! Score updated automatically.")}catch(t){alert("Failed to delete goal")}})(a.id,a.team_id),children:s.jsx("i",{className:"fas fa-times"})})]},a.id)})}),s.jsxs("div",{className:"add-goal-form",children:[s.jsx("h4",{children:"Add Goal"}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Scoring Team"}),s.jsxs("select",{value:T.team_id,onChange:e=>{q({...T,team_id:e.target.value,scorer_id:"",assister_id:""})},children:[s.jsx("option",{value:"",children:"Select Team"}),s.jsx("option",{value:p.home_team_id,children:null==(r=p.home_team)?void 0:r.name}),s.jsx("option",{value:p.away_team_id,children:null==(c=p.away_team)?void 0:c.name})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Goal Scorer"}),s.jsxs("select",{value:T.scorer_id,onChange:e=>q({...T,scorer_id:e.target.value}),disabled:!T.team_id,children:[s.jsx("option",{value:"",children:"Select Scorer"}),T.team_id===p.home_team_id&&C.map(e=>s.jsxs("option",{value:e.id,children:[e.player_name," (",e.position,")"]},e.id)),T.team_id===p.away_team_id&&S.map(e=>s.jsxs("option",{value:e.id,children:[e.player_name," (",e.position,")"]},e.id))]})]})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Assister (Optional)"}),s.jsxs("select",{value:T.assister_id,onChange:e=>q({...T,assister_id:e.target.value}),disabled:!T.team_id,children:[s.jsx("option",{value:"",children:"No Assist"}),T.team_id===p.home_team_id&&C.filter(e=>e.id!==T.scorer_id).map(e=>s.jsxs("option",{value:e.id,children:[e.player_name," (",e.position,")"]},e.id)),T.team_id===p.away_team_id&&S.filter(e=>e.id!==T.scorer_id).map(e=>s.jsxs("option",{value:e.id,children:[e.player_name," (",e.position,")"]},e.id))]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Minute"}),s.jsx("input",{type:"number",min:"1",max:"120",value:T.minute,onChange:e=>q({...T,minute:e.target.value}),placeholder:"e.g., 23"})]})]}),s.jsxs("button",{className:"btn-add-goal",onClick:async()=>{if(T.scorer_id&&T.team_id)try{const{error:a}=await e.from("goals").insert({match_id:p.id,team_id:T.team_id,scorer_id:T.scorer_id,assister_id:T.assister_id||null,minute:parseInt(T.minute)||null,goal_type:T.goal_type});if(a)throw a;const s={...y};T.team_id===p.home_team_id?s.home_score=(y.home_score||0)+1:T.team_id===p.away_team_id&&(s.away_score=(y.away_score||0)+1),_(s),q({scorer_id:"",assister_id:"",minute:"",goal_type:"open_play",team_id:""}),await D(p.id),alert("Goal added! Score updated automatically.")}catch(a){alert("Failed to add goal: "+a.message)}else alert("Please select scorer and team")},disabled:!T.scorer_id,children:[s.jsx("i",{className:"fas fa-plus"})," Add Goal"]})]})]}),s.jsxs("div",{className:"cards-section",style:{marginTop:"30px"},children:[s.jsxs("h3",{children:["🟨🟥 Cards (",N.length,")"]}),N.length>0&&s.jsx("div",{className:"goals-list",children:N.map(a=>{var t;return s.jsxs("div",{className:"goal-item",children:[s.jsxs("div",{className:"goal-info",children:[s.jsxs("span",{className:"goal-minute",children:[a.minute,"'"]}),s.jsx("span",{className:`card-type-badge ${a.card_type}`,style:{marginRight:"8px"},children:"yellow"===a.card_type?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-square",style:{color:"#ffd700"}})," Yellow"]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-square",style:{color:"#ff0000"}})," Red"]})}),s.jsx("span",{className:"goal-scorer",children:(null==(t=a.player)?void 0:t.player_name)||"Unknown"})]}),s.jsx("button",{className:"goal-delete-btn",onClick:()=>(async a=>{if(confirm("Delete this card?"))try{const{error:s}=await e.from("cards").delete().eq("id",a);if(s)throw s;await R(p.id),alert("Card deleted successfully!")}catch(s){alert("Failed to delete card")}})(a.id),children:s.jsx("i",{className:"fas fa-times"})})]},a.id)})}),s.jsxs("div",{className:"add-goal-form",children:[s.jsx("h4",{children:"Add Card"}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Team"}),s.jsxs("select",{value:P.team_id,onChange:e=>{M({...P,team_id:e.target.value,player_id:""})},children:[s.jsx("option",{value:"",children:"Select Team"}),s.jsx("option",{value:p.home_team_id,children:null==(o=p.home_team)?void 0:o.name}),s.jsx("option",{value:p.away_team_id,children:null==(d=p.away_team)?void 0:d.name})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player"}),s.jsxs("select",{value:P.player_id,onChange:e=>M({...P,player_id:e.target.value}),disabled:!P.team_id,children:[s.jsx("option",{value:"",children:"Select Player"}),P.team_id===p.home_team_id&&C.map(e=>s.jsxs("option",{value:e.id,children:[e.player_name," (",e.position,")"]},e.id)),P.team_id===p.away_team_id&&S.map(e=>s.jsxs("option",{value:e.id,children:[e.player_name," (",e.position,")"]},e.id))]})]})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Card Type"}),s.jsxs("select",{value:P.card_type,onChange:e=>M({...P,card_type:e.target.value}),children:[s.jsx("option",{value:"yellow",children:"Yellow Card"}),s.jsx("option",{value:"red",children:"Red Card"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Minute"}),s.jsx("input",{type:"number",min:"1",max:"120",value:P.minute,onChange:e=>M({...P,minute:e.target.value}),placeholder:"e.g., 45"})]})]}),s.jsxs("button",{className:"btn-add-goal",onClick:async()=>{if(P.player_id&&P.team_id)try{const{error:a}=await e.from("cards").insert({match_id:p.id,team_id:P.team_id,player_id:P.player_id,card_type:P.card_type,minute:parseInt(P.minute)||null});if(a)throw a;M({player_id:"",card_type:"yellow",minute:"",team_id:""}),await R(p.id),alert("Card added successfully!")}catch(a){alert("Failed to add card: "+a.message)}else alert("Please select player and team")},disabled:!P.player_id,children:[s.jsx("i",{className:"fas fa-id-card"})," Add Card"]})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>f(!1),children:"Cancel"}),s.jsxs("button",{className:"btn-primary",onClick:async()=>{if(p)try{p.status;const a=p.home_score||0,s=p.away_score||0,t=y.home_score!==a||y.away_score!==s,n=y.status!==p.status;if(!t&&!n)return alert("No changes detected"),void f(!1);const{error:i}=await e.from("matches").update({home_score:y.home_score,away_score:y.away_score,status:y.status}).eq("id",p.id);if(i)throw i;alert("Match result recorded successfully!"),f(!1),L()}catch(a){alert("Failed to record match result: "+a.message)}},children:[s.jsx("i",{className:"fas fa-save"})," Save Result"]})]})]})]})})]})}function U(){const[t,n]=a.useState([]),[i,l]=a.useState([]),[r,c]=a.useState([]),[o,d]=a.useState([]),[m,h]=a.useState(!0),[u,x]=a.useState(!1),[p,g]=a.useState(!1),[j,f]=a.useState(""),[y,_]=a.useState({match_id:"",scorer_id:"",assister_id:"",minute:"",goal_type:"open_play"}),[v,b]=a.useState({match_id:"",player_id:"",card_type:"yellow",minute:""});a.useEffect(()=>{N()},[]);const N=async()=>{try{h(!0);const{data:a,error:s}=await e.from("goals").select("\n          id,\n          match_id,\n          team_id,\n          scorer_id,\n          assister_id,\n          minute,\n          goal_type,\n          created_at,\n          match:matches(id, home_team:teams!matches_home_team_id_fkey(name), away_team:teams!matches_away_team_id_fkey(name)),\n          scorer:team_players!goals_scorer_id_fkey(player_name, team_id),\n          assister:team_players!goals_assister_id_fkey(player_name)\n        ").order("created_at",{ascending:!1}),{data:t,error:i}=await e.from("cards").select("\n          id,\n          match_id,\n          team_id,\n          player_id,\n          card_type,\n          minute,\n          created_at,\n          match:matches(id, home_team:teams!matches_home_team_id_fkey(name), away_team:teams!matches_away_team_id_fkey(name)),\n          player:team_players!cards_player_id_fkey(player_name, team_id)\n        ").order("created_at",{ascending:!1});if(s)throw s;if(i)throw i;const{data:r,error:o}=await e.from("matches").select("\n          *,\n          home_team:teams!matches_home_team_id_fkey(name),\n          away_team:teams!matches_away_team_id_fkey(name)\n        ").order("match_date",{ascending:!1}).limit(20);if(o)throw o;const{data:m,error:u}=await e.from("team_players").select("id, player_name, team_id, team_registrations(team_name)").order("player_name");if(u)throw u;n(a||[]),l(t||[]),c(r||[]),d(m||[])}catch(a){alert("Failed to load data")}finally{h(!1)}},w=j?t.filter(e=>e.match_id===j):t;return s.jsxs(F,{title:"Goals & Cards Management",children:[s.jsx("div",{className:"admin-page-header",children:s.jsxs("div",{className:"page-header-left",children:[s.jsxs("button",{className:"refresh-btn",onClick:N,children:[s.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]}),s.jsxs("button",{className:"btn-primary",onClick:()=>x(!0),children:[s.jsx("i",{className:"fas fa-plus"})," Add Goal"]}),s.jsxs("button",{className:"btn-primary",onClick:()=>g(!0),style:{marginLeft:"10px"},children:[s.jsx("i",{className:"fas fa-id-card"})," Add Card"]})]})}),!m&&s.jsxs("div",{className:"filter-section",children:[s.jsxs("div",{className:"filter-group",children:[s.jsxs("label",{children:[s.jsx("i",{className:"fas fa-filter"})," Filter by Match:"]}),s.jsxs("select",{value:j,onChange:e=>f(e.target.value),className:"filter-select",children:[s.jsxs("option",{value:"",children:["All Matches (",t.length," goals)"]}),r.map(e=>{var a,n;const i=t.filter(a=>a.match_id===e.id).length;return s.jsxs("option",{value:e.id,children:[null==(a=e.home_team)?void 0:a.name," vs ",null==(n=e.away_team)?void 0:n.name," (",i," goals)"]},e.id)})]})]}),j&&s.jsxs("button",{className:"btn-danger-outline",onClick:()=>(async a=>{var s,t;const n=r.find(e=>e.id===a);if(!n)return;const i=`${null==(s=n.home_team)?void 0:s.name} vs ${null==(t=n.away_team)?void 0:t.name}`,l=w.length;if(confirm(`Delete all ${l} goal(s) from this match?\n\n${i}\n\nThis cannot be undone!`))try{const{error:s}=await e.from("goals").delete().eq("match_id",a);if(s)throw s;alert(`Successfully deleted ${l} goal(s)!`),f(""),N()}catch(c){alert("Failed to clear match goals")}})(j),title:"Delete all goals from this match",children:[s.jsx("i",{className:"fas fa-trash-alt"})," Clear Match Goals"]})]}),m?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading goals..."})]}):s.jsxs("div",{className:"admin-table-container",children:[s.jsx("div",{className:"table-stats",children:s.jsx("p",{children:j?s.jsxs(s.Fragment,{children:["Showing: ",s.jsx("strong",{children:w.length})," goals (filtered)"]}):s.jsxs(s.Fragment,{children:["Total Goals: ",s.jsx("strong",{children:t.length})]})})}),s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Match"}),s.jsx("th",{children:"Scorer"}),s.jsx("th",{children:"Assister"}),s.jsx("th",{children:"Minute"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===w.length?s.jsx("tr",{children:s.jsxs("td",{colSpan:"6",style:{textAlign:"center",padding:"40px"},children:[s.jsx("i",{className:"fas fa-trophy",style:{fontSize:"3rem",color:"#ccc"}}),s.jsx("p",{children:j?"No goals recorded for this match":"No goals recorded"})]})}):w.map(a=>{var t,n,i,l,r,c;return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{children:[null==(n=null==(t=a.match)?void 0:t.home_team)?void 0:n.name," vs ",null==(l=null==(i=a.match)?void 0:i.away_team)?void 0:l.name]})}),s.jsx("td",{children:s.jsx("strong",{children:(null==(r=a.scorer)?void 0:r.player_name)||"Unknown"})}),s.jsx("td",{children:(null==(c=a.assister)?void 0:c.player_name)||"-"}),s.jsx("td",{children:a.minute?`${a.minute}'`:"-"}),s.jsx("td",{children:s.jsx("span",{className:"goal-type-badge",children:a.goal_type.replace("_"," ")})}),s.jsx("td",{children:s.jsx("button",{className:"btn-icon btn-delete",onClick:()=>(async a=>{if(confirm("Are you sure you want to delete this goal?"))try{const{error:s}=await e.from("goals").delete().eq("id",a);if(s)throw s;alert("Goal deleted successfully!"),N()}catch(s){alert("Failed to delete goal")}})(a.id),title:"Delete",children:s.jsx("i",{className:"fas fa-trash"})})})]},a.id)})})]}),s.jsxs("div",{className:"table-stats",style:{marginTop:"40px"},children:[s.jsx("h3",{style:{marginBottom:"16px"},children:"Cards"}),s.jsxs("p",{children:["Total Cards: ",s.jsx("strong",{children:i.length})]})]}),s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Match"}),s.jsx("th",{children:"Player"}),s.jsx("th",{children:"Card Type"}),s.jsx("th",{children:"Minute"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===i.length?s.jsx("tr",{children:s.jsxs("td",{colSpan:"5",style:{textAlign:"center",padding:"40px"},children:[s.jsx("i",{className:"fas fa-id-card",style:{fontSize:"3rem",color:"#ccc"}}),s.jsx("p",{children:"No cards recorded"})]})}):i.map(a=>{var t,n,i,l,r;return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{children:[null==(n=null==(t=a.match)?void 0:t.home_team)?void 0:n.name," vs ",null==(l=null==(i=a.match)?void 0:i.away_team)?void 0:l.name]})}),s.jsx("td",{children:s.jsx("strong",{children:(null==(r=a.player)?void 0:r.player_name)||"Unknown"})}),s.jsx("td",{children:s.jsx("span",{className:`card-type-badge ${a.card_type}`,children:"yellow"===a.card_type?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-square",style:{color:"#ffd700"}})," Yellow"]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-square",style:{color:"#ff0000"}})," Red"]})})}),s.jsx("td",{children:a.minute?`${a.minute}'`:"-"}),s.jsx("td",{children:s.jsx("button",{className:"btn-icon btn-delete",onClick:()=>(async a=>{if(confirm("Are you sure you want to delete this card?"))try{const{error:s}=await e.from("cards").delete().eq("id",a);if(s)throw s;alert("Card deleted successfully!"),N()}catch(s){alert("Failed to delete card: "+s.message)}})(a.id),title:"Delete",children:s.jsx("i",{className:"fas fa-trash"})})})]},a.id)})})]})]}),u&&s.jsx("div",{className:"modal-overlay",onClick:()=>x(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Add Goal"}),s.jsx("button",{className:"modal-close",onClick:()=>x(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Match"}),s.jsxs("select",{value:y.match_id,onChange:e=>_({...y,match_id:e.target.value}),children:[s.jsx("option",{value:"",children:"Select Match"}),r.map(e=>{var a,t;return s.jsxs("option",{value:e.id,children:[null==(a=e.home_team)?void 0:a.name," vs ",null==(t=e.away_team)?void 0:t.name," - ",new Date(e.match_date).toLocaleDateString()]},e.id)})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Goal Scorer"}),s.jsxs("select",{value:y.scorer_id,onChange:e=>_({...y,scorer_id:e.target.value}),children:[s.jsx("option",{value:"",children:"Select Scorer"}),o.map(e=>{var a;return s.jsxs("option",{value:e.id,children:[e.player_name," (",null==(a=e.team_registrations)?void 0:a.team_name,")"]},e.id)})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Assister (Optional)"}),s.jsxs("select",{value:y.assister_id,onChange:e=>_({...y,assister_id:e.target.value}),children:[s.jsx("option",{value:"",children:"No Assist"}),o.map(e=>{var a;return s.jsxs("option",{value:e.id,children:[e.player_name," (",null==(a=e.team_registrations)?void 0:a.team_name,")"]},e.id)})]})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Minute"}),s.jsx("input",{type:"number",min:"1",max:"120",value:y.minute,onChange:e=>_({...y,minute:e.target.value}),placeholder:"e.g., 45"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Goal Type"}),s.jsxs("select",{value:y.goal_type,onChange:e=>_({...y,goal_type:e.target.value}),children:[s.jsx("option",{value:"open_play",children:"Open Play"}),s.jsx("option",{value:"penalty",children:"Penalty"}),s.jsx("option",{value:"free_kick",children:"Free Kick"}),s.jsx("option",{value:"header",children:"Header"}),s.jsx("option",{value:"own_goal",children:"Own Goal"})]})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>x(!1),children:"Cancel"}),s.jsxs("button",{className:"btn-primary",onClick:async()=>{var a;if(y.match_id&&y.scorer_id)try{const{data:s,error:t}=await e.from("team_players").select("team_id, team_registrations(tournament_team_id)").eq("id",y.scorer_id).single();if(t)throw t;const n=null==(a=null==s?void 0:s.team_registrations)?void 0:a.tournament_team_id;if(!n)return void alert("Could not determine team for this player. Make sure the team is confirmed in the tournament.");const{error:i}=await e.from("goals").insert({match_id:y.match_id,team_id:n,scorer_id:y.scorer_id,assister_id:y.assister_id||null,minute:parseInt(y.minute)||null,goal_type:y.goal_type});if(i)throw i;alert("Goal added successfully!"),x(!1),_({match_id:"",scorer_id:"",assister_id:"",minute:"",goal_type:"open_play"}),N()}catch(s){alert("Failed to add goal: "+s.message)}else alert("Please select match and scorer")},children:[s.jsx("i",{className:"fas fa-plus"})," Add Goal"]})]})]})]})}),p&&s.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h2",{children:"Add Card"}),s.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Match"}),s.jsxs("select",{value:v.match_id,onChange:e=>b({...v,match_id:e.target.value}),children:[s.jsx("option",{value:"",children:"Select Match"}),r.map(e=>{var a,t;return s.jsxs("option",{value:e.id,children:[null==(a=e.home_team)?void 0:a.name," vs ",null==(t=e.away_team)?void 0:t.name," - ",new Date(e.match_date).toLocaleDateString()]},e.id)})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Player"}),s.jsxs("select",{value:v.player_id,onChange:e=>b({...v,player_id:e.target.value}),children:[s.jsx("option",{value:"",children:"Select Player"}),o.map(e=>{var a;return s.jsxs("option",{value:e.id,children:[e.player_name," (",null==(a=e.team_registrations)?void 0:a.team_name,")"]},e.id)})]})]}),s.jsxs("div",{className:"form-grid",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Card Type"}),s.jsxs("select",{value:v.card_type,onChange:e=>b({...v,card_type:e.target.value}),children:[s.jsx("option",{value:"yellow",children:"Yellow Card"}),s.jsx("option",{value:"red",children:"Red Card"})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Minute"}),s.jsx("input",{type:"number",min:"1",max:"120",value:v.minute,onChange:e=>b({...v,minute:e.target.value}),placeholder:"e.g., 45"})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>g(!1),children:"Cancel"}),s.jsxs("button",{className:"btn-primary",onClick:async()=>{var a;if(v.match_id&&v.player_id)try{const{data:s,error:t}=await e.from("team_players").select("team_id, team_registrations(tournament_team_id)").eq("id",v.player_id).single();if(t)throw t;const n=null==(a=null==s?void 0:s.team_registrations)?void 0:a.tournament_team_id;if(!n)return void alert("Could not determine team for this player. Make sure the team is confirmed in the tournament.");const{error:i}=await e.from("cards").insert({match_id:v.match_id,team_id:n,player_id:v.player_id,card_type:v.card_type,minute:parseInt(v.minute)||null});if(i)throw i;alert("Card added successfully!"),g(!1),b({match_id:"",player_id:"",card_type:"yellow",minute:""}),N()}catch(s){alert("Failed to add card: "+s.message)}else alert("Please select match and player")},children:[s.jsx("i",{className:"fas fa-plus"})," Add Card"]})]})]})]})})]})}function z(){const[t,n]=a.useState({topScorers:[],topAssisters:[],teamStats:[],matchStats:{totalMatches:0,completedMatches:0,totalGoals:0,averageGoals:0}}),[i,l]=a.useState(!0),[r,c]=a.useState("all");a.useEffect(()=>{o()},[r]);const o=async()=>{try{l(!0);const{data:a,error:s}=await e.from("goals").select("scorer_id, team_players!goals_scorer_id_fkey(player_name, player_image, team_registrations(team_name, category))").order("scorer_id");if(s)throw s;const t={};null==a||a.forEach(e=>{const a=e.scorer_id;t[a]||(t[a]={player:e.team_players,goals:0}),t[a].goals++});const i=Object.values(t).sort((e,a)=>a.goals-e.goals).slice(0,10),{data:c,error:o}=await e.from("goals").select("assister_id, team_players!goals_assister_id_fkey(player_name, player_image, team_registrations(team_name))").not("assister_id","is",null);if(o)throw o;const d={};null==c||c.forEach(e=>{const a=e.assister_id;t[a]||(d[a]={player:e.team_players,assists:0}),d[a].assists++});const m=Object.values(d).sort((e,a)=>a.assists-e.assists).slice(0,10);let h=e.from("teams").select("*").order("points",{ascending:!1});"all"!==r&&(h=h.eq("category",r));const{data:u,error:x}=await h;if(x)throw x;const{data:p,error:g}=await e.from("matches").select("*");if(g)throw g;const j=(null==a?void 0:a.length)||0,f=(null==p?void 0:p.filter(e=>"completed"===e.status).length)||0;n({topScorers:i,topAssisters:m,teamStats:u||[],matchStats:{totalMatches:(null==p?void 0:p.length)||0,completedMatches:f,totalGoals:j,averageGoals:f>0?(j/f).toFixed(2):0}})}catch(a){alert("Failed to load statistics")}finally{l(!1)}};return s.jsxs(F,{title:"Tournament Statistics",children:[s.jsxs("div",{className:"admin-page-header",children:[s.jsx("div",{className:"page-header-left",children:s.jsxs("button",{className:"refresh-btn",onClick:o,children:[s.jsx("i",{className:"fas fa-sync-alt"})," Refresh"]})}),s.jsx("div",{className:"page-header-right",children:s.jsxs("select",{className:"filter-select",value:r,onChange:e=>c(e.target.value),children:[s.jsx("option",{value:"all",children:"All Categories"}),s.jsx("option",{value:"open-age",children:"Open Age"}),s.jsx("option",{value:"u17",children:"Under 17"})]})})]}),i?s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading statistics..."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"stats-overview",children:[s.jsx("h3",{children:"Match Overview"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat-box",children:[s.jsx("i",{className:"fas fa-futbol"}),s.jsxs("div",{children:[s.jsx("p",{className:"stat-label",children:"Total Matches"}),s.jsx("p",{className:"stat-value",children:t.matchStats.totalMatches})]})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("i",{className:"fas fa-check-circle"}),s.jsxs("div",{children:[s.jsx("p",{className:"stat-label",children:"Completed"}),s.jsx("p",{className:"stat-value",children:t.matchStats.completedMatches})]})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("i",{className:"fas fa-trophy"}),s.jsxs("div",{children:[s.jsx("p",{className:"stat-label",children:"Total Goals"}),s.jsx("p",{className:"stat-value",children:t.matchStats.totalGoals})]})]}),s.jsxs("div",{className:"stat-box",children:[s.jsx("i",{className:"fas fa-chart-line"}),s.jsxs("div",{children:[s.jsx("p",{className:"stat-label",children:"Avg Goals/Match"}),s.jsx("p",{className:"stat-value",children:t.matchStats.averageGoals})]})]})]})]}),s.jsxs("div",{className:"stats-tables-grid",children:[s.jsxs("div",{className:"stats-table-section",children:[s.jsx("h3",{children:"Top Scorers"}),s.jsxs("table",{className:"admin-table compact",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"#"}),s.jsx("th",{children:"Player"}),s.jsx("th",{children:"Team"}),s.jsx("th",{children:"Goals"})]})}),s.jsx("tbody",{children:0===t.topScorers.length?s.jsx("tr",{children:s.jsx("td",{colSpan:"4",style:{textAlign:"center",padding:"20px"},children:"No goals recorded"})}):t.topScorers.map((e,a)=>{var t,n,i,l;return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("strong",{children:a+1})}),s.jsx("td",{children:s.jsxs("div",{className:"player-cell",children:[(null==(t=e.player)?void 0:t.player_image)&&s.jsx("img",{src:e.player.player_image,alt:"",className:"player-image-tiny"}),s.jsx("span",{children:null==(n=e.player)?void 0:n.player_name})]})}),s.jsx("td",{children:null==(l=null==(i=e.player)?void 0:i.team_registrations)?void 0:l.team_name}),s.jsx("td",{children:s.jsx("strong",{className:"highlight-value",children:e.goals})})]},a)})})]})]}),s.jsxs("div",{className:"stats-table-section",children:[s.jsx("h3",{children:"Top Assisters"}),s.jsxs("table",{className:"admin-table compact",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"#"}),s.jsx("th",{children:"Player"}),s.jsx("th",{children:"Team"}),s.jsx("th",{children:"Assists"})]})}),s.jsx("tbody",{children:0===t.topAssisters.length?s.jsx("tr",{children:s.jsx("td",{colSpan:"4",style:{textAlign:"center",padding:"20px"},children:"No assists recorded"})}):t.topAssisters.map((e,a)=>{var t,n,i,l;return s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("strong",{children:a+1})}),s.jsx("td",{children:s.jsxs("div",{className:"player-cell",children:[(null==(t=e.player)?void 0:t.player_image)&&s.jsx("img",{src:e.player.player_image,alt:"",className:"player-image-tiny"}),s.jsx("span",{children:null==(n=e.player)?void 0:n.player_name})]})}),s.jsx("td",{children:null==(l=null==(i=e.player)?void 0:i.team_registrations)?void 0:l.team_name}),s.jsx("td",{children:s.jsx("strong",{className:"highlight-value",children:e.assists})})]},a)})})]})]})]}),s.jsxs("div",{className:"stats-table-section full-width",children:[s.jsx("h3",{children:"Team Standings"}),s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"#"}),s.jsx("th",{children:"Team"}),s.jsx("th",{children:"Played"}),s.jsx("th",{children:"Won"}),s.jsx("th",{children:"Drawn"}),s.jsx("th",{children:"Lost"}),s.jsx("th",{children:"GF"}),s.jsx("th",{children:"GA"}),s.jsx("th",{children:"GD"}),s.jsx("th",{children:"Points"})]})}),s.jsx("tbody",{children:t.teamStats.map((e,a)=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("strong",{children:a+1})}),s.jsx("td",{children:s.jsxs("div",{className:"team-cell",children:[e.crest_url&&s.jsx("img",{src:e.crest_url,alt:"",className:"team-logo-small"}),s.jsx("span",{children:e.name})]})}),s.jsx("td",{children:e.played||0}),s.jsx("td",{children:e.won||0}),s.jsx("td",{children:e.drawn||0}),s.jsx("td",{children:e.lost||0}),s.jsx("td",{children:e.goals_for||0}),s.jsx("td",{children:e.goals_against||0}),s.jsx("td",{children:(e.goals_for||0)-(e.goals_against||0)}),s.jsx("td",{children:s.jsx("strong",{className:"highlight-value",children:e.points||0})})]},e.id))})]})]})]})]})}function I(){const[t,n]=a.useState(!1),[i,l]=a.useState([]),[r,c]=a.useState("all"),o=(e,a="info")=>{l(s=>[...s,{message:e,type:a,timestamp:(new Date).toLocaleTimeString()}])};return s.jsxs(F,{title:"Statistics Utilities",children:[s.jsxs("div",{className:"utilities-page",children:[s.jsxs("div",{className:"utilities-header",children:[s.jsx("h2",{children:"⚙️ Data Management Utilities"}),s.jsx("p",{className:"utilities-description",children:"Use these tools to maintain data integrity and fix inconsistencies"})]}),s.jsxs("div",{className:"category-filter",children:[s.jsx("label",{children:"Category Filter:"}),s.jsxs("select",{value:r,onChange:e=>c(e.target.value),disabled:t,children:[s.jsx("option",{value:"all",children:"All Categories"}),s.jsx("option",{value:"open-age",children:"Open Age"}),s.jsx("option",{value:"u17",children:"U17"})]})]}),s.jsxs("div",{className:"utilities-cards",children:[s.jsxs("div",{className:"utility-card",children:[s.jsx("div",{className:"utility-icon",children:"📊"}),s.jsx("h3",{children:"Recalculate Team Statistics"}),s.jsx("p",{children:"Resets and recalculates all team statistics (played, won, drawn, lost, goals, points) from completed match results. Use this to fix data inconsistencies."}),s.jsx("button",{className:"btn-primary",onClick:async()=>{if(confirm("⚠️ This will recalculate ALL team statistics from completed matches.\n\nThis may take a few moments. Continue?"))try{n(!0),l([]),o("🚀 Starting stats recalculation...","info");const{data:a,error:s}=await e.from("teams").select("*").order("name");if(s)throw s;const t="all"===r?a:a.filter(e=>e.category===r);o(`📊 Found ${t.length} teams to process`,"info");for(const n of t)await e.from("teams").update({played:0,won:0,drawn:0,lost:0,goals_for:0,goals_against:0,points:0}).eq("id",n.id);o("✅ Reset all team stats to zero","success");const{data:i,error:c}=await e.from("matches").select("\n          *,\n          home_team:teams!matches_home_team_id_fkey(id, name, category),\n          away_team:teams!matches_away_team_id_fkey(id, name, category)\n        ").eq("status","completed");if(c)throw c;const d="all"===r?i:i.filter(e=>{var a;return(null==(a=e.home_team)?void 0:a.category)===r});o(`⚽ Found ${d.length} completed matches`,"info");for(const n of d){if(!n.home_team_id||!n.away_team_id){o("⚠️ Skipping match with missing teams","warning");continue}const a=n.home_score||0,s=n.away_score||0,{data:t}=await e.from("teams").select("*").eq("id",n.home_team_id).single(),{data:i}=await e.from("teams").select("*").eq("id",n.away_team_id).single();if(!t||!i){o("⚠️ Skipping match: teams not found","warning");continue}let l={played:(t.played||0)+1,goals_for:(t.goals_for||0)+a,goals_against:(t.goals_against||0)+s},r={played:(i.played||0)+1,goals_for:(i.goals_for||0)+s,goals_against:(i.goals_against||0)+a};a>s?(l.won=(t.won||0)+1,l.points=(t.points||0)+3,r.lost=(i.lost||0)+1):a<s?(r.won=(i.won||0)+1,r.points=(i.points||0)+3,l.lost=(t.lost||0)+1):(l.drawn=(t.drawn||0)+1,l.points=(t.points||0)+1,r.drawn=(i.drawn||0)+1,r.points=(i.points||0)+1),await e.from("teams").update(l).eq("id",n.home_team_id),await e.from("teams").update(r).eq("id",n.away_team_id),o(`✓ Processed: ${t.name} ${a}-${s} ${i.name}`,"success")}o("🎉 Recalculation complete!","success"),o(`📈 Processed ${d.length} matches across ${t.length} teams`,"info")}catch(a){o(`❌ Error: ${a.message}`,"error")}finally{n(!1)}},disabled:t,children:t?"⏳ Processing...":"🔄 Recalculate All Stats"})]}),s.jsxs("div",{className:"utility-card",children:[s.jsx("div",{className:"utility-icon",children:"⚽"}),s.jsx("h3",{children:"Sync Match Scores from Goals"}),s.jsx("p",{children:"Recalculates match scores by counting goal records in the database. Use this if match scores don't match the recorded goals."}),s.jsx("button",{className:"btn-primary",onClick:async()=>{if(confirm("🔄 This will recalculate match scores from goal records.\n\nUse this if scores are out of sync with goals. Continue?"))try{n(!0),l([]),o("🚀 Starting match score sync from goals...","info");const{data:s,error:t}=await e.from("matches").select("*");if(t)throw t;const i="all"===r?s:s.filter(e=>e.category===r);o(`⚽ Found ${i.length} matches to sync`,"info");let c=0,d=0;for(const n of i)try{const{data:a,error:s}=await e.from("goals").select("id").eq("match_id",n.id).eq("team_id",n.home_team_id),{data:t,error:i}=await e.from("goals").select("id").eq("match_id",n.id).eq("team_id",n.away_team_id);if(s||i)throw new Error("Failed to fetch goals");const l=(null==a?void 0:a.length)||0,r=(null==t?void 0:t.length)||0;n.home_score===l&&n.away_score===r||(await e.from("matches").update({home_score:l,away_score:r}).eq("id",n.id),o(`✓ Synced match scores: ${l}-${r}`,"success"),c++)}catch(a){o(`⚠️ Error processing match: ${a.message}`,"warning"),d++}o(`🎉 Sync complete! ${c} matches updated, ${d} errors`,"success")}catch(s){o(`❌ Error: ${s.message}`,"error")}finally{n(!1)}},disabled:t,children:t?"⏳ Processing...":"🔄 Sync Scores from Goals"})]})]}),i.length>0&&s.jsxs("div",{className:"utility-log",children:[s.jsx("h3",{children:"📝 Process Log"}),s.jsx("div",{className:"log-content",children:i.map((e,a)=>s.jsxs("div",{className:`log-entry log-${e.type}`,children:[s.jsxs("span",{className:"log-time",children:["[",e.timestamp,"]"]}),s.jsx("span",{className:"log-message",children:e.message})]},a))})]})]}),s.jsx("style",{jsx:!0,children:"\n        .utilities-page {\n          max-width: 1200px;\n          margin: 0 auto;\n          padding: 20px;\n        }\n\n        .utilities-header {\n          text-align: center;\n          margin-bottom: 30px;\n        }\n\n        .utilities-header h2 {\n          font-size: 2rem;\n          margin-bottom: 10px;\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          -webkit-background-clip: text;\n          -webkit-text-fill-color: transparent;\n        }\n\n        .utilities-description {\n          color: #666;\n          font-size: 1.1rem;\n        }\n\n        .category-filter {\n          background: white;\n          padding: 15px 20px;\n          border-radius: 12px;\n          margin-bottom: 30px;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.05);\n          display: flex;\n          align-items: center;\n          gap: 15px;\n        }\n\n        .category-filter label {\n          font-weight: 600;\n          color: #333;\n        }\n\n        .category-filter select {\n          padding: 8px 15px;\n          border: 2px solid #e5e7eb;\n          border-radius: 8px;\n          font-size: 1rem;\n          cursor: pointer;\n          transition: all 0.3s ease;\n        }\n\n        .category-filter select:focus {\n          outline: none;\n          border-color: #667eea;\n        }\n\n        .utilities-cards {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n          gap: 20px;\n          margin-bottom: 30px;\n        }\n\n        .utility-card {\n          background: white;\n          padding: 30px;\n          border-radius: 12px;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n          transition: transform 0.3s ease, box-shadow 0.3s ease;\n        }\n\n        .utility-card:hover {\n          transform: translateY(-5px);\n          box-shadow: 0 5px 20px rgba(0,0,0,0.15);\n        }\n\n        .utility-icon {\n          font-size: 3rem;\n          margin-bottom: 15px;\n        }\n\n        .utility-card h3 {\n          font-size: 1.4rem;\n          margin-bottom: 10px;\n          color: #333;\n        }\n\n        .utility-card p {\n          color: #666;\n          line-height: 1.6;\n          margin-bottom: 20px;\n        }\n\n        .btn-primary {\n          width: 100%;\n          padding: 12px 24px;\n          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n          color: white;\n          border: none;\n          border-radius: 8px;\n          font-size: 1rem;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.3s ease;\n        }\n\n        .btn-primary:hover:not(:disabled) {\n          transform: scale(1.02);\n          box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);\n        }\n\n        .btn-primary:disabled {\n          opacity: 0.6;\n          cursor: not-allowed;\n        }\n\n        .utility-log {\n          background: white;\n          padding: 20px;\n          border-radius: 12px;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        }\n\n        .utility-log h3 {\n          margin-bottom: 15px;\n          color: #333;\n        }\n\n        .log-content {\n          max-height: 400px;\n          overflow-y: auto;\n          background: #f9fafb;\n          border-radius: 8px;\n          padding: 15px;\n          font-family: 'Monaco', 'Courier New', monospace;\n          font-size: 0.9rem;\n        }\n\n        .log-entry {\n          padding: 8px 12px;\n          margin-bottom: 8px;\n          border-radius: 6px;\n          display: flex;\n          gap: 10px;\n          align-items: flex-start;\n        }\n\n        .log-time {\n          color: #999;\n          flex-shrink: 0;\n        }\n\n        .log-message {\n          flex: 1;\n        }\n\n        .log-info {\n          background: #eff6ff;\n          color: #1e40af;\n        }\n\n        .log-success {\n          background: #f0fdf4;\n          color: #166534;\n        }\n\n        .log-warning {\n          background: #fef9c3;\n          color: #854d0e;\n        }\n\n        .log-error {\n          background: #fef2f2;\n          color: #991b1b;\n        }\n\n        @media (max-width: 768px) {\n          .utilities-cards {\n            grid-template-columns: 1fr;\n          }\n          \n          .category-filter {\n            flex-direction: column;\n            align-items: stretch;\n          }\n        }\n      "})]})}function O(){const[t,n]=a.useState("general"),[i,l]=a.useState([]),[r,c]=a.useState(""),[o,d]=a.useState(!1),[m,h]=a.useState(!1),[u,p]=a.useState(!1),[g,j]=a.useState(""),[f,y]=a.useState("");a.useEffect(()=>{"data"===t&&_()},[t]);const _=async()=>{try{const{data:a,error:s}=await e.from("matches").select("\n          *,\n          home_team:teams!matches_home_team_id_fkey(name),\n          away_team:teams!matches_away_team_id_fkey(name)\n        ").order("match_date",{ascending:!1});if(s)throw s;l(a||[])}catch(a){}},v=async a=>{try{const{data:s,error:t}=await e.from(a).select("*");if(t)throw t;const n=JSON.stringify(s,null,2),i=new Blob([n],{type:"application/json"}),l=URL.createObjectURL(i),r=document.createElement("a");r.href=l,r.download=`${a}-export-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(l),alert(`${a} data exported successfully!`)}catch(s){alert("Failed to export data")}};return s.jsxs(F,{title:"Settings",children:[s.jsxs("div",{className:"settings-container",children:[s.jsxs("div",{className:"settings-tabs",children:[s.jsxs("button",{className:"settings-tab "+("general"===t?"active":""),onClick:()=>n("general"),children:[s.jsx("i",{className:"fas fa-cog"})," General"]}),s.jsxs("button",{className:"settings-tab "+("data"===t?"active":""),onClick:()=>n("data"),children:[s.jsx("i",{className:"fas fa-database"})," Data Management"]}),s.jsxs("button",{className:"settings-tab "+("admin"===t?"active":""),onClick:()=>n("admin"),children:[s.jsx("i",{className:"fas fa-user-shield"})," Admin Info"]})]}),s.jsxs("div",{className:"settings-content",children:["general"===t&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Tournament Settings"}),s.jsxs("div",{className:"settings-card",children:[s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("h4",{children:"Registration Status"}),s.jsx("p",{children:"Enable or disable team registrations"})]}),s.jsx("button",{className:"toggle-btn active",children:s.jsx("span",{children:"Enabled"})})]}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("h4",{children:"Tournament Year"}),s.jsx("p",{children:"Current tournament season"})]}),s.jsx("input",{type:"text",value:"2026",readOnly:!0,className:"setting-input"})]}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("h4",{children:"Registration Fee (Open Age)"}),s.jsx("p",{children:"Registration amount for open age category"})]}),s.jsx("input",{type:"number",value:"2500",readOnly:!0,className:"setting-input"})]}),s.jsxs("div",{className:"setting-item",children:[s.jsxs("div",{className:"setting-info",children:[s.jsx("h4",{children:"Registration Fee (U17)"}),s.jsx("p",{children:"Registration amount for under 17 category"})]}),s.jsx("input",{type:"number",value:"2300",readOnly:!0,className:"setting-input"})]})]})]}),"data"===t&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Data Management"}),s.jsxs("div",{className:"settings-card",children:[s.jsx("h4",{children:"Export Data"}),s.jsx("p",{children:"Download data from database tables in JSON format"}),s.jsxs("div",{className:"export-buttons",children:[s.jsxs("button",{className:"btn-export",onClick:()=>v("team_registrations"),children:[s.jsx("i",{className:"fas fa-download"})," Export Registrations"]}),s.jsxs("button",{className:"btn-export",onClick:()=>v("teams"),children:[s.jsx("i",{className:"fas fa-download"})," Export Teams"]}),s.jsxs("button",{className:"btn-export",onClick:()=>v("team_players"),children:[s.jsx("i",{className:"fas fa-download"})," Export Players"]}),s.jsxs("button",{className:"btn-export",onClick:()=>v("matches"),children:[s.jsx("i",{className:"fas fa-download"})," Export Matches"]}),s.jsxs("button",{className:"btn-export",onClick:()=>v("goals"),children:[s.jsx("i",{className:"fas fa-download"})," Export Goals"]})]})]}),s.jsxs("div",{className:"settings-card danger",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-exclamation-triangle"})," Danger Zone"]}),s.jsx("p",{children:"These actions are irreversible. Proceed with caution!"}),s.jsxs("div",{className:"danger-actions",children:[s.jsxs("button",{className:"btn-danger",onClick:async()=>{if(confirm("Are you sure you want to reset ALL team standings? This cannot be undone!"))try{const{error:a}=await e.from("teams").update({played:0,won:0,drawn:0,lost:0,goals_for:0,goals_against:0,points:0}).neq("id","00000000-0000-0000-0000-000000000000");if(a)throw a;alert("All team standings have been reset!")}catch(a){alert("Failed to reset standings")}},children:[s.jsx("i",{className:"fas fa-undo"})," Reset All Standings"]}),s.jsxs("button",{className:"btn-danger",onClick:async()=>{if(confirm("Are you sure you want to delete ALL goals? This cannot be undone!"))try{const{error:a}=await e.from("goals").delete().neq("id","00000000-0000-0000-0000-000000000000");if(a)throw a;alert("All goals have been deleted!")}catch(a){alert("Failed to clear goals")}},children:[s.jsx("i",{className:"fas fa-trash"})," Clear All Goals"]}),s.jsxs("button",{className:"btn-danger",onClick:async()=>{if(confirm("⚠️ WARNING: This will delete ALL goals AND reset ALL team standings!\n\nThis action cannot be undone. Are you absolutely sure?")&&confirm("Please confirm again: Delete ALL statistics and reset ALL standings?"))try{const{error:a}=await e.from("goals").delete().neq("id","00000000-0000-0000-0000-000000000000");if(a)throw a;const{error:s}=await e.from("teams").update({played:0,won:0,drawn:0,lost:0,goals_for:0,goals_against:0,points:0}).neq("id","00000000-0000-0000-0000-000000000000");if(s)throw s;alert("All statistics have been cleared and standings reset!")}catch(a){alert("Failed to clear statistics")}},children:[s.jsx("i",{className:"fas fa-exclamation-circle"})," Clear All Statistics"]}),s.jsxs("button",{className:"btn-danger",onClick:()=>d(!0),children:[s.jsx("i",{className:"fas fa-futbol"})," Clear Match Statistics"]}),s.jsxs("button",{className:"btn-danger",onClick:async()=>{if(confirm("Are you sure you want to delete ALL user predictions (votes)?\n\nThis will remove all community predictions from all matches.\n\nThis action cannot be undone!"))try{const{count:a}=await e.from("match_predictions").select("*",{count:"exact",head:!0}),{error:s}=await e.from("match_predictions").delete().neq("id","00000000-0000-0000-0000-000000000000");if(s)throw s;alert(`Successfully deleted ${a||0} prediction(s)!`)}catch(a){alert("Failed to clear votes")}},children:[s.jsx("i",{className:"fas fa-vote-yea"})," Clear All Votes"]}),s.jsxs("button",{className:"btn-danger",onClick:async()=>{if(confirm("Are you sure you want to delete ALL match likes?\n\nThis will remove all likes from all matches.\n\nThis action cannot be undone!"))try{const{count:a}=await e.from("match_likes").select("*",{count:"exact",head:!0}),{error:s}=await e.from("match_likes").delete().neq("id","00000000-0000-0000-0000-000000000000");if(s)throw s;alert(`Successfully deleted ${a||0} like(s)!`)}catch(a){alert("Failed to clear likes")}},children:[s.jsx("i",{className:"fas fa-heart"})," Clear All Likes"]}),s.jsxs("button",{className:"btn-danger",onClick:()=>h(!0),children:[s.jsx("i",{className:"fas fa-heart"})," Clear Match Likes"]}),s.jsxs("button",{className:"btn-danger",onClick:()=>p(!0),children:[s.jsx("i",{className:"fas fa-vote-yea"})," Clear Match Votes"]})]})]})]}),"admin"===t&&s.jsxs("div",{className:"settings-section",children:[s.jsx("h3",{children:"Admin Information"}),s.jsxs("div",{className:"settings-card",children:[s.jsxs("div",{className:"admin-info-grid",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Super Admin Emails"}),s.jsx("div",{className:"email-list",children:x.map((e,a)=>s.jsxs("div",{className:"email-badge",children:[s.jsx("i",{className:"fas fa-shield-alt"}),e]},a))})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Admin Panel Version"}),s.jsx("p",{children:"v1.0.0"})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Last Updated"}),s.jsx("p",{children:(new Date).toLocaleDateString()})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Configuration File"}),s.jsx("code",{children:"admin/config/adminConfig.js"})]})]}),s.jsxs("div",{className:"info-note",children:[s.jsx("i",{className:"fas fa-info-circle"}),s.jsxs("p",{children:["To add more admin users, edit the ",s.jsx("code",{children:"SUPER_ADMIN_EMAILS"})," array in the admin configuration file."]})]})]})]})]})]}),o&&s.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[s.jsx("i",{className:"fas fa-futbol"})," Clear Match Statistics"]}),s.jsx("button",{className:"modal-close",onClick:()=>d(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"modal-warning",children:[s.jsx("i",{className:"fas fa-exclamation-triangle"}),s.jsx("p",{children:"This will delete all goals recorded for the selected match. This action cannot be undone."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Select Match"}),s.jsxs("select",{value:r,onChange:e=>c(e.target.value),className:"form-select",children:[s.jsx("option",{value:"",children:"Choose a match..."}),i.map(e=>{var a,t;return s.jsxs("option",{value:e.id,children:[null==(a=e.home_team)?void 0:a.name," vs ",null==(t=e.away_team)?void 0:t.name," - ",new Date(e.match_date).toLocaleDateString()," (",e.status,")"]},e.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{d(!1),c("")},children:"Cancel"}),s.jsxs("button",{className:"btn-danger",onClick:async()=>{var a,s;if(!r)return void alert("Please select a match");const t=i.find(e=>e.id===r);if(!t)return;const n=`${null==(a=t.home_team)?void 0:a.name} vs ${null==(s=t.away_team)?void 0:s.name}`;if(confirm(`Are you sure you want to delete all goals for this match?\n\n${n}\n\nThis cannot be undone!`))try{const{count:a}=await e.from("goals").select("*",{count:"exact",head:!0}).eq("match_id",r),{error:s}=await e.from("goals").delete().eq("match_id",r);if(s)throw s;alert(`Successfully deleted ${a||0} goal(s) from this match!`),d(!1),c("")}catch(l){alert("Failed to clear match statistics")}},disabled:!r,children:[s.jsx("i",{className:"fas fa-trash"})," Clear Statistics"]})]})]})]})}),m&&s.jsx("div",{className:"modal-overlay",onClick:()=>h(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[s.jsx("i",{className:"fas fa-heart"})," Clear Match Likes"]}),s.jsx("button",{className:"modal-close",onClick:()=>h(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"modal-warning",children:[s.jsx("i",{className:"fas fa-exclamation-triangle"}),s.jsx("p",{children:"This will delete all likes for the selected match. This action cannot be undone."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Select Match"}),s.jsxs("select",{value:g,onChange:e=>j(e.target.value),className:"form-select",children:[s.jsx("option",{value:"",children:"Choose a match..."}),i.map(e=>{var a,t;return s.jsxs("option",{value:e.id,children:[null==(a=e.home_team)?void 0:a.name," vs ",null==(t=e.away_team)?void 0:t.name," - ",new Date(e.match_date).toLocaleDateString()," (",e.status,")"]},e.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{h(!1),j("")},children:"Cancel"}),s.jsxs("button",{className:"btn-danger",onClick:async()=>{var a,s;if(!g)return void alert("Please select a match");const t=i.find(e=>e.id===g);if(!t)return;const n=`${null==(a=t.home_team)?void 0:a.name} vs ${null==(s=t.away_team)?void 0:s.name}`;if(confirm(`Are you sure you want to delete all likes for this match?\n\n${n}\n\nThis cannot be undone!`))try{const{count:a}=await e.from("match_likes").select("*",{count:"exact",head:!0}).eq("match_id",g),{error:s}=await e.from("match_likes").delete().eq("match_id",g);if(s)throw s;alert(`Successfully deleted ${a||0} like(s) from this match!`),h(!1),j("")}catch(l){alert("Failed to clear match likes")}},disabled:!g,children:[s.jsx("i",{className:"fas fa-trash"})," Clear Likes"]})]})]})]})}),u&&s.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:s.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"modal-header",children:[s.jsxs("h2",{children:[s.jsx("i",{className:"fas fa-vote-yea"})," Clear Match Votes"]}),s.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:s.jsx("i",{className:"fas fa-times"})})]}),s.jsxs("div",{className:"modal-body",children:[s.jsxs("div",{className:"modal-warning",children:[s.jsx("i",{className:"fas fa-exclamation-triangle"}),s.jsx("p",{children:"This will delete all user predictions (votes) for the selected match. This action cannot be undone."})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Select Match"}),s.jsxs("select",{value:f,onChange:e=>y(e.target.value),className:"form-select",children:[s.jsx("option",{value:"",children:"Choose a match..."}),i.map(e=>{var a,t;return s.jsxs("option",{value:e.id,children:[null==(a=e.home_team)?void 0:a.name," vs ",null==(t=e.away_team)?void 0:t.name," - ",new Date(e.match_date).toLocaleDateString()," (",e.status,")"]},e.id)})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{className:"btn-secondary",onClick:()=>{p(!1),y("")},children:"Cancel"}),s.jsxs("button",{className:"btn-danger",onClick:async()=>{var a,s;if(!f)return void alert("Please select a match");const t=i.find(e=>e.id===f);if(!t)return;const n=`${null==(a=t.home_team)?void 0:a.name} vs ${null==(s=t.away_team)?void 0:s.name}`;if(confirm(`Are you sure you want to delete all votes (predictions) for this match?\n\n${n}\n\nThis cannot be undone!`))try{const{count:a}=await e.from("match_predictions").select("*",{count:"exact",head:!0}).eq("match_id",f),{error:s}=await e.from("match_predictions").delete().eq("match_id",f);if(s)throw s;alert(`Successfully deleted ${a||0} vote(s) from this match!`),p(!1),y("")}catch(l){alert("Failed to clear match votes")}},disabled:!f,children:[s.jsx("i",{className:"fas fa-trash"})," Clear Votes"]})]})]})]})})]})}function B(){var t;const[n,i]=a.useState("open-age"),[l,r]=a.useState([]),[c,x]=a.useState({}),[p,g]=a.useState(null),[j,f]=a.useState(null),[y,_]=a.useState({total:0,completed:0,isComplete:!1}),[v,b]=a.useState(!0),[N,w]=a.useState(!1);a.useEffect(()=>{C()},[n]);const C=async()=>{b(!0);try{const{data:a,error:s}=await e.from("teams").select("*").eq("category",n).order("name");if(s)throw s;r(a||[]);const t=await o(n);x(t);const i=await d(n);g(i);const l=await m(n);_(l);const c=await h(n);f(c)}catch(a){alert("Failed to load tournament data")}finally{b(!1)}},k=async(a,s)=>{try{const{error:t}=await e.from("teams").update({tournament_group:s||null}).eq("id",a);if(t)throw t;C()}catch(t){alert("Failed to update team group")}},S=()=>l.filter(e=>!e.tournament_group);return v?s.jsx(F,{title:"Tournament Configuration",children:s.jsx("div",{className:"admin-loading",children:"Loading..."})}):s.jsxs(F,{title:"Tournament Configuration",children:[s.jsxs("div",{className:"tournament-config",children:[s.jsxs("div",{className:"config-header",children:[s.jsxs("div",{className:"category-selector",children:[s.jsx("label",{children:"Category:"}),s.jsxs("select",{value:n,onChange:e=>i(e.target.value),children:[s.jsx("option",{value:"open-age",children:"Open Age"}),s.jsx("option",{value:"u17",children:"Under 17"})]})]}),s.jsxs("div",{className:"config-stats",children:[s.jsxs("span",{className:"stat-badge",children:[s.jsx("i",{className:"fas fa-users"})," ",l.length," Teams"]}),s.jsxs("span",{className:"stat-badge",children:[s.jsx("i",{className:"fas fa-futbol"})," ",y.completed,"/",y.total," Matches"]}),s.jsx("span",{className:"stat-badge "+(y.isComplete?"complete":"pending"),children:y.isComplete?"✓ Group Stage Complete":"○ Group Stage In Progress"})]})]}),s.jsxs("div",{className:"config-section",children:[s.jsxs("div",{className:"section-header",children:[s.jsxs("h2",{children:[s.jsx("i",{className:"fas fa-th-large"})," Group Assignment"]}),s.jsxs("button",{className:"btn-secondary",onClick:async()=>{if(confirm("This will randomly assign all teams to groups. Continue?"))try{const a=[...l].sort(()=>Math.random()-.5),s=["A","B","C","D"],t=Math.ceil(a.length/s.length);for(let n=0;n<a.length;n++){const i=Math.floor(n/t),l=s[Math.min(i,s.length-1)];await e.from("teams").update({tournament_group:l}).eq("id",a[n].id)}alert("Teams assigned to groups!"),C()}catch(a){alert("Failed to assign groups")}},children:[s.jsx("i",{className:"fas fa-random"})," Auto-Assign Groups"]})]}),s.jsx("div",{className:"groups-grid",children:["A","B","C","D"].map(e=>s.jsxs("div",{className:"group-card",children:[s.jsxs("h3",{className:"group-title",children:["Group ",e]}),s.jsxs("div",{className:"group-teams",children:[(c[e]||[]).map((e,a)=>s.jsxs("div",{className:"group-team-row",children:[s.jsx("span",{className:"team-position",children:a+1}),s.jsx("img",{src:e.crest_url||"/assets/img/default-crest.png",alt:"",className:"team-crest-mini"}),s.jsx("span",{className:"team-name",children:e.name}),s.jsxs("span",{className:"team-stats",children:[e.points||0,"pts | GD: ",e.goal_difference>=0?"+":"",e.goal_difference||0]}),s.jsx("button",{className:"btn-icon remove",onClick:()=>k(e.id,null),title:"Remove from group",children:s.jsx("i",{className:"fas fa-times"})})]},e.id)),0===(c[e]||[]).length&&s.jsx("div",{className:"empty-group",children:"No teams assigned"})]}),s.jsxs("select",{className:"add-team-select",value:"",onChange:a=>{a.target.value&&k(a.target.value,e)},children:[s.jsxs("option",{value:"",children:["+ Add team to Group ",e]}),S().map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]},e))}),S().length>0&&s.jsxs("div",{className:"unassigned-teams",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-exclamation-triangle"})," Unassigned Teams (",S().length,")"]}),s.jsx("div",{className:"unassigned-list",children:S().map(e=>s.jsxs("div",{className:"unassigned-team",children:[s.jsx("img",{src:e.crest_url||"/assets/img/default-crest.png",alt:"",className:"team-crest-mini"}),s.jsx("span",{children:e.name}),s.jsxs("select",{onChange:a=>{a.target.value&&k(e.id,a.target.value)},children:[s.jsx("option",{value:"",children:"Assign to..."}),s.jsx("option",{value:"A",children:"Group A"}),s.jsx("option",{value:"B",children:"Group B"}),s.jsx("option",{value:"C",children:"Group C"}),s.jsx("option",{value:"D",children:"Group D"})]})]},e.id))})]})]}),s.jsxs("div",{className:"config-section",children:[s.jsx("div",{className:"section-header",children:s.jsxs("h2",{children:[s.jsx("i",{className:"fas fa-trophy"})," Knockout Stage"]})}),s.jsx("div",{className:"knockout-actions",children:(null==p?void 0:p.group_stage_complete)?s.jsxs("button",{className:"btn-primary",onClick:async()=>{if(null==p?void 0:p.group_stage_complete){if(confirm("Configure knockout bracket? This will create quarter-final matches based on group standings.")){w(!0);try{const a=await o(n),s=p.teams_qualifying_per_group||2,t={};Object.entries(a).forEach(([e,a])=>{"Ungrouped"!==e&&a.slice(0,s).forEach((a,s)=>{t[`${e}${s+1}`]=a})}),await e.from("knockout_bracket").delete().eq("category",n),await e.from("matches").delete().eq("category",n).in("match_type",["quarter-final","semi-final","final","third-place"]);for(const i of u.quarterFinals){const a=t[i.home],s=t[i.away];if(!a||!s)continue;const{data:l,error:r}=await e.from("matches").insert({home_team_id:a.id,away_team_id:s.id,category:n,match_type:"quarter-final",status:"scheduled",match_number:i.match}).select().single();if(r)throw r;await e.from("knockout_bracket").insert({category:n,round:"quarter-final",match_number:i.match,home_slot:i.home,away_slot:i.away,home_team_id:a.id,away_team_id:s.id,match_id:l.id})}for(const i of u.semiFinals)await e.from("knockout_bracket").insert({category:n,round:"semi-final",match_number:i.match,home_slot:i.home,away_slot:i.away});await e.from("knockout_bracket").insert({category:n,round:"final",match_number:1,home_slot:u.final.home,away_slot:u.final.away}),await e.from("knockout_bracket").insert({category:n,round:"third-place",match_number:1,home_slot:u.thirdPlace.home,away_slot:u.thirdPlace.away}),alert("Knockout bracket configured! Quarter-final matches have been created."),C()}catch(a){alert("Failed to configure knockout: "+a.message)}finally{w(!1)}}}else alert("Please mark group stage as complete first.")},disabled:N,children:[s.jsx("i",{className:"fas fa-cogs"}),N?"Configuring...":"Configure Knockout Bracket"]}):s.jsxs("button",{className:"btn-primary",onClick:async()=>{if(y.isComplete){if(confirm("Mark group stage as complete? This will allow knockout configuration."))try{const{error:a}=await e.from("tournament_settings").upsert({category:n,group_stage_complete:!0,updated_at:(new Date).toISOString()},{onConflict:"category"});if(a)throw a;alert("Group stage marked as complete!"),C()}catch(a){alert("Failed to update settings")}}else alert(`Group stage is not complete!\n${y.completed}/${y.total} matches completed.`)},disabled:!y.isComplete,children:[s.jsx("i",{className:"fas fa-check-circle"})," Mark Group Stage Complete"]})}),j&&(null==(t=j["quarter-final"])?void 0:t.length)>0&&s.jsxs("div",{className:"bracket-preview",children:[s.jsx("h3",{children:"Knockout Bracket"}),s.jsxs("div",{className:"bracket-rounds",children:[s.jsxs("div",{className:"bracket-round",children:[s.jsx("h4",{children:"Quarter Finals"}),j["quarter-final"].map(e=>{var a,t;return s.jsxs("div",{className:"bracket-match",children:[s.jsxs("div",{className:"bracket-team home",children:[e.home_team?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e.home_team.crest_url,alt:""}),s.jsx("span",{children:e.home_team.name})]}):s.jsx("span",{className:"tbd",children:e.home_slot}),"completed"===(null==(a=e.match)?void 0:a.status)&&s.jsx("span",{className:"score",children:e.match.home_score})]}),s.jsxs("div",{className:"bracket-team away",children:[e.away_team?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e.away_team.crest_url,alt:""}),s.jsx("span",{children:e.away_team.name})]}):s.jsx("span",{className:"tbd",children:e.away_slot}),"completed"===(null==(t=e.match)?void 0:t.status)&&s.jsx("span",{className:"score",children:e.match.away_score})]})]},e.id)})]}),s.jsxs("div",{className:"bracket-round",children:[s.jsx("h4",{children:"Semi Finals"}),j["semi-final"].map(e=>s.jsxs("div",{className:"bracket-match",children:[s.jsx("div",{className:"bracket-team home",children:e.home_team?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e.home_team.crest_url,alt:""}),s.jsx("span",{children:e.home_team.name})]}):s.jsx("span",{className:"tbd",children:e.home_slot})}),s.jsx("div",{className:"bracket-team away",children:e.away_team?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e.away_team.crest_url,alt:""}),s.jsx("span",{children:e.away_team.name})]}):s.jsx("span",{className:"tbd",children:e.away_slot})})]},e.id))]}),s.jsxs("div",{className:"bracket-round final",children:[s.jsx("h4",{children:"Final"}),j.final.map(e=>s.jsxs("div",{className:"bracket-match",children:[s.jsx("div",{className:"bracket-team home",children:e.home_team?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e.home_team.crest_url,alt:""}),s.jsx("span",{children:e.home_team.name})]}):s.jsx("span",{className:"tbd",children:e.home_slot})}),s.jsx("div",{className:"bracket-team away",children:e.away_team?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:e.away_team.crest_url,alt:""}),s.jsx("span",{children:e.away_team.name})]}):s.jsx("span",{className:"tbd",children:e.away_slot})})]},e.id))]})]})]}),s.jsxs("div",{className:"tiebreaker-info",children:[s.jsxs("h4",{children:[s.jsx("i",{className:"fas fa-info-circle"})," Tiebreaker Rules"]}),s.jsxs("ol",{children:[s.jsx("li",{children:"Points (higher is better)"}),s.jsx("li",{children:"Goal Difference (higher is better)"}),s.jsx("li",{children:"Goals Scored (higher is better)"}),s.jsx("li",{children:"Head-to-Head Result"}),s.jsx("li",{children:"Yellow Cards (fewer is better)"}),s.jsx("li",{children:"Red Cards (fewer is better)"}),s.jsx("li",{children:"Alphabetical Order"})]})]})]})]}),s.jsx("style",{children:"\n        .tournament-config {\n          padding: 20px;\n        }\n\n        .config-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 24px;\n          padding: 16px;\n          background: #1e2a38;\n          border-radius: 8px;\n        }\n\n        .category-selector {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n        }\n\n        .category-selector label {\n          font-weight: 600;\n          color: #8b9caf;\n        }\n\n        .category-selector select {\n          padding: 8px 16px;\n          border-radius: 6px;\n          border: 1px solid #2a3a4a;\n          background: #0d1117;\n          color: #fff;\n          font-size: 14px;\n        }\n\n        .config-stats {\n          display: flex;\n          gap: 12px;\n        }\n\n        .stat-badge {\n          padding: 8px 16px;\n          background: #2a3a4a;\n          border-radius: 20px;\n          font-size: 13px;\n          color: #8b9caf;\n        }\n\n        .stat-badge i {\n          margin-right: 6px;\n        }\n\n        .stat-badge.complete {\n          background: rgba(76, 175, 80, 0.2);\n          color: #4caf50;\n        }\n\n        .stat-badge.pending {\n          background: rgba(255, 152, 0, 0.2);\n          color: #ff9800;\n        }\n\n        .config-section {\n          background: #1e2a38;\n          border-radius: 12px;\n          padding: 24px;\n          margin-bottom: 24px;\n        }\n\n        .section-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 20px;\n        }\n\n        .section-header h2 {\n          font-size: 18px;\n          font-weight: 600;\n          color: #fff;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .groups-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n          gap: 20px;\n        }\n\n        .group-card {\n          background: #0d1117;\n          border-radius: 10px;\n          padding: 16px;\n          border: 1px solid #2a3a4a;\n        }\n\n        .group-title {\n          font-size: 16px;\n          font-weight: 700;\n          color: #4f8cff;\n          margin-bottom: 12px;\n          padding-bottom: 8px;\n          border-bottom: 2px solid #4f8cff;\n        }\n\n        .group-teams {\n          min-height: 120px;\n        }\n\n        .group-team-row {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n          padding: 8px;\n          margin-bottom: 4px;\n          background: #1e2a38;\n          border-radius: 6px;\n        }\n\n        .team-position {\n          width: 20px;\n          height: 20px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          background: #4f8cff;\n          color: #fff;\n          border-radius: 50%;\n          font-size: 11px;\n          font-weight: 700;\n        }\n\n        .team-crest-mini {\n          width: 24px;\n          height: 24px;\n          object-fit: contain;\n          border-radius: 4px;\n        }\n\n        .team-name {\n          flex: 1;\n          font-weight: 500;\n          color: #fff;\n          font-size: 13px;\n        }\n\n        .team-stats {\n          font-size: 11px;\n          color: #8b9caf;\n        }\n\n        .btn-icon {\n          width: 24px;\n          height: 24px;\n          border: none;\n          border-radius: 4px;\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n\n        .btn-icon.remove {\n          background: rgba(244, 67, 54, 0.2);\n          color: #f44336;\n        }\n\n        .btn-icon.remove:hover {\n          background: rgba(244, 67, 54, 0.4);\n        }\n\n        .empty-group {\n          text-align: center;\n          padding: 20px;\n          color: #5a6a7a;\n          font-style: italic;\n        }\n\n        .add-team-select {\n          width: 100%;\n          margin-top: 12px;\n          padding: 8px;\n          border-radius: 6px;\n          border: 1px dashed #2a3a4a;\n          background: transparent;\n          color: #8b9caf;\n          font-size: 13px;\n          cursor: pointer;\n        }\n\n        .add-team-select:hover {\n          border-color: #4f8cff;\n        }\n\n        .unassigned-teams {\n          margin-top: 24px;\n          padding: 16px;\n          background: rgba(255, 152, 0, 0.1);\n          border-radius: 8px;\n          border: 1px solid rgba(255, 152, 0, 0.3);\n        }\n\n        .unassigned-teams h4 {\n          color: #ff9800;\n          margin-bottom: 12px;\n        }\n\n        .unassigned-list {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 12px;\n        }\n\n        .unassigned-team {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 8px 12px;\n          background: #1e2a38;\n          border-radius: 6px;\n        }\n\n        .unassigned-team select {\n          padding: 4px 8px;\n          border-radius: 4px;\n          border: 1px solid #2a3a4a;\n          background: #0d1117;\n          color: #fff;\n          font-size: 12px;\n        }\n\n        .knockout-actions {\n          margin-bottom: 24px;\n        }\n\n        .btn-primary {\n          padding: 12px 24px;\n          background: linear-gradient(135deg, #4f8cff, #6fb1fc);\n          border: none;\n          border-radius: 8px;\n          color: #fff;\n          font-weight: 600;\n          cursor: pointer;\n          display: inline-flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .btn-primary:disabled {\n          opacity: 0.5;\n          cursor: not-allowed;\n        }\n\n        .btn-secondary {\n          padding: 10px 20px;\n          background: #2a3a4a;\n          border: none;\n          border-radius: 8px;\n          color: #fff;\n          font-weight: 500;\n          cursor: pointer;\n          display: inline-flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .btn-secondary:hover {\n          background: #3a4a5a;\n        }\n\n        .bracket-preview {\n          margin-top: 24px;\n        }\n\n        .bracket-preview h3 {\n          margin-bottom: 16px;\n          color: #fff;\n        }\n\n        .bracket-rounds {\n          display: flex;\n          gap: 24px;\n          overflow-x: auto;\n          padding: 16px 0;\n        }\n\n        .bracket-round {\n          min-width: 240px;\n        }\n\n        .bracket-round h4 {\n          color: #8b9caf;\n          font-size: 13px;\n          text-transform: uppercase;\n          margin-bottom: 12px;\n        }\n\n        .bracket-round.final h4 {\n          color: #ffd700;\n        }\n\n        .bracket-match {\n          background: #0d1117;\n          border-radius: 8px;\n          overflow: hidden;\n          margin-bottom: 12px;\n          border: 1px solid #2a3a4a;\n        }\n\n        .bracket-team {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          padding: 10px 12px;\n        }\n\n        .bracket-team.home {\n          border-bottom: 1px solid #2a3a4a;\n        }\n\n        .bracket-team img {\n          width: 24px;\n          height: 24px;\n          object-fit: contain;\n        }\n\n        .bracket-team span {\n          flex: 1;\n          font-size: 13px;\n        }\n\n        .bracket-team .tbd {\n          color: #5a6a7a;\n          font-style: italic;\n        }\n\n        .bracket-team .score {\n          font-weight: 700;\n          color: #4f8cff;\n        }\n\n        .tiebreaker-info {\n          margin-top: 24px;\n          padding: 16px;\n          background: rgba(79, 140, 255, 0.1);\n          border-radius: 8px;\n          border: 1px solid rgba(79, 140, 255, 0.2);\n        }\n\n        .tiebreaker-info h4 {\n          color: #4f8cff;\n          margin-bottom: 12px;\n        }\n\n        .tiebreaker-info ol {\n          margin: 0;\n          padding-left: 20px;\n          color: #8b9caf;\n        }\n\n        .tiebreaker-info li {\n          margin-bottom: 4px;\n        }\n      "})]})}function V(){const[t,n]=a.useState(""),[i,l]=a.useState(""),[r,c]=a.useState(!1),[o,d]=a.useState("");return s.jsx("div",{className:"admin-auth-modal",children:s.jsxs("div",{className:"admin-auth-card",children:[s.jsxs("div",{className:"admin-auth-header",children:[s.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama",className:"auth-logo"}),s.jsx("h2",{children:"Admin Login"}),s.jsx("p",{children:"Sign in with your admin credentials"})]}),s.jsxs("form",{onSubmit:async a=>{a.preventDefault(),c(!0),d("");try{const{error:a}=await e.auth.signInWithPassword({email:t,password:i});if(a)throw a;window.location.reload()}catch(s){d(s.message)}finally{c(!1)}},className:"admin-auth-form",children:[o&&s.jsxs("div",{className:"auth-error-banner",children:[s.jsx("i",{className:"fas fa-exclamation-circle"}),o]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email"}),s.jsx("input",{type:"email",value:t,onChange:e=>n(e.target.value),placeholder:"admin@sioafe.com",required:!0,autoComplete:"email"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Password"}),s.jsx("input",{type:"password",value:i,onChange:e=>l(e.target.value),placeholder:"Enter your password",required:!0,autoComplete:"current-password"})]}),s.jsx("button",{type:"submit",className:"admin-login-btn",disabled:r,children:r?s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-spinner fa-spin"})," Signing in..."]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"fas fa-sign-in-alt"})," Sign In"]})})]})]})})}function Y(){const[t,n]=a.useState(null),[i,l]=a.useState(!0),[r,c]=a.useState("dashboard");if(a.useEffect(()=>{(async()=>{const{data:{user:a}}=await e.auth.getUser();n(a),l(!1)})();const{data:{subscription:a}}=e.auth.onAuthStateChange((e,a)=>{n((null==a?void 0:a.user)??null)}),s=window.location.pathname;return s.includes("/admin/registrations")?c("registrations"):s.includes("/admin/players")?c("players"):s.includes("/admin/teams")?c("teams"):s.includes("/admin/fixtures")?c("fixtures"):s.includes("/admin/matches")?c("matches"):s.includes("/admin/goals")?c("goals"):s.includes("/admin/statistics")?c("statistics"):s.includes("/admin/utilities")?c("utilities"):s.includes("/admin/settings")?c("settings"):s.includes("/admin/tournament")?c("tournament"):c("dashboard"),()=>a.unsubscribe()},[]),i)return s.jsxs("div",{className:"admin-loading",children:[s.jsx("div",{className:"admin-spinner"}),s.jsx("p",{children:"Loading admin panel..."})]});if(!t)return s.jsx(V,{});return s.jsx(A,{children:(()=>{switch(r){case"registrations":return s.jsx(L,{});case"players":return s.jsx($,{});case"teams":return s.jsx(R,{});case"fixtures":return s.jsx(G,{});case"matches":return s.jsx(E,{});case"goals":return s.jsx(U,{});case"statistics":return s.jsx(z,{});case"utilities":return s.jsx(I,{});case"settings":return s.jsx(O,{});case"tournament":return s.jsx(B,{});default:return s.jsx(P,{})}})()})}t(document.getElementById("admin-root")).render(s.jsx(Y,{}));
