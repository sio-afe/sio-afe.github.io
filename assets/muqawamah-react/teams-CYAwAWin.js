import{j as a,R as s,r as e,s as l,c as i}from"./supabaseClient-Bdusv2SU.js";import{F as t}from"./Footer-YZurjJeH.js";import{T as r}from"./TournamentNavbar-BcAhqk4i.js";function c({teams:s=[],onTeamClick:e}){return a.jsxs("div",{className:"team-database",children:[a.jsx("div",{className:"team-database-header",children:a.jsx("h1",{className:"team-database-title",children:"Teams"})}),a.jsx("div",{className:"teams-count",children:a.jsxs("span",{children:[s.length," teams registered"]})}),a.jsx("div",{className:"teams-grid",children:s.map((s,l)=>{var i;const t=["linear-gradient(135deg, rgba(33, 150, 243, 0.15) 0%, rgba(33, 150, 243, 0.02) 100%)","linear-gradient(135deg, rgba(156, 39, 176, 0.15) 0%, rgba(156, 39, 176, 0.02) 100%)","linear-gradient(135deg, rgba(244, 67, 54, 0.15) 0%, rgba(244, 67, 54, 0.02) 100%)","linear-gradient(135deg, rgba(76, 175, 80, 0.15) 0%, rgba(76, 175, 80, 0.02) 100%)","linear-gradient(135deg, rgba(255, 152, 0, 0.15) 0%, rgba(255, 152, 0, 0.02) 100%)","linear-gradient(135deg, rgba(158, 158, 158, 0.15) 0%, rgba(158, 158, 158, 0.02) 100%)"],r=t[l%t.length];return a.jsxs("div",{className:"team-card-db",style:{background:r},onClick:()=>e&&e(s),children:[a.jsx("div",{className:"team-logo-large",children:s.crest_url?a.jsx("img",{src:s.crest_url,alt:s.name}):a.jsx("span",{children:(null==(i=s.name)?void 0:i.charAt(0))||"?"})}),a.jsxs("div",{className:"team-info-db",children:[a.jsx("h3",{className:"team-name-db",children:s.name}),a.jsx("p",{className:"team-captain-db",children:s.captain})]})]},s.id)})}),0===s.length&&a.jsxs("div",{className:"no-teams",children:[a.jsx("i",{className:"fas fa-shield-alt"}),a.jsx("p",{children:"No teams registered yet"})]}),a.jsx("div",{className:"back-to-tournament",children:a.jsxs("a",{href:"/muqawamah/2026/",className:"back-link",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Tournament"]})})]})}const n=s.forwardRef(({children:s,className:e="",...l},i)=>a.jsxs("svg",{ref:i,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 74 111",className:`dark-field-svg ${e}`,...l,children:[a.jsx("rect",{width:"74",height:"111",fill:"#0d1117"}),a.jsxs("g",{fill:"none",stroke:"rgba(255,255,255,0.4)",strokeWidth:"0.5",transform:"translate(3 3)",children:[a.jsx("path",{d:"M 0 0 h 68 v 105 h -68 Z"}),a.jsx("path",{d:"M 0 52.5 h 68"}),a.jsx("circle",{r:"9.15",cx:"34",cy:"52.5"}),a.jsx("circle",{r:"0.75",cx:"34",cy:"52.5",fill:"rgba(255,255,255,0.4)",stroke:"none"}),a.jsxs("g",{children:[a.jsx("path",{d:"M 13.84 0 v 16.5 h 40.32 v -16.5"}),a.jsx("path",{d:"M 24.84 0 v 5.5 h 18.32 v -5.5"}),a.jsx("circle",{r:"0.75",cx:"34",cy:"10.94",fill:"rgba(255,255,255,0.4)",stroke:"none"}),a.jsx("path",{d:"M 26.733027 16.5 a 9.15 9.15 0 0 0 14.533946 0"})]}),a.jsxs("g",{transform:"rotate(180,34,52.5)",children:[a.jsx("path",{d:"M 13.84 0 v 16.5 h 40.32 v -16.5"}),a.jsx("path",{d:"M 24.84 0 v 5.5 h 18.32 v -5.5"}),a.jsx("circle",{r:"0.75",cx:"34",cy:"10.94",fill:"rgba(255,255,255,0.4)",stroke:"none"}),a.jsx("path",{d:"M 26.733027 16.5 a 9.15 9.15 0 0 0 14.533946 0"})]}),a.jsx("path",{d:"M 0 2 a 2 2 0 0 0 2 -2M 66 0 a 2 2 0 0 0 2 2M 68 103 a 2 2 0 0 0 -2 2M 2 105 a 2 2 0 0 0 -2 -2"})]}),s]}));function d({players:s=[],formation:e=""}){const l=s.filter(a=>!a.isSubstitute&&"SUB"!==a.position).slice(0,7);return 0===l.length?a.jsx("div",{className:"team-formation-display",children:a.jsxs("div",{className:"no-formation",children:[a.jsx("i",{className:"fas fa-users-slash"}),a.jsx("p",{children:"Formation not set"})]})}):a.jsxs("div",{className:"team-formation-display",children:[e&&a.jsxs("div",{className:"formation-label",children:[a.jsx("i",{className:"fas fa-chess-board"}),a.jsx("span",{children:e})]}),a.jsx("div",{className:"formation-field-wrapper",children:a.jsxs(n,{style:{width:"100%",height:"auto",maxWidth:"350px",display:"block",margin:"0 auto"},children:[a.jsx("defs",{children:l.map(s=>a.jsx("clipPath",{id:`team-clip-${s.id}`,children:a.jsx("circle",{r:"3.5",cx:"0",cy:"0"})},`clip-${s.id}`))}),l.map(s=>{var e;const l=3+("number"==typeof s.position_x?s.position_x:50)/100*68,i=3+("number"==typeof s.position_y?s.position_y:50)/100*105;return a.jsxs("g",{transform:`translate(${l}, ${i})`,className:"formation-player",children:[a.jsx("circle",{r:"3.5",fill:"#e63946",stroke:"#fff",strokeWidth:"0.6"}),s.player_image?a.jsx("image",{href:s.player_image,x:"-3.5",y:"-3.5",width:"7",height:"7",clipPath:`url(#team-clip-${s.id})`,preserveAspectRatio:"xMidYMid slice"}):a.jsx("text",{x:"0",y:"1.2",textAnchor:"middle",fill:"#fff",fontSize:"2.8",fontWeight:"700",children:s.position||"?"}),a.jsx("text",{x:"0",y:"6.5",textAnchor:"middle",fill:"#fff",fontSize:"2.2",fontWeight:"600",children:(null==(e=s.player_name)?void 0:e.split(" ")[0])||"Player"})]},s.id)})]})})]})}n.displayName="DarkFieldSVG";const o={Goalkeeper:"GOALKEEPERS",Defender:"DEFENDERS",Midfielder:"MIDFIELDERS",Forward:"FORWARDS",Striker:"FORWARDS",Substitute:"SUBSTITUTES"},m={GK:"Goalkeeper",CB:"Defender",LB:"Defender",RB:"Defender",CDM:"Midfielder",CM:"Midfielder",CAM:"Midfielder",LM:"Midfielder",RM:"Midfielder",CF:"Forward",ST:"Forward",SUB:"Substitute"};function h({teamId:s,onBack:i,onNavigateToPlayer:c}){var n;const[h,x]=e.useState(null),[p,j]=e.useState([]),[g,N]=e.useState([]),[u,f]=e.useState([]),[_,v]=e.useState({topScorers:[],topAssists:[]}),[y,w]=e.useState(!0);e.useEffect(()=>{s&&b()},[s]);const b=async()=>{try{const{data:a,error:e}=await l.from("teams").select("*").eq("id",s).single();if(e)throw e;if(x(a),null==a?void 0:a.category){const{data:e}=await l.from("teams").select("id, name, crest_url, played, won, drawn, lost, goals_for, goals_against, points").eq("category",a.category).order("points",{ascending:!1}).order("goals_for",{ascending:!1});if(e){const a=e.map((a,s)=>({...a,position:s+1}));N(a)}const{data:i}=await l.from("matches").select("\n            *,\n            home_team:teams!matches_home_team_id_fkey(id, name, crest_url),\n            away_team:teams!matches_away_team_id_fkey(id, name, crest_url)\n          ").eq("category",a.category).or(`home_team_id.eq.${s},away_team_id.eq.${s}`).order("match_date",{ascending:!0}).order("scheduled_time",{ascending:!0});i&&f(i)}const{data:i}=await l.from("players").select("id, name, player_image, position, position_x, position_y, is_substitute, registration_player_id").eq("team_id",s);if(i){const a=i.map(a=>({...a,player_name:a.name,player_age:null}));j(a);const{data:e}=await l.from("goals").select("\n            scorer_id,\n            assister_id,\n            scorer:team_players!goals_scorer_id_fkey(id, player_name, player_image),\n            assister:team_players!goals_assister_id_fkey(id, player_name, player_image)\n          ").eq("team_id",s),t={},r={};(e||[]).forEach(a=>{a.scorer_id&&a.scorer&&(t[a.scorer_id]||(t[a.scorer_id]={id:a.scorer_id,player_name:a.scorer.player_name,player_image:a.scorer.player_image,goals:0}),t[a.scorer_id].goals+=1),a.assister_id&&a.assister&&(r[a.assister_id]||(r[a.assister_id]={id:a.assister_id,player_name:a.assister.player_name,player_image:a.assister.player_image,assists:0}),r[a.assister_id].assists+=1)});const c=Object.values(t).sort((a,s)=>s.goals-a.goals).slice(0,5),n=Object.values(r).sort((a,s)=>s.assists-a.assists).slice(0,5);v({topScorers:c,topAssists:n})}}catch(a){}finally{w(!1)}},S=a=>m[a]||a||"Unknown";if(y)return a.jsx("div",{className:"team-detail-loading",children:a.jsxs("div",{className:"teams-loading-content",children:[a.jsxs("div",{className:"logo-loader",children:[a.jsx("div",{className:"logo-ring"}),a.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama",className:"logo-pulse"})]}),a.jsx("p",{children:"Loading team..."})]})});if(!h)return a.jsxs("div",{className:"team-detail-error",children:[a.jsx("i",{className:"fas fa-exclamation-triangle"}),a.jsx("p",{children:"Team not found"}),a.jsxs("button",{onClick:i,className:"back-btn",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Teams"]})]});const k=(()=>{const a={};return p.forEach(s=>{const e=S(s.position),l=o[e]||"OTHERS";a[l]||(a[l]=[]),a[l].push(s)}),a})(),M=u.map(a=>((a,s)=>{const e=a.home_team_id===s,l=e?a.away_team:a.home_team,i=e?a.home_score:a.away_score,t=e?a.away_score:a.home_score;let r="scheduled",c="-";"completed"===a.status&&null!==i&&null!==t&&(i>t?(r="win",c=3):i<t?(r="loss",c=0):(r="draw",c=1));const n=a.match_date?new Date(a.match_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}):"TBD";return{...a,isHome:e,opponent:l,goalsFor:i??"-",goalsAgainst:t??"-",result:r,points:c,matchDate:n,score:"completed"===a.status?`${i} - ${t}`:"vs"}})(a,s));return a.jsxs(a.Fragment,{children:[a.jsx(r,{}),a.jsxs("div",{className:"team-detail",children:[a.jsxs("div",{className:"team-hero",children:[a.jsx("div",{className:"team-hero-bg"}),a.jsxs("div",{className:"team-hero-content",children:[a.jsx("div",{className:"team-crest-hero",children:h.crest_url?a.jsx("img",{src:h.crest_url,alt:h.name}):a.jsx("span",{children:(null==(n=h.name)?void 0:n.charAt(0))||"?"})}),a.jsxs("div",{className:"team-info-hero",children:[a.jsx("h1",{className:"team-name-hero",children:h.name}),a.jsxs("div",{className:"team-meta-hero",children:[a.jsx("span",{className:"meta-label",children:"Captain:"}),a.jsx("span",{className:"meta-value",children:h.captain||"TBA"})]}),h.formation&&a.jsxs("div",{className:"team-formation-hero",children:[a.jsx("i",{className:"fas fa-chess-board"}),a.jsx("span",{children:h.formation})]})]})]})]}),a.jsxs("div",{className:"team-detail-body",children:[a.jsxs("div",{className:"team-detail-main",children:[a.jsxs("div",{className:"match-log-section",children:[a.jsx("h3",{className:"section-title-italic",children:"MATCH LOG"}),M.length>0?a.jsxs("div",{className:"match-log-table",children:[a.jsxs("div",{className:"match-log-header",children:[a.jsx("span",{className:"col-mw",children:"#"}),a.jsx("span",{className:"col-date",children:"DATE"}),a.jsx("span",{className:"col-match",children:"MATCH"}),a.jsx("span",{className:"col-score",children:"SCORE"}),a.jsx("span",{className:"col-gf",children:"GF"}),a.jsx("span",{className:"col-ga",children:"GA"}),a.jsx("span",{className:"col-pts",children:"PTS"})]}),M.map((s,e)=>{var l,i,t,r,c,n,d,o;return a.jsxs("div",{className:`match-log-row ${s.result} clickable`,"data-date":s.matchDate,"data-stats":"completed"===s.status?`GF: ${s.goalsFor} | GA: ${s.goalsAgainst} | PTS: ${s.points}`:"Upcoming",onClick:()=>{const a=h.category||"open-age";window.location.href=`/muqawamah/2026/${a}/fixtures/?match=${s.id}`},style:{cursor:"pointer"},children:[a.jsx("span",{className:"col-mw",children:s.match_number||e+1}),a.jsx("span",{className:"col-date",children:s.matchDate}),a.jsxs("span",{className:"col-match match-teams",children:[a.jsxs("div",{className:"match-team home",children:[(null==(l=s.home_team)?void 0:l.crest_url)?a.jsx("img",{src:s.home_team.crest_url,alt:"",className:"match-team-logo"}):a.jsx("div",{className:"match-team-logo match-team-placeholder",children:(null==(t=null==(i=s.home_team)?void 0:i.name)?void 0:t.charAt(0))||"?"}),a.jsx("span",{className:s.isHome?"team-name current":"team-name",children:(null==(r=s.home_team)?void 0:r.name)||"TBD"})]}),a.jsx("span",{className:"vs-separator",children:"completed"===s.status?a.jsxs("span",{className:`mobile-score ${s.result}`,children:[s.home_score," - ",s.away_score]}):a.jsx("span",{className:"scheduled-badge",children:s.scheduled_time||"TBD"})}),a.jsxs("div",{className:"match-team away",children:[(null==(c=s.away_team)?void 0:c.crest_url)?a.jsx("img",{src:s.away_team.crest_url,alt:"",className:"match-team-logo"}):a.jsx("div",{className:"match-team-logo match-team-placeholder",children:(null==(d=null==(n=s.away_team)?void 0:n.name)?void 0:d.charAt(0))||"?"}),a.jsx("span",{className:s.isHome?"team-name":"team-name current",children:(null==(o=s.away_team)?void 0:o.name)||"TBD"})]})]}),a.jsx("span",{className:`col-score match-score ${s.result}`,children:"completed"===s.status?a.jsxs(a.Fragment,{children:[s.home_score," - ",s.away_score]}):a.jsx("span",{className:"scheduled-badge",children:s.scheduled_time||"TBD"})}),a.jsx("span",{className:"col-gf",children:s.goalsFor}),a.jsx("span",{className:"col-ga",children:s.goalsAgainst}),a.jsx("span",{className:`col-pts ${s.result}`,children:s.points})]},s.id||e)})]}):a.jsxs("div",{className:"no-matches",children:[a.jsx("i",{className:"fas fa-calendar-alt"}),a.jsx("p",{children:"No matches scheduled yet"})]})]}),a.jsxs("div",{className:"team-formation-section",children:[a.jsx("h3",{className:"section-title-italic",children:"FORMATION"}),a.jsx(d,{players:p,formation:h.formation})]}),a.jsxs("div",{className:"standings-section",children:[a.jsx("h3",{className:"section-title-italic",children:"STANDINGS"}),a.jsxs("div",{className:"standings-table",children:[a.jsxs("div",{className:"standings-header",children:[a.jsx("span",{className:"col-pos",children:"#"}),a.jsx("span",{className:"col-team",children:"TEAM"}),a.jsx("span",{className:"col-pts",children:"PTS"})]}),g.map(e=>{var l;const i=e.id===s;return a.jsxs("div",{className:"standings-row "+(i?"highlighted":""),children:[a.jsx("span",{className:"col-pos",children:e.position}),a.jsx("span",{className:"col-team",children:a.jsxs("div",{className:"team-cell",children:[a.jsx("div",{className:"team-logo-small",children:e.crest_url?a.jsx("img",{src:e.crest_url,alt:e.name}):a.jsx("span",{children:(null==(l=e.name)?void 0:l.charAt(0))||"?"})}),a.jsx("span",{className:"team-name-standings",children:e.name})]})}),a.jsx("span",{className:"col-pts",children:e.points||0})]},e.id)})]})]})]}),a.jsxs("div",{className:"team-detail-sidebar",children:[a.jsx("h3",{className:"section-title-italic",children:"SQUAD"}),a.jsx("div",{className:"squad-list",children:Object.entries(k).map(([s,e])=>a.jsxs("div",{className:"squad-group",children:[a.jsx("h4",{className:"squad-group-title",children:s}),e.map((s,e)=>a.jsxs("div",{className:"squad-row",onClick:()=>c&&c(s.id,s.player_name),children:[a.jsx("span",{className:"squad-number",children:e+1}),a.jsx("div",{className:"squad-photo",children:s.player_image?a.jsx("img",{src:s.player_image,alt:s.player_name}):a.jsx("i",{className:"fas fa-user"})}),a.jsxs("div",{className:"squad-info",children:[a.jsx("span",{className:"squad-name",children:s.player_name}),a.jsx("span",{className:"squad-position",children:S(s.position)})]})]},s.id))]},s))})]})]}),a.jsxs("div",{className:"leaderboards-section",children:[a.jsx("h2",{className:"leaderboards-title",children:"LEADERBOARDS"}),a.jsxs("div",{className:"leaderboards-grid",children:[a.jsxs("div",{className:"leaderboard-card",children:[a.jsx("h3",{className:"leaderboard-card-title",children:"TOP SCORERS"}),a.jsx("div",{className:"leaderboard-list",children:_.topScorers.length>0?_.topScorers.map((s,e)=>a.jsxs("div",{className:"leaderboard-item",onClick:()=>c&&c(s.id,s.player_name),children:[a.jsx("span",{className:"lb-rank",children:e+1}),a.jsx("div",{className:"lb-player-photo",children:s.player_image?a.jsx("img",{src:s.player_image,alt:s.player_name}):a.jsx("i",{className:"fas fa-user"})}),a.jsx("span",{className:"lb-player-name",children:s.player_name}),a.jsx("span",{className:"lb-stat",children:s.goals||0})]},s.id)):a.jsx("div",{className:"no-stats",children:"No goals scored yet"})}),a.jsxs("button",{className:"view-more-btn",children:["VIEW MORE ",a.jsx("i",{className:"fas fa-arrow-right"})]})]}),a.jsxs("div",{className:"leaderboard-card",children:[a.jsx("h3",{className:"leaderboard-card-title",children:"TOP ASSISTS"}),a.jsx("div",{className:"leaderboard-list",children:_.topAssists.length>0?_.topAssists.map((s,e)=>a.jsxs("div",{className:"leaderboard-item",onClick:()=>c&&c(s.id,s.player_name),children:[a.jsx("span",{className:"lb-rank",children:e+1}),a.jsx("div",{className:"lb-player-photo",children:s.player_image?a.jsx("img",{src:s.player_image,alt:s.player_name}):a.jsx("i",{className:"fas fa-user"})}),a.jsx("span",{className:"lb-player-name",children:s.player_name}),a.jsx("span",{className:"lb-stat",children:s.assists||0})]},s.id)):a.jsx("div",{className:"no-stats",children:"No assists yet"})}),a.jsxs("button",{className:"view-more-btn",children:["VIEW MORE ",a.jsx("i",{className:"fas fa-arrow-right"})]})]})]})]}),a.jsx("div",{className:"team-detail-footer",children:a.jsxs("button",{onClick:i,className:"back-btn",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Teams"]})}),a.jsx(t,{edition:"2026"})]})]})}function x(){const[s,i]=e.useState([]),[n,d]=e.useState(!0),[o,m]=e.useState(null),[x,p]=e.useState("list");e.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("team");return a?(m(a),p("detail"),d(!1)):g(),window.addEventListener("popstate",j),()=>window.removeEventListener("popstate",j)},[]);const j=()=>{const a=new URLSearchParams(window.location.search).get("team");a?(m(a),p("detail")):(p("list"),m(null))},g=async()=>{try{const{data:a,error:s}=await l.from("teams").select("id, name, crest_url, captain, category").eq("category","open-age").order("name",{ascending:!0});if(s)throw s;i(a||[])}catch(a){}finally{d(!1)}},N=()=>{window.history.pushState({},"","/muqawamah/2026/open-age/teams/"),p("list"),m(null)};return n?a.jsx("div",{className:"teams-loading",children:a.jsxs("div",{className:"teams-loading-content",children:[a.jsxs("div",{className:"logo-loader",children:[a.jsx("div",{className:"logo-ring"}),a.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama",className:"logo-pulse"})]}),a.jsx("p",{children:"Loading teams..."})]})}):"detail"===x&&o?a.jsx(h,{teamId:o,onBack:N,onNavigateToPlayer:(a,s)=>{window.location.href=`/muqawamah/2026/open-age/players/?player=${a}`}}):a.jsxs(a.Fragment,{children:[a.jsx(r,{}),a.jsx(c,{teams:s,onTeamClick:a=>{const s=`/muqawamah/2026/open-age/teams/?team=${a.id}`;window.history.pushState({teamId:a.id},"",s),m(a.id),p("detail"),window.scrollTo(0,0)}}),a.jsx(t,{edition:"2026"})]})}i.createRoot(document.getElementById("teams-root")).render(a.jsx(s.StrictMode,{children:a.jsx(x,{})}));
