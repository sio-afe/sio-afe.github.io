import{j as a,R as e,r as s,s as l,c as t}from"./supabaseClient-Bdusv2SU.js";import{F as i}from"./Footer-YZurjJeH.js";import{T as r}from"./TournamentNavbar-D2cgzQdF.js";function c({teams:e=[],onTeamClick:s}){return a.jsxs("div",{className:"team-database",children:[a.jsx("div",{className:"team-database-header",children:a.jsx("h1",{className:"team-database-title",children:"Teams"})}),a.jsx("div",{className:"teams-count",children:a.jsxs("span",{children:[e.length," teams registered"]})}),a.jsx("div",{className:"teams-grid",children:e.map((e,l)=>{var t;const i=["linear-gradient(135deg, rgba(33, 150, 243, 0.15) 0%, rgba(33, 150, 243, 0.02) 100%)","linear-gradient(135deg, rgba(156, 39, 176, 0.15) 0%, rgba(156, 39, 176, 0.02) 100%)","linear-gradient(135deg, rgba(244, 67, 54, 0.15) 0%, rgba(244, 67, 54, 0.02) 100%)","linear-gradient(135deg, rgba(76, 175, 80, 0.15) 0%, rgba(76, 175, 80, 0.02) 100%)","linear-gradient(135deg, rgba(255, 152, 0, 0.15) 0%, rgba(255, 152, 0, 0.02) 100%)","linear-gradient(135deg, rgba(158, 158, 158, 0.15) 0%, rgba(158, 158, 158, 0.02) 100%)"],r=i[l%i.length];return a.jsxs("div",{className:"team-card-db",style:{background:r},onClick:()=>s&&s(e),children:[a.jsx("div",{className:"team-logo-large",children:e.crest_url?a.jsx("img",{src:e.crest_url,alt:e.name}):a.jsx("span",{children:(null==(t=e.name)?void 0:t.charAt(0))||"?"})}),a.jsxs("div",{className:"team-info-db",children:[a.jsx("h3",{className:"team-name-db",children:e.name}),a.jsx("p",{className:"team-captain-db",children:e.captain})]})]},e.id)})}),0===e.length&&a.jsxs("div",{className:"no-teams",children:[a.jsx("i",{className:"fas fa-shield-alt"}),a.jsx("p",{children:"No teams registered yet"})]}),a.jsx("div",{className:"back-to-tournament",children:a.jsxs("a",{href:"/muqawamah/2026/",className:"back-link",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Tournament"]})})]})}const n=e.forwardRef(({children:e,className:s="",...l},t)=>a.jsxs("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 74 111",className:`dark-field-svg ${s}`,...l,children:[a.jsx("rect",{width:"74",height:"111",fill:"#0d1117"}),a.jsxs("g",{fill:"none",stroke:"rgba(255,255,255,0.4)",strokeWidth:"0.5",transform:"translate(3 3)",children:[a.jsx("path",{d:"M 0 0 h 68 v 105 h -68 Z"}),a.jsx("path",{d:"M 0 52.5 h 68"}),a.jsx("circle",{r:"9.15",cx:"34",cy:"52.5"}),a.jsx("circle",{r:"0.75",cx:"34",cy:"52.5",fill:"rgba(255,255,255,0.4)",stroke:"none"}),a.jsxs("g",{children:[a.jsx("path",{d:"M 13.84 0 v 16.5 h 40.32 v -16.5"}),a.jsx("path",{d:"M 24.84 0 v 5.5 h 18.32 v -5.5"}),a.jsx("circle",{r:"0.75",cx:"34",cy:"10.94",fill:"rgba(255,255,255,0.4)",stroke:"none"}),a.jsx("path",{d:"M 26.733027 16.5 a 9.15 9.15 0 0 0 14.533946 0"})]}),a.jsxs("g",{transform:"rotate(180,34,52.5)",children:[a.jsx("path",{d:"M 13.84 0 v 16.5 h 40.32 v -16.5"}),a.jsx("path",{d:"M 24.84 0 v 5.5 h 18.32 v -5.5"}),a.jsx("circle",{r:"0.75",cx:"34",cy:"10.94",fill:"rgba(255,255,255,0.4)",stroke:"none"}),a.jsx("path",{d:"M 26.733027 16.5 a 9.15 9.15 0 0 0 14.533946 0"})]}),a.jsx("path",{d:"M 0 2 a 2 2 0 0 0 2 -2M 66 0 a 2 2 0 0 0 2 2M 68 103 a 2 2 0 0 0 -2 2M 2 105 a 2 2 0 0 0 -2 -2"})]}),e]}));function d({players:e=[],formation:s=""}){const l=e.filter(a=>!a.isSubstitute&&"SUB"!==a.position).slice(0,7);return 0===l.length?a.jsx("div",{className:"team-formation-display",children:a.jsxs("div",{className:"no-formation",children:[a.jsx("i",{className:"fas fa-users-slash"}),a.jsx("p",{children:"Formation not set"})]})}):a.jsxs("div",{className:"team-formation-display",children:[s&&a.jsxs("div",{className:"formation-label",children:[a.jsx("i",{className:"fas fa-chess-board"}),a.jsx("span",{children:s})]}),a.jsx("div",{className:"formation-field-wrapper",children:a.jsxs(n,{style:{width:"100%",height:"auto",maxWidth:"350px",display:"block",margin:"0 auto"},children:[a.jsx("defs",{children:l.map(e=>a.jsx("clipPath",{id:`team-clip-${e.id}`,children:a.jsx("circle",{r:"3.5",cx:"0",cy:"0"})},`clip-${e.id}`))}),l.map(e=>{var s;const l=3+("number"==typeof e.position_x?e.position_x:50)/100*68,t=3+("number"==typeof e.position_y?e.position_y:50)/100*105;return a.jsxs("g",{transform:`translate(${l}, ${t})`,className:"formation-player",children:[a.jsx("circle",{r:"3.5",fill:"#e63946",stroke:"#fff",strokeWidth:"0.6"}),e.player_image?a.jsx("image",{href:e.player_image,x:"-3.5",y:"-3.5",width:"7",height:"7",clipPath:`url(#team-clip-${e.id})`,preserveAspectRatio:"xMidYMid slice"}):a.jsx("text",{x:"0",y:"1.2",textAnchor:"middle",fill:"#fff",fontSize:"2.8",fontWeight:"700",children:e.position||"?"}),a.jsx("text",{x:"0",y:"6.5",textAnchor:"middle",fill:"#fff",fontSize:"2.2",fontWeight:"600",children:(null==(s=e.player_name)?void 0:s.split(" ")[0])||"Player"})]},e.id)})]})})]})}n.displayName="DarkFieldSVG";const o={Goalkeeper:"GOALKEEPERS",Defender:"DEFENDERS",Midfielder:"MIDFIELDERS",Forward:"FORWARDS",Striker:"FORWARDS",Substitute:"SUBSTITUTES"},m={GK:"Goalkeeper",CB:"Defender",LB:"Defender",RB:"Defender",CDM:"Midfielder",CM:"Midfielder",CAM:"Midfielder",LM:"Midfielder",RM:"Midfielder",CF:"Forward",ST:"Forward",SUB:"Substitute"};function h({teamId:e,onBack:t,onNavigateToPlayer:c}){var n;const[h,x]=s.useState(null),[j,p]=s.useState([]),[g,N]=s.useState([]),[u,f]=s.useState([]),[v,y]=s.useState({topScorers:[],topAssists:[]}),[_,w]=s.useState(!0);s.useEffect(()=>{e&&b()},[e]);const b=async()=>{try{const{data:a,error:s}=await l.from("teams").select("*").eq("id",e).single();if(s)throw s;if(x(a),null==a?void 0:a.category){const{data:s}=await l.from("teams").select("id, name, crest_url, played, won, drawn, lost, goals_for, goals_against, points").eq("category",a.category).order("points",{ascending:!1}).order("goals_for",{ascending:!1});if(s){const a=s.map((a,e)=>({...a,position:e+1}));N(a)}const{data:t}=await l.from("matches").select("\n            *,\n            home_team:teams!matches_home_team_id_fkey(id, name, crest_url),\n            away_team:teams!matches_away_team_id_fkey(id, name, crest_url)\n          ").eq("category",a.category).or(`home_team_id.eq.${e},away_team_id.eq.${e}`).order("match_date",{ascending:!0}).order("scheduled_time",{ascending:!0});t&&f(t)}if(null==a?void 0:a.registration_id){const{data:e}=await l.from("team_players").select("id, player_name, player_image, position, player_age, position_x, position_y, is_substitute").eq("team_id",a.registration_id);e&&(p(e),y({topScorers:[],topAssists:[]}))}}catch(a){}finally{w(!1)}},S=a=>m[a]||a||"Unknown";if(_)return a.jsx("div",{className:"team-detail-loading",children:a.jsxs("div",{className:"teams-loading-content",children:[a.jsxs("div",{className:"logo-loader",children:[a.jsx("div",{className:"logo-ring"}),a.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama",className:"logo-pulse"})]}),a.jsx("p",{children:"Loading team..."})]})});if(!h)return a.jsxs("div",{className:"team-detail-error",children:[a.jsx("i",{className:"fas fa-exclamation-triangle"}),a.jsx("p",{children:"Team not found"}),a.jsxs("button",{onClick:t,className:"back-btn",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Teams"]})]});const k=(()=>{const a={};return j.forEach(e=>{const s=S(e.position),l=o[s]||"OTHERS";a[l]||(a[l]=[]),a[l].push(e)}),a})(),M=u.map(a=>((a,e)=>{const s=a.home_team_id===e,l=s?a.away_team:a.home_team,t=s?a.home_score:a.away_score,i=s?a.away_score:a.home_score;let r="scheduled",c="-";"completed"===a.status&&null!==t&&null!==i&&(t>i?(r="win",c=3):t<i?(r="loss",c=0):(r="draw",c=1));const n=a.match_date?new Date(a.match_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}):"TBD";return{...a,isHome:s,opponent:l,goalsFor:t??"-",goalsAgainst:i??"-",result:r,points:c,matchDate:n,score:"completed"===a.status?`${t} - ${i}`:"vs"}})(a,e));return a.jsxs(a.Fragment,{children:[a.jsx(r,{}),a.jsxs("div",{className:"team-detail",children:[a.jsxs("div",{className:"team-hero",children:[a.jsx("div",{className:"team-hero-bg"}),a.jsxs("div",{className:"team-hero-content",children:[a.jsx("div",{className:"team-crest-hero",children:h.crest_url?a.jsx("img",{src:h.crest_url,alt:h.name}):a.jsx("span",{children:(null==(n=h.name)?void 0:n.charAt(0))||"?"})}),a.jsxs("div",{className:"team-info-hero",children:[a.jsx("h1",{className:"team-name-hero",children:h.name}),a.jsxs("div",{className:"team-meta-hero",children:[a.jsx("span",{className:"meta-label",children:"Captain:"}),a.jsx("span",{className:"meta-value",children:h.captain||"TBA"})]}),h.formation&&a.jsxs("div",{className:"team-formation-hero",children:[a.jsx("i",{className:"fas fa-chess-board"}),a.jsx("span",{children:h.formation})]})]})]})]}),a.jsxs("div",{className:"team-detail-body",children:[a.jsxs("div",{className:"team-detail-main",children:[a.jsxs("div",{className:"match-log-section",children:[a.jsx("h3",{className:"section-title-italic",children:"MATCH LOG"}),M.length>0?a.jsxs("div",{className:"match-log-table",children:[a.jsxs("div",{className:"match-log-header",children:[a.jsx("span",{className:"col-mw",children:"#"}),a.jsx("span",{className:"col-date",children:"DATE"}),a.jsx("span",{className:"col-match",children:"MATCH"}),a.jsx("span",{className:"col-score",children:"SCORE"}),a.jsx("span",{className:"col-gf",children:"GF"}),a.jsx("span",{className:"col-ga",children:"GA"}),a.jsx("span",{className:"col-pts",children:"PTS"})]}),M.map((e,s)=>{var l,t,i,r,c,n,d,o;return a.jsxs("div",{className:`match-log-row ${e.result} clickable`,"data-date":e.matchDate,"data-stats":"completed"===e.status?`GF: ${e.goalsFor} | GA: ${e.goalsAgainst} | PTS: ${e.points}`:"Upcoming",onClick:()=>{const a=h.category||"open-age";window.location.href=`/muqawamah/2026/${a}/fixtures/?match=${e.id}`},style:{cursor:"pointer"},children:[a.jsx("span",{className:"col-mw",children:e.match_number||s+1}),a.jsx("span",{className:"col-date",children:e.matchDate}),a.jsxs("span",{className:"col-match match-teams",children:[a.jsxs("div",{className:"match-team home",children:[(null==(l=e.home_team)?void 0:l.crest_url)?a.jsx("img",{src:e.home_team.crest_url,alt:"",className:"match-team-logo"}):a.jsx("div",{className:"match-team-logo match-team-placeholder",children:(null==(i=null==(t=e.home_team)?void 0:t.name)?void 0:i.charAt(0))||"?"}),a.jsx("span",{className:e.isHome?"team-name current":"team-name",children:(null==(r=e.home_team)?void 0:r.name)||"TBD"})]}),a.jsx("span",{className:"vs-separator",children:"completed"===e.status?a.jsxs("span",{className:`mobile-score ${e.result}`,children:[e.home_score," - ",e.away_score]}):a.jsx("span",{className:"scheduled-badge",children:e.scheduled_time||"TBD"})}),a.jsxs("div",{className:"match-team away",children:[(null==(c=e.away_team)?void 0:c.crest_url)?a.jsx("img",{src:e.away_team.crest_url,alt:"",className:"match-team-logo"}):a.jsx("div",{className:"match-team-logo match-team-placeholder",children:(null==(d=null==(n=e.away_team)?void 0:n.name)?void 0:d.charAt(0))||"?"}),a.jsx("span",{className:e.isHome?"team-name":"team-name current",children:(null==(o=e.away_team)?void 0:o.name)||"TBD"})]})]}),a.jsx("span",{className:`col-score match-score ${e.result}`,children:"completed"===e.status?a.jsxs(a.Fragment,{children:[e.home_score," - ",e.away_score]}):a.jsx("span",{className:"scheduled-badge",children:e.scheduled_time||"TBD"})}),a.jsx("span",{className:"col-gf",children:e.goalsFor}),a.jsx("span",{className:"col-ga",children:e.goalsAgainst}),a.jsx("span",{className:`col-pts ${e.result}`,children:e.points})]},e.id||s)})]}):a.jsxs("div",{className:"no-matches",children:[a.jsx("i",{className:"fas fa-calendar-alt"}),a.jsx("p",{children:"No matches scheduled yet"})]})]}),a.jsxs("div",{className:"team-formation-section",children:[a.jsx("h3",{className:"section-title-italic",children:"FORMATION"}),a.jsx(d,{players:j,formation:h.formation})]}),a.jsxs("div",{className:"standings-section",children:[a.jsx("h3",{className:"section-title-italic",children:"STANDINGS"}),a.jsxs("div",{className:"standings-table",children:[a.jsxs("div",{className:"standings-header",children:[a.jsx("span",{className:"col-pos",children:"#"}),a.jsx("span",{className:"col-team",children:"TEAM"}),a.jsx("span",{className:"col-pts",children:"PTS"})]}),g.map(s=>{var l;const t=s.id===e;return a.jsxs("div",{className:"standings-row "+(t?"highlighted":""),children:[a.jsx("span",{className:"col-pos",children:s.position}),a.jsx("span",{className:"col-team",children:a.jsxs("div",{className:"team-cell",children:[a.jsx("div",{className:"team-logo-small",children:s.crest_url?a.jsx("img",{src:s.crest_url,alt:s.name}):a.jsx("span",{children:(null==(l=s.name)?void 0:l.charAt(0))||"?"})}),a.jsx("span",{className:"team-name-standings",children:s.name})]})}),a.jsx("span",{className:"col-pts",children:s.points||0})]},s.id)})]})]})]}),a.jsxs("div",{className:"team-detail-sidebar",children:[a.jsx("h3",{className:"section-title",children:"SQUAD"}),a.jsx("div",{className:"squad-list",children:Object.entries(k).map(([e,s])=>a.jsxs("div",{className:"squad-group",children:[a.jsx("h4",{className:"squad-group-title",children:e}),s.map((e,s)=>a.jsxs("div",{className:"squad-row",onClick:()=>c&&c(e.id,e.player_name),children:[a.jsx("span",{className:"squad-number",children:s+1}),a.jsx("div",{className:"squad-photo",children:e.player_image?a.jsx("img",{src:e.player_image,alt:e.player_name}):a.jsx("i",{className:"fas fa-user"})}),a.jsxs("div",{className:"squad-info",children:[a.jsx("span",{className:"squad-name",children:e.player_name}),a.jsx("span",{className:"squad-position",children:S(e.position)})]})]},e.id))]},e))})]})]}),a.jsxs("div",{className:"leaderboards-section",children:[a.jsx("h2",{className:"leaderboards-title",children:"LEADERBOARDS"}),a.jsxs("div",{className:"leaderboards-grid",children:[a.jsxs("div",{className:"leaderboard-card",children:[a.jsx("h3",{className:"leaderboard-card-title",children:"TOP SCORERS"}),a.jsx("div",{className:"leaderboard-list",children:v.topScorers.length>0?v.topScorers.map((e,s)=>a.jsxs("div",{className:"leaderboard-item",onClick:()=>c&&c(e.id,e.player_name),children:[a.jsx("span",{className:"lb-rank",children:s+1}),a.jsx("div",{className:"lb-player-photo",children:e.player_image?a.jsx("img",{src:e.player_image,alt:e.player_name}):a.jsx("i",{className:"fas fa-user"})}),a.jsx("span",{className:"lb-player-name",children:e.player_name}),a.jsx("span",{className:"lb-stat",children:e.goals||0})]},e.id)):a.jsx("div",{className:"no-stats",children:"No goals scored yet"})}),a.jsxs("button",{className:"view-more-btn",children:["VIEW MORE ",a.jsx("i",{className:"fas fa-arrow-right"})]})]}),a.jsxs("div",{className:"leaderboard-card",children:[a.jsx("h3",{className:"leaderboard-card-title",children:"TOP ASSISTS"}),a.jsx("div",{className:"leaderboard-list",children:v.topAssists.length>0?v.topAssists.map((e,s)=>a.jsxs("div",{className:"leaderboard-item",onClick:()=>c&&c(e.id,e.player_name),children:[a.jsx("span",{className:"lb-rank",children:s+1}),a.jsx("div",{className:"lb-player-photo",children:e.player_image?a.jsx("img",{src:e.player_image,alt:e.player_name}):a.jsx("i",{className:"fas fa-user"})}),a.jsx("span",{className:"lb-player-name",children:e.player_name}),a.jsx("span",{className:"lb-stat",children:e.assists||0})]},e.id)):a.jsx("div",{className:"no-stats",children:"No assists yet"})}),a.jsxs("button",{className:"view-more-btn",children:["VIEW MORE ",a.jsx("i",{className:"fas fa-arrow-right"})]})]})]})]}),a.jsx("div",{className:"team-detail-footer",children:a.jsxs("button",{onClick:t,className:"back-btn",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Teams"]})}),a.jsx(i,{edition:"2026"})]})]})}function x(){const[e,t]=s.useState([]),[n,d]=s.useState(!0),[o,m]=s.useState(null),[x,j]=s.useState("list");s.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("team");return a?(m(a),j("detail"),d(!1)):g(),window.addEventListener("popstate",p),()=>window.removeEventListener("popstate",p)},[]);const p=()=>{const a=new URLSearchParams(window.location.search).get("team");a?(m(a),j("detail")):(j("list"),m(null))},g=async()=>{try{const{data:a,error:e}=await l.from("teams").select("id, name, crest_url, captain, category").eq("category","open-age").order("name",{ascending:!0});if(e)throw e;t(a||[])}catch(a){}finally{d(!1)}},N=()=>{window.history.pushState({},"","/muqawamah/2026/open-age/teams/"),j("list"),m(null)};return n?a.jsx("div",{className:"teams-loading",children:a.jsxs("div",{className:"teams-loading-content",children:[a.jsxs("div",{className:"logo-loader",children:[a.jsx("div",{className:"logo-ring"}),a.jsx("img",{src:"/assets/img/MuqawamaLogo.png",alt:"Muqawama",className:"logo-pulse"})]}),a.jsx("p",{children:"Loading teams..."})]})}):"detail"===x&&o?a.jsx(h,{teamId:o,onBack:N,onNavigateToPlayer:(a,e)=>{window.location.href=`/muqawamah/2026/open-age/players/?player=${a}`}}):a.jsxs(a.Fragment,{children:[a.jsx(r,{}),a.jsx(c,{teams:e,onTeamClick:a=>{const e=`/muqawamah/2026/open-age/teams/?team=${a.id}`;window.history.pushState({teamId:a.id},"",e),m(a.id),j("detail"),window.scrollTo(0,0)}}),a.jsx(i,{edition:"2026"})]})}t.createRoot(document.getElementById("teams-root")).render(a.jsx(e.StrictMode,{children:a.jsx(x,{})}));
