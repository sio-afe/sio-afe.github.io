import{j as a,r as s}from"./supabaseClient-y7L7r4ir.js";import{t as e}from"./index-cwrHH8V6.js";const n=a=>{const s=a.split(","),e=s[0].match(/:(.*?);/)[1],n=atob(s[1]);let l=n.length;const t=new Uint8Array(l);for(;l--;)t[l]=n.charCodeAt(l);return new Blob([t],{type:e})};function l({match:l,onClose:t}){var r,c,i,o,d,m,h,p;const u=s.useRef(null),[x,j]=s.useState(!1),[g,N]=s.useState(!1),[v,w]=s.useState(null),b=a=>{if(!a)return"TBD";return new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}).toUpperCase()},f=()=>{var a;const s=null==(a=l.match_type)?void 0:a.toLowerCase();return s&&"group"!==s?"quarter-final"===s?"QUARTER FINAL":"semi-final"===s?"SEMI FINAL":"final"===s?"FINAL":"third-place"===s?"3RD PLACE":s.toUpperCase():"GROUP STAGE"},y="completed"===l.status,_="live"===l.status,C=async()=>{if(!u.current)return null;j(!0);try{const a=await e(u.current,{quality:1,pixelRatio:3,backgroundColor:"#0a0e1a"}),s=n(a);return w(s),N(!0),{dataUrl:a,blob:s}}catch(a){return null}finally{j(!1)}},k=async()=>{var a,s;const e=await C();if(e){const n=document.createElement("a");n.download=`match-${null==(a=l.home_team)?void 0:a.name}-vs-${null==(s=l.away_team)?void 0:s.name}.png`,n.href=e.dataUrl,n.click()}};return a.jsx("div",{className:"share-modal-overlay",onClick:t,children:a.jsxs("div",{className:"share-modal-content",onClick:a=>a.stopPropagation(),children:[a.jsx("button",{className:"share-modal-close",onClick:t,children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("div",{className:"shareable-card-wrapper",children:a.jsxs("div",{ref:u,className:"shareable-card match-card",children:[a.jsxs("div",{className:"card-bg-effects",children:[a.jsx("div",{className:"card-glow glow-1"}),a.jsx("div",{className:"card-glow glow-2"})]}),a.jsxs("div",{className:"card-header",children:[a.jsx("img",{src:"/assets/img/muq_invert.png",alt:"Muqawamah",className:"card-tournament-logo",crossOrigin:"anonymous"}),a.jsx("span",{className:"card-match-type",children:f()})]}),a.jsxs("div",{className:"card-match-content",children:[a.jsxs("div",{className:"card-team home",children:[a.jsx("div",{className:"card-team-logo",children:(null==(r=l.home_team)?void 0:r.crest_url)?a.jsx("img",{src:l.home_team.crest_url,alt:l.home_team.name,crossOrigin:"anonymous"}):a.jsx("span",{className:"logo-placeholder",children:null==(i=null==(c=l.home_team)?void 0:c.name)?void 0:i.charAt(0)})}),a.jsx("span",{className:"card-team-name",children:null==(o=l.home_team)?void 0:o.name})]}),a.jsx("div",{className:"card-score-horizontal",children:y||_?a.jsxs("div",{className:"score-row",children:[a.jsx("span",{className:"score-number",children:l.home_score??0}),a.jsx("span",{className:"score-divider",children:"-"}),a.jsx("span",{className:"score-number",children:l.away_score??0})]}):a.jsx("span",{className:"score-vs",children:"VS"})}),a.jsxs("div",{className:"card-team away",children:[a.jsx("div",{className:"card-team-logo",children:(null==(d=l.away_team)?void 0:d.crest_url)?a.jsx("img",{src:l.away_team.crest_url,alt:l.away_team.name,crossOrigin:"anonymous"}):a.jsx("span",{className:"logo-placeholder",children:null==(h=null==(m=l.away_team)?void 0:m.name)?void 0:h.charAt(0)})}),a.jsx("span",{className:"card-team-name",children:null==(p=l.away_team)?void 0:p.name})]})]}),a.jsxs("div",{className:"card-status-section",children:[a.jsx("span",{className:`card-status ${l.status}`,children:y?"FULL TIME":_?"LIVE":"UPCOMING"}),a.jsx("span",{className:"card-date-inline",children:b(l.match_date)})]}),a.jsxs("div",{className:"card-footer",children:[a.jsx("img",{src:"/assets/img/title_invert.png",alt:"SIO x AFE",className:"card-branding-logo",crossOrigin:"anonymous"}),a.jsx("span",{className:"card-instagram",children:"@muqawamah2026"})]})]})}),a.jsxs("div",{className:"share-buttons",children:[a.jsx("h3",{children:"Share to"}),a.jsxs("div",{className:"share-btn-grid",children:[a.jsxs("button",{className:"share-btn whatsapp",onClick:async()=>{var a,s;const e=await C();if(!e)return;const n=`âš½ ${null==(a=l.home_team)?void 0:a.name} ${y?l.home_score:""} vs ${y?l.away_score:""} ${null==(s=l.away_team)?void 0:s.name}\nðŸ† Muqawamah 2026 - ${f()}\nðŸ“… ${b(l.match_date)}`;if(navigator.share&&navigator.canShare({files:[new File([e.blob],"match.png",{type:"image/png"})]}))try{return void(await navigator.share({title:"Match Result",text:n,files:[new File([e.blob],"match.png",{type:"image/png"})]}))}catch(r){}const t=`https://wa.me/?text=${encodeURIComponent(n)}`;window.open(t,"_blank"),k()},disabled:x,children:[a.jsx("i",{className:"fab fa-whatsapp"}),a.jsx("span",{children:"WhatsApp"})]}),a.jsxs("button",{className:"share-btn instagram",onClick:async()=>{const a=await C();if(!a)return;const s=document.createElement("a");s.download=`muqawamah-match-${Date.now()}.png`,s.href=a.dataUrl,s.click(),alert("Image downloaded! Open Instagram and share it to your Story or Feed.")},disabled:x,children:[a.jsx("i",{className:"fab fa-instagram"}),a.jsx("span",{children:"Instagram"})]}),a.jsxs("button",{className:"share-btn copy",onClick:async()=>{const a=await C();if(a)try{await navigator.clipboard.write([new ClipboardItem({"image/png":a.blob})]),alert("Image copied to clipboard!")}catch(s){k()}},disabled:x,children:[a.jsx("i",{className:"fas fa-copy"}),a.jsx("span",{children:"Copy"})]}),a.jsxs("button",{className:"share-btn download",onClick:k,disabled:x,children:[a.jsx("i",{className:"fas fa-download"}),a.jsx("span",{children:"Download"})]})]}),x&&a.jsxs("div",{className:"generating-indicator",children:[a.jsx("i",{className:"fas fa-spinner fa-spin"}),a.jsx("span",{children:"Generating image..."})]})]})]})})}function t({team:l,stats:t,onClose:r}){var c;const i=s.useRef(null),[o,d]=s.useState(!1),m=async()=>{if(!i.current)return null;d(!0);try{const a=await e(i.current,{quality:1,pixelRatio:3,backgroundColor:"#0a0e1a"});return{dataUrl:a,blob:n(a)}}catch(a){return null}finally{d(!1)}},h=async()=>{const a=await m();if(a){const s=document.createElement("a");s.download=`team-${l.name}.png`,s.href=a.dataUrl,s.click()}};return a.jsx("div",{className:"share-modal-overlay",onClick:r,children:a.jsxs("div",{className:"share-modal-content",onClick:a=>a.stopPropagation(),children:[a.jsx("button",{className:"share-modal-close",onClick:r,children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("div",{className:"shareable-card-wrapper",children:a.jsxs("div",{ref:i,className:"shareable-card team-card",children:[a.jsx("div",{className:"card-bg-effects",children:a.jsx("div",{className:"card-glow glow-team",style:{background:l.primary_color||"#4f8cff"}})}),a.jsx("div",{className:"card-header",children:a.jsx("img",{src:"/assets/img/muq_invert.png",alt:"Muqawamah",className:"card-tournament-logo",crossOrigin:"anonymous"})}),a.jsxs("div",{className:"card-team-content",children:[a.jsx("div",{className:"card-team-logo large",children:l.crest_url?a.jsx("img",{src:l.crest_url,alt:l.name,crossOrigin:"anonymous"}):a.jsx("span",{className:"logo-placeholder",children:null==(c=l.name)?void 0:c.charAt(0)})}),a.jsx("h2",{className:"card-team-title",children:l.name}),l.captain&&a.jsxs("p",{className:"card-team-captain",children:["Captain: ",l.captain]})]}),t&&a.jsxs("div",{className:"card-team-stats",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:t.played||0}),a.jsx("span",{className:"stat-label",children:"Played"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:t.won||0}),a.jsx("span",{className:"stat-label",children:"Won"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:t.drawn||0}),a.jsx("span",{className:"stat-label",children:"Draw"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:t.lost||0}),a.jsx("span",{className:"stat-label",children:"Lost"})]}),a.jsxs("div",{className:"stat-item highlight",children:[a.jsx("span",{className:"stat-value",children:t.points||0}),a.jsx("span",{className:"stat-label",children:"Points"})]})]}),a.jsxs("div",{className:"card-footer",children:[a.jsx("img",{src:"/assets/img/title_invert.png",alt:"SIO x AFE",className:"card-branding-logo",crossOrigin:"anonymous"}),a.jsx("span",{className:"card-instagram",children:"@muqawamah2026"})]})]})}),a.jsxs("div",{className:"share-buttons",children:[a.jsx("h3",{children:"Share to"}),a.jsxs("div",{className:"share-btn-grid",children:[a.jsxs("button",{className:"share-btn whatsapp",onClick:async()=>{const a=await m();if(!a)return;const s=`ðŸ† ${l.name}\nâš½ Muqawamah 2026\nðŸ“Š ${(null==t?void 0:t.played)||0}P | ${(null==t?void 0:t.won)||0}W | ${(null==t?void 0:t.drawn)||0}D | ${(null==t?void 0:t.lost)||0}L\nðŸŽ¯ ${(null==t?void 0:t.points)||0} Points`;if(navigator.share&&navigator.canShare({files:[new File([a.blob],"team.png",{type:"image/png"})]}))try{return void(await navigator.share({title:l.name,text:s,files:[new File([a.blob],"team.png",{type:"image/png"})]}))}catch(n){}const e=`https://wa.me/?text=${encodeURIComponent(s)}`;window.open(e,"_blank"),h()},disabled:o,children:[a.jsx("i",{className:"fab fa-whatsapp"}),a.jsx("span",{children:"WhatsApp"})]}),a.jsxs("button",{className:"share-btn instagram",onClick:async()=>{const a=await m();if(!a)return;const s=document.createElement("a");s.download=`muqawamah-team-${Date.now()}.png`,s.href=a.dataUrl,s.click(),alert("Image downloaded! Open Instagram and share it to your Story or Feed.")},disabled:o,children:[a.jsx("i",{className:"fab fa-instagram"}),a.jsx("span",{children:"Instagram"})]}),a.jsxs("button",{className:"share-btn download",onClick:h,disabled:o,children:[a.jsx("i",{className:"fas fa-download"}),a.jsx("span",{children:"Download"})]})]}),o&&a.jsxs("div",{className:"generating-indicator",children:[a.jsx("i",{className:"fas fa-spinner fa-spin"}),a.jsx("span",{children:"Generating image..."})]})]})]})})}function r({onClick:s,className:e=""}){return a.jsxs("button",{className:`share-trigger-btn ${e}`,onClick:s,title:"Share",children:[a.jsx("i",{className:"fas fa-share-alt"}),a.jsx("span",{children:"Share"})]})}export{l as M,r as S,t as T};
