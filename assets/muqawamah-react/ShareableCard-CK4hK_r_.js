import{j as a,r as s}from"./supabaseClient-y7L7r4ir.js";import{t as e}from"./index-cwrHH8V6.js";function n({match:n,onClose:l}){var c,t,r,i,d,o,m,h;const p=s.useRef(null),[x,j]=s.useState(!1),[u,N]=s.useState(!1),[v,g]=s.useState(null),b=a=>{if(!a)return"TBD";return new Date(a).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}).toUpperCase()},w=()=>{var a;const s=null==(a=n.match_type)?void 0:a.toLowerCase();return s&&"group"!==s?"quarter-final"===s?"QUARTER FINAL":"semi-final"===s?"SEMI FINAL":"final"===s?"FINAL":"third-place"===s?"3RD PLACE":s.toUpperCase():"GROUP STAGE"},f="completed"===n.status,y="live"===n.status,_=async()=>{if(!p.current)return null;j(!0);try{const a=await e(p.current,{quality:1,pixelRatio:3,backgroundColor:"#0a0e1a"}),s=await fetch(a),n=await s.blob();return g(n),N(!0),{dataUrl:a,blob:n}}catch(a){return null}finally{j(!1)}},C=async()=>{var a,s;const e=await _();if(e){const l=document.createElement("a");l.download=`match-${null==(a=n.home_team)?void 0:a.name}-vs-${null==(s=n.away_team)?void 0:s.name}.png`,l.href=e.dataUrl,l.click()}};return a.jsx("div",{className:"share-modal-overlay",onClick:l,children:a.jsxs("div",{className:"share-modal-content",onClick:a=>a.stopPropagation(),children:[a.jsx("button",{className:"share-modal-close",onClick:l,children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("div",{className:"shareable-card-wrapper",children:a.jsxs("div",{ref:p,className:"shareable-card match-card",children:[a.jsxs("div",{className:"card-bg-effects",children:[a.jsx("div",{className:"card-glow glow-1"}),a.jsx("div",{className:"card-glow glow-2"}),a.jsx("div",{className:"card-noise"})]}),a.jsxs("div",{className:"card-header",children:[a.jsx("span",{className:"card-tournament",children:"MUQAWAMAH 2026"}),a.jsx("span",{className:"card-match-type",children:w()})]}),a.jsxs("div",{className:"card-match-content",children:[a.jsxs("div",{className:"card-team home",children:[a.jsx("div",{className:"card-team-logo",children:(null==(c=n.home_team)?void 0:c.crest_url)?a.jsx("img",{src:n.home_team.crest_url,alt:n.home_team.name}):a.jsx("span",{className:"logo-placeholder",children:null==(r=null==(t=n.home_team)?void 0:t.name)?void 0:r.charAt(0)})}),a.jsx("span",{className:"card-team-name",children:null==(i=n.home_team)?void 0:i.name})]}),a.jsxs("div",{className:"card-score",children:[f||y?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"score-number",children:n.home_score??0}),a.jsx("span",{className:"score-divider",children:"-"}),a.jsx("span",{className:"score-number",children:n.away_score??0})]}):a.jsx("span",{className:"score-vs",children:"VS"}),a.jsx("span",{className:`card-status ${n.status}`,children:f?"FULL TIME":y?"LIVE":b(n.match_date)})]}),a.jsxs("div",{className:"card-team away",children:[a.jsx("div",{className:"card-team-logo",children:(null==(d=n.away_team)?void 0:d.crest_url)?a.jsx("img",{src:n.away_team.crest_url,alt:n.away_team.name}):a.jsx("span",{className:"logo-placeholder",children:null==(m=null==(o=n.away_team)?void 0:o.name)?void 0:m.charAt(0)})}),a.jsx("span",{className:"card-team-name",children:null==(h=n.away_team)?void 0:h.name})]})]}),a.jsxs("div",{className:"card-footer",children:[a.jsxs("div",{className:"card-branding",children:[a.jsx("span",{className:"sio-logo",children:"SIO"}),a.jsx("span",{className:"card-divider",children:"Ã—"}),a.jsx("span",{className:"afe-logo",children:"AFE"})]}),a.jsx("span",{className:"card-date",children:b(n.match_date)})]})]})}),a.jsxs("div",{className:"share-buttons",children:[a.jsx("h3",{children:"Share to"}),a.jsxs("div",{className:"share-btn-grid",children:[a.jsxs("button",{className:"share-btn whatsapp",onClick:async()=>{var a,s;const e=await _();if(!e)return;const l=`âš½ ${null==(a=n.home_team)?void 0:a.name} ${f?n.home_score:""} vs ${f?n.away_score:""} ${null==(s=n.away_team)?void 0:s.name}\nðŸ† Muqawamah 2026 - ${w()}\nðŸ“… ${b(n.match_date)}`;if(navigator.share&&navigator.canShare({files:[new File([e.blob],"match.png",{type:"image/png"})]}))try{return void(await navigator.share({title:"Match Result",text:l,files:[new File([e.blob],"match.png",{type:"image/png"})]}))}catch(t){}const c=`https://wa.me/?text=${encodeURIComponent(l)}`;window.open(c,"_blank"),C()},disabled:x,children:[a.jsx("i",{className:"fab fa-whatsapp"}),a.jsx("span",{children:"WhatsApp"})]}),a.jsxs("button",{className:"share-btn instagram",onClick:async()=>{const a=await _();if(!a)return;const s=document.createElement("a");s.download=`muqawamah-match-${Date.now()}.png`,s.href=a.dataUrl,s.click(),alert("Image downloaded! Open Instagram and share it to your Story or Feed.")},disabled:x,children:[a.jsx("i",{className:"fab fa-instagram"}),a.jsx("span",{children:"Instagram"})]}),a.jsxs("button",{className:"share-btn copy",onClick:async()=>{const a=await _();if(a)try{await navigator.clipboard.write([new ClipboardItem({"image/png":a.blob})]),alert("Image copied to clipboard!")}catch(s){C()}},disabled:x,children:[a.jsx("i",{className:"fas fa-copy"}),a.jsx("span",{children:"Copy"})]}),a.jsxs("button",{className:"share-btn download",onClick:C,disabled:x,children:[a.jsx("i",{className:"fas fa-download"}),a.jsx("span",{children:"Download"})]})]}),x&&a.jsxs("div",{className:"generating-indicator",children:[a.jsx("i",{className:"fas fa-spinner fa-spin"}),a.jsx("span",{children:"Generating image..."})]})]})]})})}function l({team:n,stats:l,onClose:c}){var t;const r=s.useRef(null),[i,d]=s.useState(!1),o=async()=>{if(!r.current)return null;d(!0);try{const a=await e(r.current,{quality:1,pixelRatio:3,backgroundColor:"#0a0e1a"}),s=await fetch(a);return{dataUrl:a,blob:await s.blob()}}catch(a){return null}finally{d(!1)}},m=async()=>{const a=await o();if(a){const s=document.createElement("a");s.download=`team-${n.name}.png`,s.href=a.dataUrl,s.click()}};return a.jsx("div",{className:"share-modal-overlay",onClick:c,children:a.jsxs("div",{className:"share-modal-content",onClick:a=>a.stopPropagation(),children:[a.jsx("button",{className:"share-modal-close",onClick:c,children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("div",{className:"shareable-card-wrapper",children:a.jsxs("div",{ref:r,className:"shareable-card team-card",children:[a.jsxs("div",{className:"card-bg-effects",children:[a.jsx("div",{className:"card-glow glow-team",style:{background:n.primary_color||"#4f8cff"}}),a.jsx("div",{className:"card-noise"})]}),a.jsx("div",{className:"card-header",children:a.jsx("span",{className:"card-tournament",children:"MUQAWAMAH 2026"})}),a.jsxs("div",{className:"card-team-content",children:[a.jsx("div",{className:"card-team-logo large",children:n.crest_url?a.jsx("img",{src:n.crest_url,alt:n.name}):a.jsx("span",{className:"logo-placeholder",children:null==(t=n.name)?void 0:t.charAt(0)})}),a.jsx("h2",{className:"card-team-title",children:n.name}),n.captain&&a.jsxs("p",{className:"card-team-captain",children:["Captain: ",n.captain]})]}),l&&a.jsxs("div",{className:"card-team-stats",children:[a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:l.played||0}),a.jsx("span",{className:"stat-label",children:"Played"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:l.won||0}),a.jsx("span",{className:"stat-label",children:"Won"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:l.drawn||0}),a.jsx("span",{className:"stat-label",children:"Draw"})]}),a.jsxs("div",{className:"stat-item",children:[a.jsx("span",{className:"stat-value",children:l.lost||0}),a.jsx("span",{className:"stat-label",children:"Lost"})]}),a.jsxs("div",{className:"stat-item highlight",children:[a.jsx("span",{className:"stat-value",children:l.points||0}),a.jsx("span",{className:"stat-label",children:"Points"})]})]}),a.jsx("div",{className:"card-footer",children:a.jsxs("div",{className:"card-branding",children:[a.jsx("span",{className:"sio-logo",children:"SIO"}),a.jsx("span",{className:"card-divider",children:"Ã—"}),a.jsx("span",{className:"afe-logo",children:"AFE"})]})})]})}),a.jsxs("div",{className:"share-buttons",children:[a.jsx("h3",{children:"Share to"}),a.jsxs("div",{className:"share-btn-grid",children:[a.jsxs("button",{className:"share-btn whatsapp",onClick:async()=>{const a=await o();if(!a)return;const s=`ðŸ† ${n.name}\nâš½ Muqawamah 2026\nðŸ“Š ${(null==l?void 0:l.played)||0}P | ${(null==l?void 0:l.won)||0}W | ${(null==l?void 0:l.drawn)||0}D | ${(null==l?void 0:l.lost)||0}L\nðŸŽ¯ ${(null==l?void 0:l.points)||0} Points`;if(navigator.share&&navigator.canShare({files:[new File([a.blob],"team.png",{type:"image/png"})]}))try{return void(await navigator.share({title:n.name,text:s,files:[new File([a.blob],"team.png",{type:"image/png"})]}))}catch(c){}const e=`https://wa.me/?text=${encodeURIComponent(s)}`;window.open(e,"_blank"),m()},disabled:i,children:[a.jsx("i",{className:"fab fa-whatsapp"}),a.jsx("span",{children:"WhatsApp"})]}),a.jsxs("button",{className:"share-btn instagram",onClick:async()=>{const a=await o();if(!a)return;const s=document.createElement("a");s.download=`muqawamah-team-${Date.now()}.png`,s.href=a.dataUrl,s.click(),alert("Image downloaded! Open Instagram and share it to your Story or Feed.")},disabled:i,children:[a.jsx("i",{className:"fab fa-instagram"}),a.jsx("span",{children:"Instagram"})]}),a.jsxs("button",{className:"share-btn download",onClick:m,disabled:i,children:[a.jsx("i",{className:"fas fa-download"}),a.jsx("span",{children:"Download"})]})]}),i&&a.jsxs("div",{className:"generating-indicator",children:[a.jsx("i",{className:"fas fa-spinner fa-spin"}),a.jsx("span",{children:"Generating image..."})]})]})]})})}function c({onClick:s,className:e=""}){return a.jsxs("button",{className:`share-trigger-btn ${e}`,onClick:s,title:"Share",children:[a.jsx("i",{className:"fas fa-share-alt"}),a.jsx("span",{children:"Share"})]})}export{n as M,c as S,l as T};
